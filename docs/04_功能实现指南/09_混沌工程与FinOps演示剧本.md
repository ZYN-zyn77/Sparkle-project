# Sparkle 混沌工程与 FinOps 演示指南

## 场景设置
*   **左侧**: Sparkle Flutter App (运行在模拟器或真机)
*   **右侧**: 后端 Gateway 日志 (`tail -f backend/logs/gateway.log`)

## Act 1: 岁月静好 (FinOps 展示)
1.  **操作**: 打开 App 对话界面，发送“如何重置密码？”。
2.  **现象**: 正常的 AI 回复，耗时约 1-2s。
3.  **操作**: 再次发送“密码忘了怎么办？”（语义相似）。
4.  **演示重点**:
    *   App 瞬间返回。
    *   聊天气泡下方出现绿色徽章：`🚀 语义缓存命中 | 📉 已为您节省 $0.0020`。
    *   **话术**: “大家看，我们的语义缓存精准识别了用户的意图。这次交互完全在边缘侧完成，**零 Token 消耗**，响应提升了 20 倍，这就是 FinOps 的商业价值。”

## Act 2: 暴风雨来临 (混沌工程展示)
1.  **操作**: 进入 `我的 -> 设置`，长按底部的版本号。
2.  **操作**: 在弹出的 `Sparkle 混沌控制台` 中点击 `[🔴 施压模式]`。
3.  **演示重点**:
    *   此时后端持久化队列的熔断阈值被设为 5。
4.  **操作**: 回到聊天页，连续快速发送 6-10 条消息（可以点击快捷建议）。
5.  **现象**:
    *   后端日志开始报错：`Persistence queue overloaded (6/5), dropping message...`。
    *   **关键点**: App 依然在正常回复！用户完全感知不到后端数据库写入已经熔断。
    *   查看消息详情或日志，可以看到 `🛡️ 触发熔断保护` 状态。
6.  **话术**: “现在我模拟了数据库写入阻塞的情况。虽然我们的持久化层已经触发熔断保护以防止系统 OOM，但得益于 Sparkle 的**反脆弱设计**，核心对话流依然稳如泰山。我们牺牲了数据的最终一致性，换取了服务的绝对高可用。”

## Act 3: 拨云见日 (恢复)
1.  **操作**: 回到混沌控制台，点击 `[🟢 正常模式]`。
2.  **现象**: 系统恢复，阈值回到 10000。
3.  **话术**: “故障排除后，一键恢复正常模式，系统平滑回归生产状态。”