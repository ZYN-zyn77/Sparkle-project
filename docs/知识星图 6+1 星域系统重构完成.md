知识星图 6+1 星域系统重构完成

  我已经完成了知识星图的全面重构，实现了 6+1 星域系统的底层架构。以下是完成的工作：

  1. LLM 交互协议 (galaxy_llm_protocol.dart)

- 定义了 8 种操作类型：addNodes, updateNodes, deleteNodes, addConnections, updateConnections, removeConnections, moveNodes, batchOperation
  - 位置策略：polar（极坐标）、nearNode（靠近节点）、sectorRegion（星域区域）、auto（自动）
  - 7 种关系类型：prerequisite, derived, related, similar, contrast, application, example

  2. 数据模型扩展 (galaxy_model.dart)

  - GalaxyNodeModel 新增字段：tags, description, positionHint, outgoingEdgeIds, incomingEdgeIds
  - 新增 GalaxyEdgeModel 用于节点连接
  - 新增 NodePositionHint 用于 LLM 位置提示
  - 新增 EdgeRelationType 关系类型枚举

  3. 高性能布局引擎 (galaxy_layout_engine.dart)

  - 初始布局：基于星域分组的分层螺旋算法，O(n) 复杂度
  - 力导向优化：在 Isolate 中运行，支持边吸引力和星域约束
  - 视口裁剪：ViewportCuller 类只渲染可见区域，大幅提升性能
  - 碰撞检测：自动解决节点重叠问题

  4. 增强的星图渲染 (star_map_painter.dart)

  - 关系类型样式：不同关系用不同颜色/线型渲染
    - 前置知识（蓝色实线）→ 衍生知识（绿色实线）
    - 相关知识（橙色虚线）、对比概念（红色虚线）等
  - 方向箭头：prerequisite 和 derived 关系显示方向箭头
  - 节点渲染增强：星域颜色环、掌握度辉光、渐变填充
  - 视口裁剪优化：只预处理可见节点和边

  5. LLM 操作服务 (galaxy_llm_service.dart)

  - 完整的 CRUD 操作支持
  - 自动布局重计算
  - 批量操作支持
  - 快捷方法：createAddNodeAction(), createAddConnectionAction()

  LLM 接口示例

  {
    "action": "add_nodes",
    "nodes": [{
      "id": "calculus_basics",
      "name": "微积分基础",
      "sector": "COSMOS",
      "importance": 4,
      "position_hint": {
        "strategy": "sector_region",
        "region": "middle"
      },
      "connections": [
        {"target_id": "algebra", "relation_type": "prerequisite", "strength": 0.9}
      ]
    }]
  }

完成！现在同一星域的知识点会使用该星域的色系。以下是实现的效果：

  星域色系配置

  | 星域                  | 主色             | 色系说明             |
  |-----------------------|------------------|----------------------|
  | COSMOS 理性星域       | #00BFFF 深天蓝   | 蓝色系，从深蓝到浅蓝 |
  | TECH 造物星域         | #7B68EE 中紫罗兰 | 紫蓝色系，科技感     |
  | ART 灵感星域          | #FF69B4 热粉红   | 粉红色系             |
  | CIVILIZATION 文明星域 | #FFD700 金色     | 金黄色系             |
  | LIFE 生活星域         | #32CD32 酸橙绿   | 绿色系               |
  | WISDOM 智慧星域       | #E6E6FA 淡紫     | 淡紫白色系           |
  | VOID 暗物质区         | #708090 石板灰   | 灰色系               |

  颜色变化规则

  每个星域有 5 层调色板，节点颜色基于：

  1. 重要程度 (1-5)：
    - 重要程度 5 → 深色变体（更饱和）
    - 重要程度 3 → 主色
    - 重要程度 1 → 浅色变体
  2. 掌握度 (0-100)：
    - 掌握度越高，颜色亮度越高
    - 形成 "掌握了就更亮" 的视觉效果

  使用方式

  // 获取节点颜色
  final color = SectorConfig.getNodeColor(
    sector: SectorEnum.cosmos,
    importance: 4,
    masteryScore: 75,
  );

  // 或只根据重要程度
  final color = SectorConfig.getNodeColorByImportance(SectorEnum.tech, 3);

  现在运行应用时，每个星域的知识点都会呈现统一的色调，同时通过亮度/饱和度变化来区分重要程度和掌握度。