# Sparkle Flutter å‰ç«¯æ ·å¼è¯¦ç»†åˆ†ææ–‡æ¡£

## 1. è®¾è®¡ç³»ç»Ÿæ¶æ„æ¦‚è¿°

### 1.1 è®¾è®¡ä»¤ç‰Œç³»ç»Ÿ (Design Tokens v2.0)
Sparkleé‡‡ç”¨ç°ä»£åŒ–çš„è®¾è®¡ä»¤ç‰Œç³»ç»Ÿï¼Œæä¾›è¯­ä¹‰åŒ–çš„è®¾è®¡å˜é‡ï¼Œæ”¯æŒåŠ¨æ€ä¸»é¢˜ç®¡ç†ã€‚

**æ ¸å¿ƒæ–‡ä»¶ç»“æ„**:
```
mobile/lib/core/design/
â”œâ”€â”€ design_system.dart          # è®¾è®¡ç³»ç»Ÿå…¥å£
â”œâ”€â”€ tokens_v2/
â”‚   â”œâ”€â”€ color_token.dart        # é¢œè‰²ä»¤ç‰Œ
â”‚   â”œâ”€â”€ theme_manager.dart      # ä¸»é¢˜ç®¡ç†å™¨
â”‚   â”œâ”€â”€ typography_token.dart   # æ’ç‰ˆä»¤ç‰Œ
â”‚   â”œâ”€â”€ spacing_token.dart      # é—´è·ä»¤ç‰Œ
â”‚   â”œâ”€â”€ animation_token.dart    # åŠ¨ç”»ä»¤ç‰Œ
â”‚   â””â”€â”€ responsive_system.dart  # å“åº”å¼ç³»ç»Ÿ
â””â”€â”€ components/
    â””â”€â”€ atoms/                  # åŸå­ç»„ä»¶
```

### 1.2 æ·±è‰²/æµ…è‰²æ¨¡å¼å®ç°
- **ä¸»é¢˜ç®¡ç†å™¨**: `ThemeManager()` å•ä¾‹ç®¡ç†ä¸»é¢˜çŠ¶æ€
- **Materialä¸»é¢˜**: `AppThemes.lightTheme` å’Œ `AppThemes.darkTheme`
- **åŠ¨æ€åˆ‡æ¢**: é€šè¿‡ `themeModeProvider` å®æ—¶åˆ‡æ¢
- **ä¸Šä¸‹æ–‡è®¿é—®**: `SparkleContext` æ‰©å±•æä¾›ä¾¿æ·è®¿é—®

## 2. é¢œè‰²ç³»ç»Ÿè¯¦è§£

### 2.1 å“ç‰Œé¢œè‰² (Brand Colors)
åŸºäº `SparkleColors` ç±»çš„å®é™…å®ç°ï¼š

```dart
// æµ…è‰²æ¨¡å¼ (Light Mode)
DS.brandPrimary:      #FFFF6B35 (æ©™çº¢è‰² - ä¸»å“ç‰Œè‰²)
DS.brandSecondary:    #FF5C6BC0 (è“ç´«è‰² - æ¬¡å“ç‰Œè‰²)

// æ·±è‰²æ¨¡å¼ (Dark Mode)
DS.brandPrimary:      #FFFF8C5A (äº®æ©™è‰² - ä¸»å“ç‰Œè‰²)
DS.brandSecondary:    #FF5C6BC0 (è“ç´«è‰² - æ¬¡å“ç‰Œè‰²ï¼Œä¿æŒä¸€è‡´)

// å“ç‰Œé¢„è®¾ç³»ç»Ÿ (Brand Presets)
BrandPreset.sparkle:  é»˜è®¤æ©™çº¢/è“ç´«
BrandPreset.ocean:    #FF0077BE / #FF00A8E8 (æµ·æ´‹è“)
BrandPreset.forest:   #FF2D6A4F / #FF52B788 (æ£®æ—ç»¿)
```

### 2.2 è¡¨é¢é¢œè‰² (Surface Colors)
```dart
// æµ…è‰²æ¨¡å¼
DS.surfacePrimary:    #FFFFFFFF (çº¯ç™½ - ä¸»èƒŒæ™¯)
DS.surfaceSecondary:  #FFF5F5F5 (æµ…ç° - å¡ç‰‡èƒŒæ™¯)
DS.surfaceTertiary:   #FFE0E0E0 (ä¸­ç° - è¾¹æ¡†/åˆ†å‰²çº¿)

// æ·±è‰²æ¨¡å¼
DS.surfacePrimary:    #FF121212 (æ·±é»‘ - ä¸»èƒŒæ™¯)
DS.surfaceSecondary:  #FF1E1E1E (æ·±ç° - å¡ç‰‡èƒŒæ™¯)
DS.surfaceTertiary:   #FF2D2D2D (æ›´æ·±ç° - è¾¹æ¡†/åˆ†å‰²çº¿)

// ç‰¹æ®Šè¡¨é¢ (Special Surfaces)
DS.deepSpaceStart:    æ·±ç©ºè“é»‘æ··åˆ (æ˜Ÿç³»å›¾èƒŒæ™¯æ¸å˜å¼€å§‹)
DS.deepSpaceEnd:      æ·±ç©ºç´«é»‘æ··åˆ (æ˜Ÿç³»å›¾èƒŒæ™¯æ¸å˜ç»“æŸ)
DS.glassBackground:   åŠé€æ˜è¡¨é¢ (æ¯›ç»ç’ƒæ•ˆæœ)
DS.glassBorder:       åŠé€æ˜è¾¹æ¡† (æ¯›ç»ç’ƒè¾¹æ¡†)
```

### 2.3 è¯­ä¹‰é¢œè‰² (Semantic Colors)
```dart
// åŸºç¡€è¯­ä¹‰è‰²
DS.success:  #FF81C784 (ç»¿è‰² - æˆåŠŸ)
DS.warning:  #FFFFB74D (æ©™è‰² - è­¦å‘Š)
DS.error:    #FFEF5350 (çº¢è‰² - é”™è¯¯)
DS.info:     #FF64B5F6 (è“è‰² - ä¿¡æ¯)

// ä»»åŠ¡ç±»å‹é¢œè‰² (Task Type Colors)
DS.taskLearning:    #FF64B5F6 (å­¦ä¹  - è“è‰²)
DS.taskTraining:    #FFFF9800 (è®­ç»ƒ - æ©™è‰²)
DS.taskErrorFix:    #FFEF5350 (çº é”™ - çº¢è‰²)
DS.taskReflection:  #FF9C27B0 (åæ€ - ç´«è‰²)
DS.taskSocial:      #FF81C784 (ç¤¾äº¤ - ç»¿è‰²)
DS.taskPlanning:    #FF009688 (è®¡åˆ’ - é’è‰²)

// è®¡åˆ’ç±»å‹é¢œè‰² (Plan Type Colors)
DS.planSprint:      #FFE53935 (å†²åˆº - æ·±çº¢)
DS.planGrowth:      #FF43A047 (æˆé•¿ - æ·±ç»¿)

// ç”¨æˆ·çŠ¶æ€é¢œè‰² (User Status)
DS.statusOnline:    #FF2ECC71 (åœ¨çº¿ - ç»¿è‰²)
DS.statusOffline:   #FF95A5A6 (ç¦»çº¿ - ç°è‰²)
DS.statusInvisible: #FF34495E (éšèº« - æ·±è“ç°)
```

### 2.4 æ–‡æœ¬é¢œè‰²
```dart
// æµ…è‰²æ¨¡å¼
DS.textPrimary:    #FF212121 (æ·±ç° - ä¸»æ–‡æœ¬)
DS.textSecondary:  #FF757575 (ä¸­ç° - æ¬¡æ–‡æœ¬)
DS.textTertiary:   #FFBDBDBD (æµ…ç° - è¾…åŠ©æ–‡æœ¬ï¼Œé€šè¿‡ alpha æ´¾ç”Ÿ)

// æ·±è‰²æ¨¡å¼
DS.textPrimary:    #FFFFFFFF (çº¯ç™½ - ä¸»æ–‡æœ¬)
DS.textSecondary:  #FFE0E0E0 (æµ…ç° - æ¬¡æ–‡æœ¬)
DS.textTertiary:   #FF757575 (æš—ç° - è¾…åŠ©æ–‡æœ¬ï¼Œé€šè¿‡ alpha æ´¾ç”Ÿ)

// è¾¹æ¡†é¢œè‰² (Border)
DS.border:         æ ¹æ®æ¨¡å¼è‡ªåŠ¨åˆ‡æ¢ (æµ…è‰²: neutral300, æ·±è‰²: neutral600)
```

### 2.5 æ¸å˜ç³»ç»Ÿ (Gradients)
```dart
DS.primaryGradient:    å“ç‰Œä¸»æ¸å˜ (brandPrimary â†’ brandSecondary)
DS.secondaryGradient:  å“ç‰Œæ¬¡æ¸å˜ (brandSecondary â†’ brandPrimary)
DS.accentGradient:     å¼ºè°ƒæ¸å˜ (accent â†’ è½»å¾®å˜äº®)
DS.infoGradient:       ä¿¡æ¯æ¸å˜ (info â†’ 70% opacity)
DS.warningGradient:    è­¦å‘Šæ¸å˜ (warning â†’ 70% opacity)
DS.successGradient:    æˆåŠŸæ¸å˜ (success â†’ 70% opacity)
DS.errorGradient:      é”™è¯¯æ¸å˜ (error â†’ 70% opacity)
DS.deepSpaceGradient:  æ·±ç©ºæ¸å˜ (deepSpaceStart â†’ deepSpaceEnd)
DS.flameGradient:      ç«ç„°æ¸å˜ (flameCore â†’ warning)
```

### 2.6 é¢œè‰²å˜ä½“ç³»ç»Ÿ (Color Variants)
```dart
// å“ç‰Œè‰²é€æ˜åº¦å˜ä½“ (Brand Primary Alpha Variants)
DS.brandPrimary10:  brandPrimary.withValues(alpha: 0.1)
DS.brandPrimary24:  brandPrimary.withValues(alpha: 0.24)
DS.brandPrimary38:  brandPrimary.withValues(alpha: 0.38)
DS.brandPrimary54:  brandPrimary.withValues(alpha: 0.54)
DS.brandPrimary70:  brandPrimary.withValues(alpha: 0.7)

// è¯­ä¹‰è‰²é€æ˜åº¦å˜ä½“
DS.success100:      success.withValues(alpha: 0.1)
DS.error100:        error.withValues(alpha: 0.1)
DS.warning100:      warning.withValues(alpha: 0.1)

// ç‰¹æ®Šé¢œè‰²
DS.flameCore:       æ©™é»„æ··åˆè‰² (ç”¨äºç«ç„°æ•ˆæœ)
DS.prismBlue:       info (æ£±é•œè“)
DS.prismGreen:      success (æ£±é•œç»¿)
DS.prismPurple:     brandSecondary (æ£±é•œç´«)
```

## 3. é©¾é©¶èˆ± (ä¸»é¡µ) è¯¦ç»†æ ·å¼

### 3.1 é¡µé¢ç»“æ„
**æ–‡ä»¶**: `mobile/lib/presentation/screens/home/home_screen.dart`

**ä¸‰å±‚å åŠ å¸ƒå±€**:
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Layer 1: WeatherHeader          â”‚  â† åŠ¨æ€å¤©æ°”èƒŒæ™¯ (å…¨å±)
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Layer 2: Dashboard Content      â”‚  â† æ»šåŠ¨å†…å®¹åŒº (SafeArea)
â”‚   - Top Overlay (ç”¨æˆ·ä¿¡æ¯)      â”‚
â”‚   - Notification Card           â”‚
â”‚   - Bento Grid (å¡ç‰‡ç½‘æ ¼)       â”‚
â”‚   - Bottom Spacer               â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Layer 3: OmniBar                â”‚  â† åº•éƒ¨æµ®åŠ¨è¾“å…¥æ¡ (ç»å¯¹å®šä½)
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**å…³é”®å®ç°ç»†èŠ‚**:
- ä½¿ç”¨ `Scaffold(extendBody: true, backgroundColor: Colors.transparent)`
- `CustomScrollView` + `SliverToBoxAdapter` å®ç°æ»šåŠ¨
- `RefreshIndicator` æ”¯æŒä¸‹æ‹‰åˆ·æ–°
- `Positioned` widget å®ç° OmniBar æ‚¬æµ®

### 3.2 é¡¶éƒ¨ç”¨æˆ·ä¿¡æ¯æ 
**ä½ç½®**: `SafeArea` é¡¶éƒ¨, å·¦å¯¹é½, å†…è¾¹è· `padding: EdgeInsets.fromLTRB(16, 8, 16, 8)`

**ç»„ä»¶ç»“æ„**:
```dart
Row(
  children: [
    CircleAvatar(radius: 18),           // å¤´åƒ 36px
    SizedBox(width: 10),
    Column(
      crossAxisAlignment: CrossAxisAlignment.start,
      children: [
        Text('Lv.${user.flameLevel}'),  // ç­‰çº§
        Text(user.nickname),            // æ˜µç§°
      ],
    ),
  ],
)
```

**ç²¾ç¡®æ ·å¼**:
- **å¤´åƒ**:
  - åŠå¾„: 18px (æ€»å°ºå¯¸ 36px)
  - èƒŒæ™¯è‰²: `DS.primaryBase` (å“ç‰Œä¸»è‰²)
  - æ–‡å­—: ç™½è‰², å­—ä½“å¤§å° 16px, å­—é‡ Bold
  - æ— å¤´åƒæ—¶æ˜¾ç¤ºé¦–å­—æ¯å¤§å†™

- **ç­‰çº§æ ‡ç­¾**:
  - å­—ä½“å¤§å°: `DS.fontSizeXs` (12px)
  - å­—é‡: `DS.fontWeightBold` (w700)
  - é¢œè‰²: `DS.warning` (#FFFFB74D)
  - æ˜¾ç¤ºæ ¼å¼: "Lv.5"

- **æ˜µç§°**:
  - å­—ä½“å¤§å°: `DS.fontSizeSm` (14px)
  - å­—é‡: `DS.fontWeightBold` (w700)
  - é¢œè‰²: `DS.brandPrimary` (#FFFF6B35)

### 3.3 Bento Grid å¡ç‰‡ç½‘æ ¼
**å¸ƒå±€å¼•æ“**: `flutter_staggered_grid_view` - `StaggeredGrid`

**ç½‘æ ¼é…ç½®**:
```dart
StaggeredGrid.count(
  crossAxisCount: 4,              // 4åˆ—
  mainAxisSpacing: 12,            // è¡Œé—´è· 12px
  crossAxisSpacing: 12,           // åˆ—é—´è· 12px
)
```

**å¡ç‰‡åˆ†å¸ƒä¸å°ºå¯¸**:
| å¡ç‰‡ | ä½ç½® | å°ºå¯¸ (cells) | å®é™…å°ºå¯¸ (px) | åŠŸèƒ½ | è·³è½¬è·¯å¾„ |
|------|------|--------------|---------------|------|----------|
| Focus Core | (0,0) | 2x2 | ~174x174 | ç„¦ç‚¹æ ¸å¿ƒ | `/focus` |
| Calendar Heatmap | (2,0) | 2x1 | ~174x81 | æ—¥å†çƒ­åŠ›å›¾ | - |
| Prism Card | (0,2) | 2x1 | ~174x81 | è®¤çŸ¥æ£±é•œ | - |
| Sprint Ring | (2,2) | 1x1 | ~81x81 | å†²åˆºç¯ | `/plans` |
| Next Actions | (3,2) | 1x1 | ~81x81 | ä¸‹ä¸€æ­¥è¡ŒåŠ¨ | `/tasks` |
| Curiosity Capsule | (0,3) | 1x1 | ~81x81 | å¥½å¥‡å¿ƒèƒ¶å›Š | - |
| Long Term Plan | (1,3) | 1x1 | ~81x81 | é•¿æœŸè®¡åˆ’ | - |

**å®¹å™¨çº¦æŸ**: ä½¿ç”¨ `ContentConstraint` åŒ…è£…ï¼Œé™åˆ¶æœ€å¤§å®½åº¦åœ¨æ¡Œé¢ç«¯

### 3.4 å¡ç‰‡ç»„ä»¶æ ·å¼è¯¦è§£

#### Focus Card (2x2 - æœ€å¤§å¡ç‰‡)
**æ–‡ä»¶**: `mobile/lib/presentation/widgets/home/focus_card.dart`

**è§†è§‰ç‰¹å¾**:
- **èƒŒæ™¯**: æ¯›ç»ç’ƒæ•ˆæœ + æ¸å˜
  ```dart
  gradient: LinearGradient(
    colors: [
      DS.flameCore.withValues(alpha: 0.15),  // æ©™é»„æ ¸å¿ƒè‰²
      DS.glassBackground,                     // åŠé€æ˜èƒŒæ™¯
    ],
    begin: Alignment.topLeft,
    end: Alignment.bottomRight,
  ),
  ```
- **è¾¹æ¡†**: 1px, `DS.glassBorder` (åŠé€æ˜è¾¹æ¡†)
- **åœ†è§’**: `DS.borderRadius20` (20px)
- **æ¯›ç»ç’ƒ**: `BackdropFilter.blur(sigmaX: 12, sigmaY: 12)`
- **å†…è¾¹è·**: `DS.lg` (24px)

**å†…å®¹å¸ƒå±€**:
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ä¸“æ³¨æ ¸å¿ƒ              Lv.5  â”‚  â† æ ‡é¢˜ + ç­‰çº§æ ‡ç­¾
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚         ğŸ”¥                  â”‚  â† ç«ç„°åŠ¨ç”» (60x60px)
â”‚    (è„‰å†²ç¼©æ”¾ 0.9-1.1)       â”‚
â”‚                             â”‚
â”‚    [æç¤ºæ¶ˆæ¯å®¹å™¨]            â”‚  â† Nudge Message
â”‚    "ä»Šå¤©ä¸“æ³¨äº†30åˆ†é’Ÿ..."     â”‚
â”‚                             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ ä»Šæ—¥ä¸“æ³¨  ï¸±  ä»Šæ—¥å®Œæˆ        â”‚  â† æŒ‡æ ‡è¡Œ
â”‚  2h 15m      3              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**åŠ¨ç”»ç³»ç»Ÿ**:
- **ç«ç„°åŠ¨ç”»**: `AnimationController` (1500ms, reverse)
  - ç¼©æ”¾èŒƒå›´: 0.9 â†’ 1.1
  - æ›²çº¿: `Curves.easeInOut`
  - å¾ªç¯: `repeat(reverse: true)`
- **ç«ç„°å›¾æ ‡**: å¾„å‘æ¸å˜ + `Icons.local_fire_department_rounded`
  - é¢œè‰²: `DS.warning` (æ©™è‰²)
  - å¤§å°: 32px

**æ•°æ®å±•ç¤º**:
- **ç­‰çº§æ ‡ç­¾**: åœ†è§’å®¹å™¨ `borderRadius: 10`
  - èƒŒæ™¯: `DS.flameCore.withValues(alpha: 0.2)`
  - æ–‡å­—: "Lv.5" (11px, Bold)
- **æç¤ºæ¶ˆæ¯**:
  - èƒŒæ™¯: `DS.brandPrimary.withValues(alpha: 0.05)`
  - åœ†è§’: 12px
  - å†…è¾¹è·: æ°´å¹³12px, å‚ç›´8px
  - æœ€å¤§è¡Œæ•°: 3è¡Œ, çœç•¥å·
  - æ ·å¼: æ–œä½“, 11px, è¡Œé«˜1.3
- **æŒ‡æ ‡è¡Œ**:
  - åˆ†éš”çº¿: `DS.brandPrimary12`, 1pxå®½, 20pxé«˜
  - æŒ‡æ ‡ç»„ä»¶: å‚ç›´å±…ä¸­, ä¸Šå€¼ä¸‹æ ‡ç­¾
  - å€¼: 18px, Bold, `DS.textSecondary`
  - æ ‡ç­¾: 10px, 60%é€æ˜åº¦

**äº¤äº’**:
- ç‚¹å‡»å¡ç‰‡: è§¦å‘ `onTap` å›è°ƒ (è·³è½¬ `/focus`)
- æ— æŒ‰é’®äº¤äº’, æ•´ä¸ªå¡ç‰‡å¯ç‚¹å‡»
- è§¦è§‰åé¦ˆ: æ—  (ä»…è·³è½¬)

**æ€§èƒ½ä¼˜åŒ–**:
- ä½¿ç”¨ `ConsumerStatefulWidget` ç®¡ç†åŠ¨ç”»çŠ¶æ€
- `dispose()` ä¸­æ­£ç¡®é‡Šæ”¾ `AnimationController`
- `BackdropFilter` ä»…åœ¨éœ€è¦æ—¶åº”ç”¨

#### Calendar Heatmap Card (2x1)
**æ–‡ä»¶**: `mobile/lib/presentation/widgets/home/calendar_heatmap_card.dart`

**è§†è§‰ç‰¹å¾**:
- **èƒŒæ™¯**: æ¯›ç»ç’ƒ + æ·±ç©ºè¡¨é¢æ¸å˜
  ```dart
  gradient: LinearGradient(
    colors: [
      DS.deepSpaceSurface.withValues(alpha: 0.6),
      DS.glassBackground,
    ],
  ),
  ```
- **è¾¹æ¡†**: 1px, `DS.glassBorder`
- **åœ†è§’**: `DS.borderRadius20` (20px)
- **æ¯›ç»ç’ƒ**: `BackdropFilter.blur(sigmaX: 12, sigmaY: 12)`
- **å†…è¾¹è·**: `DS.lg` (24px)

**å†…å®¹å¸ƒå±€**:
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 2025å¹´1æœˆ          ğŸ“…       â”‚  â† æœˆä»½æ ‡é¢˜ + å›¾æ ‡
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ [7x5 ç½‘æ ¼çƒ­åŠ›å›¾]             â”‚  â† æ—¥æœŸç‚¹é˜µ
â”‚ â—‹ â—‹ â—‹ â—‹ â—‹ â—‹ â—‹              â”‚
â”‚ â—‹ â—‹ â— â— â— â—‹ â—‹              â”‚
â”‚ ...                         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Less â—‹ â—‹ â—‹ â—‹ â—‹ More        â”‚  â† å›¾ä¾‹
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**çƒ­åŠ›å›¾å®ç°**:
- **ç½‘æ ¼**: `GridView.count(crossAxisCount: 7)`
- **é—´è·**: 4px (è¡Œ/åˆ—)
- **ç‚¹é˜µå¤§å°**: 8x8px, `borderRadius: 2`
- **é¢œè‰²æ˜ å°„** (åŸºäº `DS.brandPrimary` é€æ˜åº¦):
  ```dart
  Level 0: alpha: 0.1  // æœ€ä½æ´»è·ƒåº¦
  Level 1: alpha: 0.3
  Level 2: alpha: 0.5
  Level 3: alpha: 0.7
  Level 4: alpha: 1.0  // æœ€é«˜æ´»è·ƒåº¦ (ä»Šæ—¥)
  ```
- **ä»Šæ—¥é«˜äº®**: è¾¹æ¡† `DS.brandPrimary`, 1.5pxå®½
- **æ•°æ®ç”Ÿæˆ**: ä¼ªéšæœº `(i * 7) % 5`, ä»Šæ—¥å¼ºåˆ¶ Level 4

**äº¤äº’**:
- ç‚¹å‡»è·³è½¬: `/calendar-stats`
- æ— åŠ¨ç”»æ•ˆæœ

**æ€§èƒ½**:
- `NeverScrollableScrollPhysics()` ç¦ç”¨æ»šåŠ¨
- `LayoutBuilder` åŠ¨æ€è®¡ç®—ç½‘æ ¼

#### Prism Card (2x1)
**æ–‡ä»¶**: `mobile/lib/presentation/widgets/home/prism_card.dart`

**è§†è§‰ç‰¹å¾**:
- **èƒŒæ™¯**: æ¯›ç»ç’ƒ + ç´«è‰²æ¸å˜
  ```dart
  gradient: LinearGradient(
    colors: [
      DS.prismPurple.withAlpha(40),  // ç´«è‰²åŠé€æ˜
      DS.glassBackground,
    ],
  ),
  ```
- **è¾¹æ¡†**: 1px, `DS.glassBorder`
- **åœ†è§’**: `DS.borderRadius20` (20px)
- **æ¯›ç»ç’ƒ**: `BackdropFilter.blur(sigmaX: 12, sigmaY: 12)`
- **å†…è¾¹è·**: `DS.lg` (24px)

**å†…å®¹å¸ƒå±€**:
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ â—‡ è®¤çŸ¥æ£±é•œ                â—  â”‚  â† æ ‡é¢˜ + æ–°æ´å¯Ÿç‚¹
â”‚                             â”‚
â”‚  [å‘¼å¸å…‰æ™•åŠ¨ç”»]              â”‚  â† ç´«è‰²å¾„å‘æ¸å˜
â”‚    (å³ä¸‹è§’, é€æ˜åº¦0.1-0.3)   â”‚
â”‚                             â”‚
â”‚  #å·¥ä½œæ¨¡å¼ #ç„¦è™‘æ³¢å³°         â”‚  â† æ ‡ç­¾
â”‚  è¡Œä¸ºå®šå¼åˆ†æå·²æ›´æ–°          â”‚  â† å‰¯æ ‡é¢˜
â”‚  [å¤ä¹ å¼±é¡¹: åˆ†æ]            â”‚  â† å¯ç‚¹å‡»æŒ‰é’®
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**åŠ¨ç”»ç³»ç»Ÿ**:
- **å‘¼å¸å…‰æ™•**: `AnimationController` (2000ms, reverse)
  - é€æ˜åº¦èŒƒå›´: 0.1 â†’ 0.3
  - æ›²çº¿: `Curves.easeInOut`
  - ä½ç½®: å³ä¸‹è§’åç§» (-20, -20)
  - å¤§å°: 100x100px åœ†å½¢

**åŠ¨æ€å†…å®¹**:
- **æ–°æ´å¯ŸæŒ‡ç¤ºå™¨**: å³ä¸Šè§’ 6px ç´«è‰²åœ†ç‚¹
- **æ ‡ç­¾ç³»ç»Ÿ**: `Wrap` å¸ƒå±€, é—´è·8px
  - èƒŒæ™¯: `DS.brandPrimary.withAlpha(20)`
  - è¾¹æ¡†: `DS.brandPrimary.withAlpha(30)`
  - åœ†è§’: 8px
- **æ“ä½œæŒ‰é’®**:
  - è·³è½¬: `/errors?dimension=analysis`
  - å›¾æ ‡: `Icons.error_outline` (12px)
  - å†…è¾¹è·: æ°´å¹³8px, å‚ç›´4px

**äº¤äº’**:
- ç‚¹å‡»å¡ç‰‡: `/cognitive/patterns`
- ç‚¹å‡»æŒ‰é’®: `/errors?dimension=analysis`
- è§¦è§‰åé¦ˆ: æ— 

#### Sprint Card (1x1)
**æ–‡ä»¶**: `mobile/lib/presentation/widgets/home/sprint_card.dart`

**è§†è§‰ç‰¹å¾**:
- **èƒŒæ™¯**: çº¯æ¯›ç»ç’ƒ `DS.glassBackground`
- **è¾¹æ¡†**: 1px, `DS.glassBorder`
- **åœ†è§’**: `DS.borderRadius20` (20px)
- **æ¯›ç»ç’ƒ**: `BackdropFilter.blur(sigmaX: 10, sigmaY: 10)`
- **å†…è¾¹è·**: `DS.lg` (24px)

**å†…å®¹å¸ƒå±€** (æœ‰æ•°æ®):
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ å†²åˆº                        â”‚  â† æ ‡é¢˜
â”‚                             â”‚
â”‚         â”Œâ”€â”€â”€â”€â”€â”€â”€â”           â”‚
â”‚         â”‚  3    â”‚           â”‚  â† ä¸­å¿ƒ: å‰©ä½™å¤©æ•°
â”‚         â”‚  å¤©   â”‚           â”‚
â”‚         â””â”€â”€â”€â”€â”€â”€â”€â”˜           â”‚  â† ç¯å½¢è¿›åº¦æ¡
â”‚                             â”‚
â”‚ å†²åˆºåç§°                    â”‚  â† åç§° (12px, Bold)
â”‚ 75% å®Œæˆ                    â”‚  â† è¿›åº¦ç™¾åˆ†æ¯”
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**å†…å®¹å¸ƒå±€** (ç©ºçŠ¶æ€):
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚      âš¡                     â”‚  â† é—ªç”µå›¾æ ‡
â”‚                             â”‚
â”‚      æ— å†²åˆºè®¡åˆ’             â”‚  â† æ ‡é¢˜
â”‚      ç‚¹å‡»åˆ›å»º               â”‚  â† å‰¯æ ‡é¢˜
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**ç¯å½¢è¿›åº¦æ¡** (`CustomPaint`):
- **èƒŒæ™¯åœ†**:
  - é¢œè‰²: `DS.brandPrimary.withAlpha(30)`
  - å®½åº¦: 6px
- **è¿›åº¦å¼§**:
  - é¢œè‰²: æ­£å¸¸ `DS.primaryBase`, ç´§æ€¥ `DS.error`
  - å®½åº¦: 6px
  - ç«¯ç‚¹: åœ†è§’ (`StrokeCap.round`)
  - è§’åº¦: `2 * pi * progress`
- **ç´§æ€¥çŠ¶æ€**: å¤©æ•° â‰¤ 3 å¤©, æ˜¾ç¤ºçº¢è‰²

**äº¤äº’**:
- ç‚¹å‡»å¡ç‰‡: è§¦å‘ `onTap` å›è·³è½¬ `/plans`
- æ— è§¦è§‰åé¦ˆ

#### Next Actions Card (1x1)
**æ–‡ä»¶**: `mobile/lib/presentation/widgets/home/next_actions_card.dart`

**è§†è§‰ç‰¹å¾**:
- **èƒŒæ™¯**: çº¯æ¯›ç»ç’ƒ `DS.glassBackground`
- **è¾¹æ¡†**: 1px, `DS.glassBorder`
- **åœ†è§’**: `DS.borderRadius20` (20px)
- **æ¯›ç»ç’ƒ**: `BackdropFilter.blur(sigmaX: 12, sigmaY: 12)`
- **å†…è¾¹è·**: `DS.md` (16px)

**å†…å®¹å¸ƒå±€** (æœ‰ä»»åŠ¡):
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ä¸‹ä¸€æ­¥                â‹¯      â”‚  â† æ ‡é¢˜ + æ›´å¤šæŒ‰é’®
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ [ä»»åŠ¡é¡¹ 1]                  â”‚  â† ä»»åŠ¡å®¹å™¨
â”‚ ä»»åŠ¡æ ‡é¢˜ (æœ€å¤š2è¡Œ)          â”‚
â”‚ â— ç±»å‹ç‚¹  15m  âœ“            â”‚  â† ç±»å‹+æ—¶é•¿+å®Œæˆ
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**å†…å®¹å¸ƒå±€** (ç©ºçŠ¶æ€):
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ä¸‹ä¸€æ­¥                      â”‚
â”‚                             â”‚
â”‚         âœ“                  â”‚  â† å®Œæˆå›¾æ ‡
â”‚        æ¸…ç©ºå•¦               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**ä»»åŠ¡é¡¹æ ·å¼**:
- **å®¹å™¨**:
  - èƒŒæ™¯: `DS.brandPrimary.withAlpha(10)`
  - åœ†è§’: 10px
  - å†…è¾¹è·: `DS.sm` (8px)
- **ä»»åŠ¡æ ‡é¢˜**: 11px, `DS.brandPrimaryConst`
- **ç±»å‹ç‚¹**: 4x4px åœ†å½¢, é¢œè‰²æ˜ å°„:
  - learning: `DS.brandPrimary` (è“)
  - training: `DS.success` (ç»¿)
  - error_fix: `DS.error` (çº¢)
  - reflection: `DS.prismPurple` (ç´«)
- **æ—¶é•¿**: 9px, `DS.brandPrimary.withAlpha(120)`
- **å®ŒæˆæŒ‰é’®**: `Icons.check_circle_outline_rounded` (14px)

**äº¤äº’**:
- ç‚¹å‡»ä»»åŠ¡: è·³è½¬ `/focus/mindfulness` (å¸¦ä»»åŠ¡æ•°æ®)
- ç‚¹å‡»å®Œæˆ: è°ƒç”¨ `taskListProvider.completeTask()`, åˆ·æ–° Dashboard
- ç‚¹å‡»æ›´å¤š: è§¦å‘ `onViewAll` å›è°ƒ (è·³è½¬ `/tasks`)

**é™åˆ¶**:
- æœ€å¤šæ˜¾ç¤º 1 ä¸ªä»»åŠ¡ (`.clamp(0, 1)`)

#### Dashboard Curiosity Card (1x1)
**æ–‡ä»¶**: `mobile/lib/presentation/widgets/home/dashboard_curiosity_card.dart`

**è§†è§‰ç‰¹å¾**:
- **èƒŒæ™¯**: çº¯æ¯›ç»ç’ƒ `DS.glassBackground`
- **è¾¹æ¡†**: 1px, `DS.glassBorder`
- **åœ†è§’**: `DS.borderRadius20` (20px)
- **æ¯›ç»ç’ƒ**: `BackdropFilter.blur(sigmaX: 10, sigmaY: 10)`
- **å†…è¾¹è·**: `DS.lg` (24px)

**å†…å®¹å¸ƒå±€**:
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ğŸ’¡                    â—      â”‚  â† ç¯æ³¡å›¾æ ‡ + æ–°æ´å¯Ÿç‚¹
â”‚                             â”‚
â”‚  å·¥ä½œæ¨¡å¼                    â”‚  â† ä¸»æ–‡æœ¬ (14px, Bold)
â”‚                             â”‚
â”‚  å¥½å¥‡å¿ƒèƒ¶å›Š                  â”‚  â† å‰¯æ–‡æœ¬ (10px)
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**åŠ¨æ€å†…å®¹**:
- **æ–°æ´å¯Ÿç‚¹**: å³ä¸Šè§’ 8px çº¢è‰²åœ†ç‚¹ (`DS.error`)
- **ä¸»æ–‡æœ¬**:
  - æœ‰æ•°æ®: `cognitive.weeklyPattern` (e.g., "å·¥ä½œæ¨¡å¼")
  - æ— æ•°æ®: "æ¢ç´¢æœªçŸ¥"
- **å›¾æ ‡**: `Icons.lightbulb_outline`, é¢œè‰² `DS.accent`

**äº¤äº’**:
- ç‚¹å‡»å¡ç‰‡: è·³è½¬ `/curiosity-capsule`
- æ— è§¦è§‰åé¦ˆ

#### Long Term Plan Card (1x1)
**æ–‡ä»¶**: `mobile/lib/presentation/widgets/home/long_term_plan_card.dart`

**è§†è§‰ç‰¹å¾**:
- **èƒŒæ™¯**: çº¯æ¯›ç»ç’ƒ `DS.glassBackground`
- **è¾¹æ¡†**: 1px, `DS.glassBorder`
- **åœ†è§’**: `DS.borderRadius20` (20px)
- **æ¯›ç»ç’ƒ**: `BackdropFilter.blur(sigmaX: 10, sigmaY: 10)`
- **å†…è¾¹è·**: `DS.lg` (24px)

**å†…å®¹å¸ƒå±€** (æœ‰è®¡åˆ’):
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ é•¿æœŸè®¡åˆ’              ğŸŒ¿     â”‚  â† æ ‡é¢˜ + å›¾æ ‡
â”‚                             â”‚
â”‚         85%                 â”‚  â† è¿›åº¦ç™¾åˆ†æ¯” (24px, Bold)
â”‚         â”â”â”â”â”â”â”â”            â”‚  â† è¿›åº¦æ¡ (4pxé«˜, 60pxå®½)
â”‚                             â”‚
â”‚  å­¦ä¹ Rustè¯­è¨€               â”‚  â† è®¡åˆ’åç§°
â”‚  Mastery: 85%               â”‚  â† æŒæ¡åº¦
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**å†…å®¹å¸ƒå±€** (ç©ºçŠ¶æ€):
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                             â”‚
â”‚         +                   â”‚  â† åŠ å·å›¾æ ‡ (32px)
â”‚                             â”‚
â”‚    åˆ›å»ºé•¿æœŸè®¡åˆ’             â”‚  â† æ–‡æœ¬
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**è¿›åº¦æ¡æ ·å¼**:
- **èƒŒæ™¯**: `DS.brandPrimary10`
- **å€¼**: `DS.success` (ç»¿è‰²)
- **åœ†è§’**: 2px
- **é«˜åº¦**: 4px
- **å®½åº¦**: 60px

**æ•°æ®å±•ç¤º**:
- **è¿›åº¦ç™¾åˆ†æ¯”**: `(growth.progress * 100).toInt()`
- **æŒæ¡åº¦**: `Mastery: ${(growth.masteryLevel * 100).toInt()}%`
- **è®¡åˆ’åç§°**: 12px, Bold, å•è¡Œçœç•¥

**äº¤äº’**:
- ç‚¹å‡»å¡ç‰‡: è·³è½¬ `/growth`
- æ— è§¦è§‰åé¦ˆ

**æ€§èƒ½**:
- `ConsumerWidget` æ— çŠ¶æ€ç®¡ç†
- `LinearProgressIndicator` å†…ç½®åŠ¨ç”»

### 3.5 åº•éƒ¨ OmniBar
**æ–‡ä»¶**: `mobile/lib/presentation/widgets/home/omnibar.dart`

**ä½ç½®**: åº•éƒ¨ 16px, å·¦å³è¾¹è· 16px
**é«˜åº¦**: è‡ªé€‚åº” (æœ€å° 56px)

**è§†è§‰ç‰¹å¾**:
- **èƒŒæ™¯**: `DS.brandPrimary.withValues(alpha: 0.8)` (å“ç‰Œè‰²åŠé€æ˜)
- **åœ†è§’**: 32px (å®Œå…¨åœ†è§’)
- **è¾¹æ¡†**: 1.5px, æ„å›¾é¢œè‰²è¾¹æ¡† (åŠ¨æ€)
- **é˜´å½±**: åŠ¨æ€å‘å…‰æ•ˆæœ (åŸºäºæ„å›¾)
  ```dart
  boxShadow: [
    BoxShadow(
      color: intentColor.withValues(alpha: 0.2 * glowAnimation.value),
      blurRadius: 12,
      spreadRadius: 2,
    ),
  ],
  ```

**å†…å®¹ç»“æ„**:
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ğŸ’¬ è¾“å…¥æ¶ˆæ¯...                     â”‚  â† å·¦ä¾§è¾“å…¥æ¡†
â”‚                                     â”‚
â”‚  [è¯­éŸ³] [å‘é€]                      â”‚  â† å³ä¾§æ“ä½œæŒ‰é’®
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**è¾“å…¥æ¡†æ ·å¼**:
- **æ–‡æœ¬é¢œè‰²**: `DS.textSecondary`
- **å­—ä½“å¤§å°**: 15px
- **æç¤ºæ–‡æœ¬**:
  - é»˜è®¤: "Tell me what you think..." (æˆ–ä¼ å…¥ hintText)
  - è¯­éŸ³ä¸­: "Listening..."
- **æç¤ºæ–‡æœ¬é¢œè‰²**:
  - è¯­éŸ³ä¸­: `DS.primaryBase`
  - é»˜è®¤: `DS.textSecondary` (80% é€æ˜åº¦)
- **è¾¹æ¡†**: æ—  (`InputBorder.none`)

**æ„å›¾è¯†åˆ«ç³»ç»Ÿ** (è‡ªåŠ¨æ£€æµ‹è¾“å…¥å†…å®¹):
- **TASK** (ä»»åŠ¡): åŒ…å« "æé†’", "åš", "ä»»åŠ¡", "task", "remind", "todo"
  - è¾¹æ¡†é¢œè‰²: `DS.successAccent` (ç»¿è‰²)
  - å‘é€å›¾æ ‡: å‘ä¸Šç®­å¤´
- **CAPSULE** (èƒ¶å›Š): åŒ…å« "çƒ¦", "æƒ³", "!", "feel", "think"
  - è¾¹æ¡†é¢œè‰²: ç´«è‰² (purpleAccent)
  - å‘é€å›¾æ ‡: å‘ä¸Šç®­å¤´
- **CHAT** (èŠå¤©): æ–‡æœ¬é•¿åº¦ > 10
  - è¾¹æ¡†é¢œè‰²: `DS.brandPrimaryAccent`
  - å‘é€å›¾æ ‡: `Icons.auto_awesome`
- **æ— æ„å›¾**: `DS.textSecondary` (15% é€æ˜åº¦)

**åŠ¨ç”»ç³»ç»Ÿ**:
- **å‘å…‰åŠ¨ç”»**: `AnimationController` (800ms)
  - é€æ˜åº¦èŒƒå›´: 0.0 â†’ 1.0
  - æ›²çº¿: `Curves.easeInOut`
  - è§¦å‘: æ„å›¾å˜åŒ–æ—¶

**æŒ‰é’®çŠ¶æ€**:
- **åŠ è½½ä¸­**: `CircularProgressIndicator` (strokeWidth: 2)
- **è¯­éŸ³æŒ‰é’®** (è¾“å…¥æ¡†ä¸ºç©º):
  - å›¾æ ‡: `Icons.mic`
  - é¢œè‰²: `DS.primaryBase`
  - åŠŸèƒ½: è¯­éŸ³è¾“å…¥
- **å‘é€æŒ‰é’®** (æœ‰è¾“å…¥å†…å®¹):
  - å›¾æ ‡: æ ¹æ®æ„å›¾ç±»å‹å˜åŒ–
  - é¢œè‰²: æ„å›¾é¢œè‰²æˆ– `DS.textSecondary`
  - åŠŸèƒ½: æäº¤å†…å®¹

**è¯­éŸ³è¾“å…¥åŠŸèƒ½**:
- **åˆ‡æ¢**: ç‚¹å‡»éº¦å…‹é£ â†’ å¼€å§‹ç›‘å¬
- **è§†è§‰åé¦ˆ**:
  - è¾¹æ¡†è„‰å†²åŠ¨ç”» (repeat reverse)
  - æç¤ºæ–‡æœ¬: "Listening..."
- **æ¨¡æ‹Ÿè¡Œä¸º**: 2ç§’åè‡ªåŠ¨å¡«å……æµ‹è¯•æ–‡æœ¬
  - æ–‡æœ¬: "åˆ›å»ºä¸€ä¸ªå¤ä¹ ç¦»æ•£æ•°å­¦çš„è®¡åˆ’"
  - è§¦å‘æ„å›¾è¯†åˆ«
  - åœæ­¢åŠ¨ç”»
- **åœæ­¢**: ç‚¹å‡»åœæ­¢å›¾æ ‡ â†’ ç»“æŸç›‘å¬

**æäº¤æµç¨‹** (`_submit()`):
1. è®¾ç½®åŠ è½½çŠ¶æ€
2. è°ƒç”¨ `omniBarRepositoryProvider.dispatch(text)`
3. å¤„ç†ç»“æœ:
   - `CHAT`: è·³è½¬ `/chat`
   - `TASK`: åˆ·æ–°ä»»åŠ¡åˆ—è¡¨å’Œ Dashboard
   - `CAPSULE`: åˆ·æ–°è®¤çŸ¥æ•°æ®å’Œ Dashboard
4. æ¸…ç©ºè¾“å…¥æ¡†
5. é‡ç½®æ„å›¾çŠ¶æ€

**äº¤äº’ç‰¹æ€§**:
- **å›è½¦å‘é€**: å¯é…ç½® (`enterToSendProvider`)
- **è‡ªåŠ¨æ„å›¾æ£€æµ‹**: è¾“å…¥æ—¶å®æ—¶åˆ†æ
- **è§†è§‰åé¦ˆ**: è¾¹æ¡†å‘å…‰ + é˜´å½±
- **é”™è¯¯å¤„ç†**: SnackBar æ˜¾ç¤ºé”™è¯¯

**æ€§èƒ½ä¼˜åŒ–**:
- `ConsumerStatefulWidget` ç®¡ç†çŠ¶æ€
- `dispose()` é‡Šæ”¾æ§åˆ¶å™¨
- `mounted` æ£€æŸ¥é˜²æ­¢å†…å­˜æ³„æ¼

**ä¾èµ–**:
- `omniBarRepositoryProvider`: åç«¯åˆ†å‘æœåŠ¡
- `enterToSendProvider`: è®¾ç½®é¡¹
- `taskListProvider`: ä»»åŠ¡ç®¡ç†
- `dashboardProvider`: ä»ªè¡¨æ¿çŠ¶æ€
- `cognitiveProvider`: è®¤çŸ¥æ•°æ®

## 4. æ˜Ÿç³»å›¾ (Galaxy Screen) è¯¦ç»†æ ·å¼

### 4.1 é¡µé¢ç»“æ„
**æ–‡ä»¶**: `mobile/lib/features/galaxy/presentation/screens/galaxy_screen.dart`

**å¤šå±‚æ¶æ„**:
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 0. Parallax Star Background     â”‚  â† è§†å·®æ˜Ÿç©º (æœ€åº•å±‚)
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ 1. Interactive Viewer           â”‚  â† å¯ç¼©æ”¾ç”»å¸ƒå®¹å™¨
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚   â”‚ 1.1 Sector Background   â”‚   â”‚  â† æ‰‡åŒºèƒŒæ™¯ (é™æ€)
â”‚   â”‚ 1.2 Central Flame       â”‚   â”‚  â† ä¸­å¤®ç«ç„° (é™æ€ä½ç½®)
â”‚   â”‚ 1.3 Star Map Painter    â”‚   â”‚  â† æ˜Ÿç³»åœ°å›¾ (åŠ¨æ€ç»˜åˆ¶)
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ 2. Entrance Animation           â”‚  â† è¿›å…¥åŠ¨ç”» (å…¨å±è¦†ç›–)
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ 3. Energy Transfer Animations   â”‚  â† èƒ½é‡ä¼ è¾“ (ç²’å­æµ)
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ 4. Success Animations           â”‚  â† æˆåŠŸç»½æ”¾æ•ˆæœ
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ 5. UI Overlays                  â”‚  â† UIè¦†ç›–å±‚
â”‚   - Back Button                 â”‚  â† è¿”å›æŒ‰é’®
â”‚   - Search Button               â”‚  â† æœç´¢æŒ‰é’®
â”‚   - Refresh Button              â”‚  â† åˆ·æ–°æŒ‰é’®
â”‚   - Offline Indicator           â”‚  â† ç¦»çº¿æŒ‡ç¤ºå™¨
â”‚   - Guide Button                â”‚  â† æŒ‡å—æŒ‰é’®
â”‚   - Mini Map                    â”‚  â† è¿·ä½ åœ°å›¾
â”‚   - Zoom Controls               â”‚  â† ç¼©æ”¾æ§åˆ¶
â”‚   - Spark Button                â”‚  â† ç‚¹ç‡ƒæŒ‰é’®
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ 6. Node Preview Card            â”‚  â† èŠ‚ç‚¹é¢„è§ˆå¡ç‰‡
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**å…³é”®å®ç°ç»†èŠ‚**:
- ä½¿ç”¨ `InteractiveViewer` å®ç°ç¼©æ”¾/å¹³ç§»
- `TransformationController` ç®¡ç†è§†å›¾çŠ¶æ€
- `AnimatedBuilder` é‡å»ºéœ€è¦å˜åŒ–çš„éƒ¨åˆ†
- `RepaintBoundary` ä¼˜åŒ–é‡ç»˜

### 4.2 ç”»å¸ƒå‚æ•°
```dart
// ç”»å¸ƒå¸¸é‡ (åŸºäº GalaxyLayoutEngine)
static const double _canvasPadding = 400.0;
static const double _canvasSize =
    GalaxyLayoutEngine.outerRadius * 2 + _canvasPadding * 2;  // ~3200px
static const double _canvasCenter = _canvasSize / 2;          // 1600px
static const double _centralFlameSize = 60.0;

// InteractiveViewer é…ç½®
minScale: 0.1,        // å®‡å®™è§†å›¾ (10%)
maxScale: 3.0,        // èŠ‚ç‚¹è¯¦æƒ…è§†å›¾ (300%)
initialScale: 0.15    // åˆå§‹è§†å›¾ (15%)
boundaryMargin: EdgeInsets.all(2000)  // å·¨å¤§æ»šåŠ¨åŒºåŸŸ
constrained: false    // æ— é™ç”»å¸ƒ
```

**åˆå§‹å®šä½** (Post Frame):
```dart
final tx = size.width / 2 - _canvasCenter * initialScale;
final ty = size.height / 2 - _canvasCenter * initialScale;
// ç»“æœ: å±å¹•ä¸­å¿ƒå¯¹å‡†æ˜Ÿç³»ä¸­å¿ƒ
```

### 4.3 è§†è§‰æ•ˆæœç³»ç»Ÿ

#### èƒŒæ™¯å±‚ (Parallax Star Background)
**æ–‡ä»¶**: `parallax_star_background.dart`
**å®ç°**: å¤šå±‚ `CustomPaint` + è§†å·®è®¡ç®—

**æ•ˆæœ**:
- **å¤šå±‚æ˜Ÿæ˜Ÿ**: 3å±‚ä¸åŒé€Ÿåº¦ (0.5x, 1x, 2x)
- **è§†å·®è®¡ç®—**: åŸºäº `transformationController` çŸ©é˜µ
- **æ€§èƒ½ä¼˜åŒ–**:
  - åªç»˜åˆ¶å¯è§åŒºåŸŸ (viewport culling)
  - ç¼“å­˜é™æ€æ˜Ÿæ˜Ÿ
  - ä½æ€§èƒ½æ¨¡å¼å‡å°‘æ˜Ÿæ˜Ÿæ•°é‡

**LOD (Level of Detail)**:
- é«˜ç¼©æ”¾: æ›´å¤šæ˜Ÿæ˜Ÿ, æ›´äº®
- ä½ç¼©æ”¾: æ›´å°‘æ˜Ÿæ˜Ÿ, æ›´æš—

#### æ‰‡åŒºèƒŒæ™¯ (Sector Background)
**æ–‡ä»¶**: `sector_background_painter.dart`
**å®ç°**: `TiledSectorBackground` widget

**ç»˜åˆ¶å†…å®¹**:
- **6ä¸ªæ‰‡åŒº**: ä¸åŒé¢œè‰² (åŸºäº `SectorConfig`)
- **æ¸å˜æ•ˆæœ**: ä»ä¸­å¿ƒå‘å¤–æ·¡å‡º
- **é™æ€ç¼“å­˜**: ä½¿ç”¨ `RepaintBoundary`

**æ‰‡åŒºé¢œè‰²** (åŸºäº `SectorEnum`):
- å­¦ä¹ : è“è‰²ç³»
- è®­ç»ƒ: æ©™è‰²ç³»
- çº é”™: çº¢è‰²ç³»
- åæ€: ç´«è‰²ç³»
- ç¤¾äº¤: ç»¿è‰²ç³»
- è®¡åˆ’: é’è‰²ç³»

#### æ˜Ÿç³»åœ°å›¾ (Star Map Painter)
**æ–‡ä»¶**: `star_map_painter.dart`
**å®ç°**: `CustomPaint` + `StarMapPainter`

**ç»˜åˆ¶å†…å®¹** (LOD ç³»ç»Ÿ):
```
LOD 0 (<0.2): ä»…æ‰‡åŒºå…‰æ™• + é›†ç¾¤æ ‡ç­¾
LOD 1 (0.2-0.4): å¤§èŠ‚ç‚¹ (importance â‰¥ 3) + å…³é”®æ ‡ç­¾
LOD 2 (0.4-0.6): æ‰€æœ‰èŠ‚ç‚¹ + çˆ¶å­è¿çº¿ + æ ‡å‡†æ ‡ç­¾
LOD 3 (0.6-0.8): å…³è”è¿çº¿ + å‘å…‰æ•ˆæœ + æ›´å¤šæ ‡ç­¾
LOD 4 (>0.8): å…¨æ–‡æœ¬ + åŠ¨æ€ç²’å­
```

**èŠ‚ç‚¹ç»˜åˆ¶**:
```dart
// åŠå¾„è®¡ç®—
radius = 3.0 + importance * 2.0

// åŠ¨ç”»ç¼©æ”¾
final progress = nodeAnimationProgress[node.id] ?? 1.0;
final r = radius * (0.3 + progress * 0.7);

// èŠ‚ç‚¹æ ·å¼
if (node.isUnlocked) {
  // å‘å…‰: LOD 3+, é«˜æ€§èƒ½
  if (scale >= 0.6 && tier == high) {
    glowPaint.color = color.withAlpha(0.3 + mastery * 0.5);
    canvas.drawCircle(pos, r * 3.0, glowPaint);
  }

  // ä¸»èŠ‚ç‚¹: æ¸å˜æˆ–çº¯è‰²
  if (tier != low && dpr >= 1.5) {
    nodePaint.shader = RadialGradient(colors: [core, color]);
  } else {
    nodePaint.color = color;
  }

  canvas.drawCircle(pos, r, nodePaint);

  // ç ”ç©¶æ¬¡æ•°ç¯
  if (studyCount >= 2) {
    canvas.drawCircle(pos, r * 1.6, strokePaint);
  }
} else {
  // æœªè§£é”: åŠé€æ˜å°åœ†
  canvas.drawCircle(pos, r * 0.8,
    Paint()..color = DS.brandPrimary.withAlpha(0.2));
}
```

**è¿çº¿ç»˜åˆ¶**:
- **ç±»å‹æ ·å¼**: 7ç§å…³ç³»ç±»å‹
  - prerequisite: è“è‰², å®çº¿, ç®­å¤´
  - derived: ç»¿è‰², å®çº¿, ç®­å¤´
  - related: æ©™è‰², è™šçº¿ (8px)
  - similar: ç´«è‰², è™šçº¿ (4px)
  - contrast: çº¢è‰², è™šçº¿ (12px)
  - application: é’è‰², å®çº¿
  - parent-child: å“ç‰Œè‰², å®çº¿, 1.8px
- **æ€§èƒ½ä¼˜åŒ–**:
  - ä½åˆ†è¾¨ç‡è·³è¿‡ç»†çº¿
  - å¼±è¿çº¿åœ¨ä½æ€§èƒ½æ¨¡å¼è·³è¿‡
  - è§†å£è£å‰ª

**æ ‡ç­¾ç»˜åˆ¶** (BatchTextRenderer):
```dart
// LOD æ ‡ç­¾æ˜¾ç¤ºè§„åˆ™
if (scale >= 0.8) showLabel = true;                    // L4: å…¨éƒ¨
else if (scale >= 0.6 && importance >= 2) showLabel = true;  // L3: Imp â‰¥ 2
else if (scale >= 0.4 && importance >= 3) showLabel = true;  // L2: Imp â‰¥ 3
else if (scale >= 0.2 && importance >= 4) showLabel = true;  // L1: Imp â‰¥ 4
```

**æ€§èƒ½ä¼˜åŒ–**:
- **æ™ºèƒ½ç¼“å­˜**: `SmartCache` (max 10 entries)
  - èŠ‚ç‚¹ç¼“å­˜
  - è¾¹ç¼“å­˜
  - é¢œè‰²ç¼“å­˜
  - ä½ç½®ç¼“å­˜
- **é¢„å¤„ç†**: `_preprocessData()` ä¸€æ¬¡è®¡ç®—
- **è§†å£è£å‰ª**: åªç»˜åˆ¶å¯è§èŠ‚ç‚¹/è¾¹
- **DPRç¼©æ”¾**: åŠ¨æ€é™ä½æ¸²æŸ“åˆ†è¾¨ç‡
  ```dart
  final renderScale = (currentDpr / devicePixelRatio).clamp(0.1, 1.0);
  if (renderScale > 0.99) return content;
  return Transform.scale(scale: 1 / renderScale, child: content);
  ```

#### ä¸­å¤®ç«ç„° (Central Flame)
**æ–‡ä»¶**: `central_flame.dart`
**å®ç°**: å¤šå±‚ `Container` + `AnimatedBuilder`

**è§†è§‰**:
- **å¤šå±‚å åŠ **: 3å±‚åœ†å½¢, ä¸åŒå¤§å°
- **é¢œè‰²**: `DS.flameCore` (æ©™é»„æ¸å˜)
- **å¼ºåº¦**: åŸºäº `userFlameIntensity` (0.0-1.0)
- **åŠ¨ç”»**: å‘¼å¸æ•ˆæœ (2000ms å¾ªç¯)

**ä½ç½®**: ç”»å¸ƒä¸­å¿ƒ `(_canvasCenter, _canvasCenter)`

#### èƒ½é‡ä¼ è¾“åŠ¨ç”» (Energy Transfer)
**æ–‡ä»¶**: `energy_particle.dart`
**å®ç°**: ç²’å­ç³»ç»Ÿ widget

**æ•ˆæœ**:
- **ç²’å­æ•°é‡**: 20-30ä¸ª
- **è·¯å¾„**: ä»å±å¹•ä¸­å¿ƒåˆ°ç›®æ ‡èŠ‚ç‚¹ (è´å¡å°”æ›²çº¿)
- **é¢œè‰²**: ç›®æ ‡èŠ‚ç‚¹é¢œè‰²
- **åŠ¨ç”»æ›²çº¿**: `Curves.easeOutCubic`
- **æŒç»­æ—¶é—´**: 1500ms

**æµç¨‹**:
1. ç”¨æˆ·ç‚¹å‡» Spark æŒ‰é’®
2. éšæœºé€‰æ‹©èŠ‚ç‚¹
3. è®¡ç®—å±å¹•åæ ‡
4. åˆ›å»ºç²’å­æµ
5. åŠ¨ç”»å®Œæˆåè°ƒç”¨ `sparkNode()` API
6. è§¦å‘æˆåŠŸåŠ¨ç”»

#### æˆåŠŸåŠ¨ç”» (Star Success)
**æ–‡ä»¶**: `star_success_animation.dart`
**å®ç°**: å¤šå±‚åœ†å½¢æ‰©æ•£ + ç²’å­é£æº…

**æ•ˆæœ**:
- **æ‰©æ•£**: 3å±‚åœ†å½¢, ä¸åŒé€Ÿåº¦
- **ç²’å­**: 15-20ä¸ªå‘å¤–é£æº…
- **é¢œè‰²**: ç›®æ ‡èŠ‚ç‚¹é¢œè‰²
- **æŒç»­æ—¶é—´**: 800ms
- **æ›²çº¿**: `Curves.easeOutBack`

### 4.5 UI è¦†ç›–å±‚

#### è¿·ä½ åœ°å›¾ (Mini Map)
**æ–‡ä»¶**: `galaxy_mini_map.dart`
**ä½ç½®**: å·¦ä¸‹è§’, `bottom: 40px, left: 20px`
**å°ºå¯¸**: 120x120px (å›ºå®š)

**å†…å®¹**:
- **ç¼©ç•¥å›¾**: æ•´ä¸ªæ˜Ÿç³»çš„ç®€åŒ–è§†å›¾
- **è§†å£æ¡†**: å½“å‰å¯è§åŒºåŸŸæŒ‡ç¤º
- **çƒ­åŠ›å›¾**: èŠ‚ç‚¹å¯†åº¦é¢œè‰²

**å®ç°**:
```dart
// ç¼©æ”¾è®¡ç®—
final miniScale = 120 / _canvasSize;  // ~0.0375

// ç»˜åˆ¶æ‰€æœ‰èŠ‚ç‚¹ (ç®€åŒ–)
for (final node in nodes) {
  final pos = nodePositions[node.id]! * miniScale;
  canvas.drawCircle(pos, 1.5, paint);
}

// è§†å£æŒ‡ç¤ºå™¨
final viewportRect = viewport * miniScale;
canvas.drawRect(viewportRect, borderPaint);
```

#### ç¼©æ”¾æ§åˆ¶ (Zoom Controls)
**æ–‡ä»¶**: `zoom_controls.dart`
**ä½ç½®**: å³ä¸‹è§’, `bottom: 120px, right: 20px`

**æŒ‰é’®** (3ä¸ªåœ†å½¢æŒ‰é’®):
- **æ”¾å¤§ (+)**: `scale += 0.2`
- **ç¼©å° (-)**: `scale -= 0.2`
- **é‡ç½®**: `scale = 0.15`

**æ ·å¼**:
- èƒŒæ™¯: `DS.brandPrimary.withAlpha(0.1)`
- è¾¹æ¡†: `DS.brandPrimary.withAlpha(0.3)`
- å›¾æ ‡: 18px, `DS.brandPrimary`

#### Spark æŒ‰é’® (ç‚¹ç‡ƒèŠ‚ç‚¹)
**ä½ç½®**: å³ä¸‹è§’, `bottom: 40px, right: 20px`
**è§†è§‰**:
- **ç±»å‹**: `FloatingActionButton.mini`
- **èƒŒæ™¯**: `DS.brandPrimary.withAlpha(0.9)`
- **å›¾æ ‡**: `Icons.bolt` (ç™½è‰²)
- **å°ºå¯¸**: 40px (Mini FAB)
- **åœ†è§’**: å®Œå…¨åœ†å½¢

**äº¤äº’**:
```dart
onPressed: () {
  // éšæœºé€‰æ‹©èŠ‚ç‚¹
  final node = nodes[DateTime.now().millisecond % nodes.length];
  _sparkNodeWithAnimation(node.id);
}
```

**æµç¨‹**:
1. è®¡ç®—èŠ‚ç‚¹å±å¹•åæ ‡
2. åˆ›å»ºèƒ½é‡ä¼ è¾“åŠ¨ç”»
3. åŠ¨ç”»å®Œæˆåè°ƒç”¨ API
4. æ˜¾ç¤ºæˆåŠŸåŠ¨ç”»
5. SnackBar åé¦ˆ

#### æœç´¢å¯¹è¯æ¡† (Search Dialog)
**æ–‡ä»¶**: `galaxy_search_dialog.dart`
**è§¦å‘**: å³ä¸Šè§’æœç´¢æŒ‰é’®

**å†…å®¹**:
- **è¾“å…¥æ¡†**: èŠ‚ç‚¹åç§°æœç´¢
- **ç»“æœåˆ—è¡¨**: å¯ç‚¹å‡»é¡¹
- **é€‰æ‹©å**: è‡ªåŠ¨ç¼©æ”¾åˆ°ç›®æ ‡èŠ‚ç‚¹

**äº¤äº’**:
```dart
onNodeSelected: (nodeId) {
  _animateToNode(nodeId);  // å¹³æ»‘åŠ¨ç”» + ç¼©æ”¾
}
```

#### æŒ‡å—æŒ‰é’® (Guide Button)
**ä½ç½®**: å·¦ä¸‹è§’, `bottom: 180px, left: 30px`
**åŠŸèƒ½**: æ™ºèƒ½æ¨èä¸‹ä¸€ä¸ªèŠ‚ç‚¹
- è°ƒç”¨ `predictNextNode()` API
- æœ‰æ¨è: è‡ªåŠ¨ç¼©æ”¾å®šä½
- æ— æ¨è: æ˜¾ç¤ºæç¤º

#### ç¦»çº¿æŒ‡ç¤ºå™¨ (Offline Indicator)
**ä½ç½®**: é¡¶éƒ¨, `top: 56px, left/right: 20px`
**æ˜¾ç¤ºæ¡ä»¶**: `galaxyState.isUsingCache == true`
**æ ·å¼**: è­¦å‘Šæ¡ + é‡è¯•æŒ‰é’®

### 4.6 äº¤äº’ç³»ç»Ÿ

#### æ‰‹åŠ¿å¤„ç†
**æ–‡ä»¶**: `galaxy_screen.dart` (GestureDetector)

**Tap (å•å‡»)**:
```dart
// è½¬æ¢å±å¹•åæ ‡åˆ°ç”»å¸ƒ
final canvasTap = _screenToCanvas(details.localPosition);
final scale = controller.value.getMaxScaleOnAxis();
final hitRadius = 30 / scale;  // åŠ¨æ€å‘½ä¸­åŠå¾„

// æŸ¥æ‰¾èŠ‚ç‚¹
for (final node in visibleNodes) {
  final distance = (canvasTap - nodePos).distance;
  if (distance < hitRadius + node.importance * 2) {
    ref.read(galaxyProvider.notifier).selectNode(node.id);
    HapticFeedback.selectionClick();
    return;
  }
}

// æœªå‘½ä¸­: å–æ¶ˆé€‰æ‹©
ref.read(galaxyProvider.notifier).deselectNode();
```

**Long Press (é•¿æŒ‰)**:
- ç±»ä¼¼ Tap æ£€æµ‹
- è§¦å‘: `context.push('/galaxy/node/${node.id}')`
- Haptic: `HapticFeedback.mediumImpact()`

**Pan (æ‹–æ‹½)**:
- `_hasDragged` æ ‡è®°é˜²æ­¢æ‰‹åŠ¿å†²çª
- å»¶è¿Ÿ 100ms é‡ç½®æ ‡è®°

#### èŠ‚ç‚¹é€‰æ‹©
**çŠ¶æ€**: `selectedNodeId`
**è§†è§‰åé¦ˆ**:
- **è„‰å†²åŠ¨ç”»**: 2ç§’å¾ªç¯, `Curves.easeInOut`
- **é€‰ä¸­é«˜äº®**:
  - å¤–åœˆ: 40px + è„‰å†² (8px)
  - å†…åœˆ: 40px å¡«å…… (é«˜æ€§èƒ½æ¨¡å¼)
  - é¢œè‰²: `DS.brandPrimary` (åŠ¨æ€é€æ˜åº¦)

#### ç›¸æœºåŠ¨ç”» (Camera Animation)
**æ–¹æ³•**: `_animateToNode(nodeId)`

**è®¡ç®—ç›®æ ‡çŸ©é˜µ**:
```dart
// ç›®æ ‡ç¼©æ”¾
final targetScale = currentScale < 0.8 ? 1.0 : currentScale;

// ç›®æ ‡ä½ç½® (å±…ä¸­èŠ‚ç‚¹)
final tx = screenSize.width / 2 - canvasX * targetScale;
final ty = screenSize.height / 2 - canvasY * targetScale;

// åº”ç”¨çŸ©é˜µ
targetMatrix.setTranslationRaw(tx, ty, 0.0);
targetMatrix[0] = targetScale;  // X scale
targetMatrix[5] = targetScale;  // Y scale
```

**åŠ¨ç”»**:
- æ—¶é•¿: 1500ms
- æ›²çº¿: `Curves.easeInOutCubic`
- æç¤º: SnackBar + æ“ä½œæŒ‰é’®

### 4.7 æ€§èƒ½ä¼˜åŒ–ç³»ç»Ÿ

#### æ€§èƒ½å±‚çº§ (PerformanceTier)
**æ–‡ä»¶**: `performance_service.dart`

**è‡ªåŠ¨é™çº§**:
```dart
// ç›‘æ§æŒ‡æ ‡
- FPS < 30: é™çº§åˆ° Medium
- FPS < 20: é™çº§åˆ° Low
- å†…å­˜å‹åŠ›: é™çº§åˆ° Low

// æ€§èƒ½å±‚çº§
enum PerformanceTier {
  ultra,   // å…¨ç‰¹æ•ˆ: å‘å…‰, ç²’å­, æ¸å˜
  high,    // æ ‡å‡†: å‘å…‰, ç®€å•ç²’å­
  medium,  // ç®€åŒ–: æ— å‘å…‰, ç®€å•çº¿æ¡
  low,     // æç®€: çº¯è‰², æ— è™šçº¿
}
```

**DPR åŠ¨æ€è°ƒæ•´**:
```dart
// æ¯å¸§æ£€æŸ¥
final currentDpr = PerformanceService.instance.currentDpr.value;
final renderScale = (currentDpr / devicePixelRatio).clamp(0.1, 1.0);

// æ¸²æŸ“ç­–ç•¥
if (renderScale > 0.99) {
  return content;  // å…¨åˆ†è¾¨ç‡
} else {
  return Transform.scale(
    scale: 1 / renderScale,
    child: RepaintBoundary(child: content),
  );
}
```

#### ç¦»çº¿æ”¯æŒ
**æœºåˆ¶**: ç¼“å­˜ + é‡è¯•
- **ç¼“å­˜**: è‡ªåŠ¨ä¿å­˜æ˜Ÿç³»æ•°æ®åˆ°æœ¬åœ°
- **æŒ‡ç¤ºå™¨**: æ˜¾ç¤º "ä½¿ç”¨ç¼“å­˜æ•°æ®"
- **é‡è¯•**: æŒ‰é’®è§¦å‘ `forceRefresh: true`

#### ç”Ÿå‘½å‘¨æœŸç®¡ç†
```dart
@override
void dispose() {
  _isDisposing = true;
  for (final controller in _transientControllers) {
    controller.dispose();
  }
  _selectionPulseController.dispose();
  _transformationController.dispose();
  PerformanceService.instance.stopMonitoring();
  super.dispose();
}
```

### 4.8 æ•°æ®æµ

#### çŠ¶æ€ç®¡ç† (Riverpod)
**Provider**: `galaxyProvider` (StateNotifier)

**çŠ¶æ€ç»“æ„**:
```dart
class GalaxyState {
  List<CompactKnowledgeNode> nodes;
  List<GalaxyEdgeModel> visibleEdges;
  Map<String, Offset> nodePositions;
  Map<String, ClusterInfo> clusters;
  String? selectedNodeId;
  Set<String> expandedEdgeNodeIds;
  Map<String, double> nodeAnimationProgress;
  AggregationLevel aggregationLevel;
  bool isLoading;
  bool isUsingCache;
  String? lastError;
  double userFlameIntensity;
}
```

#### æ•°æ®åŠ è½½
```dart
// 1. åˆå§‹åŒ–
WidgetsBinding.instance.addPostFrameCallback((_) {
  final size = MediaQuery.of(context).size;
  // è®¾ç½®åˆå§‹è§†å›¾
  _transformationController.value = Matrix4.identity()
    ..translate(tx, ty)
    ..scale(0.15);

  // åŠ è½½æ•°æ®
  ref.read(galaxyProvider.notifier).loadGalaxy();
});

// 2. è§†å£æ›´æ–°
void _onTransformChanged() {
  final scale = controller.value.getMaxScaleOnAxis();
  if ((scale - _lastScale).abs() > 0.02) {
    ref.read(galaxyProvider.notifier).updateScale(scale);
  }

  // è®¡ç®—è§†å£
  final viewport = calculateViewport();
  ref.read(galaxyProvider.notifier).updateViewport(viewport);
}

// 3. æ¸²æŸ“
AnimatedBuilder(
  animation: Listenable.merge([
    _transformationController,
    _selectionPulseController,
    PerformanceService.instance.currentTier,
    PerformanceService.instance.currentDpr,
  ]),
  builder: (context, child) {
    // æ„å»º StarMapPainter
    return CustomPaint(painter: painter);
  },
)
```

#### æ€§èƒ½ç›‘æ§
**Service**: `PerformanceService` (å•ä¾‹)
**ç›‘æ§**:
- FPS è®¡ç®—
- å†…å­˜ä½¿ç”¨
- DPR è°ƒæ•´
- è‡ªåŠ¨é™çº§

**è§¦å‘**:
- è¿›å…¥é¡µé¢: `startMonitoring()`
- ç¦»å¼€é¡µé¢: `stopMonitoring()`
- æ¯å¸§: æ›´æ–°æ€§èƒ½æŒ‡æ ‡

## 5. èŠå¤©ç•Œé¢è¯¦ç»†æ ·å¼

### 5.1 é¡µé¢ç»“æ„
**æ–‡ä»¶**: `mobile/lib/features/chat/presentation/screens/chat_screen.dart`

**å¸ƒå±€**:
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ AppBar (æ¯›ç»ç’ƒæ¸å˜)              â”‚  â† é¡¶éƒ¨å¯¼èˆª
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Loading Indicator (é¡¶éƒ¨)        â”‚  â† çº¿æ€§è¿›åº¦æ¡
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Message List (åå‘æ»šåŠ¨)         â”‚  â† æ¶ˆæ¯åˆ—è¡¨
â”‚   - AI Status Indicator         â”‚  â† çŠ¶æ€æŒ‡ç¤º
â”‚   - Reasoning Bubble            â”‚  â† æ¨ç†è¿‡ç¨‹
â”‚   - Streaming Bubble            â”‚  â† æµå¼è¾“å‡º
â”‚   - Chat Bubbles                â”‚  â† å†å²æ¶ˆæ¯
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Error Banner (å¦‚æœæœ‰é”™è¯¯)       â”‚  â† é”™è¯¯æç¤º
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Attachment Chips (å¦‚æœæœ‰é™„ä»¶)   â”‚  â† æ–‡ä»¶é™„ä»¶
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Chat Input                      â”‚  â† è¾“å…¥åŒºåŸŸ
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**å…³é”®ç‰¹æ€§**:
- åå‘æ»šåŠ¨: `reverse: true` (æœ€æ–°æ¶ˆæ¯åœ¨åº•éƒ¨)
- è‡ªåŠ¨æ»šåŠ¨: æ–°æ¶ˆæ¯æ—¶æ»šåŠ¨åˆ°åº•éƒ¨
- ç©ºçŠ¶æ€: æ˜¾ç¤ºå¿«é€Ÿæ“ä½œèŠ¯ç‰‡
- GraphRAG å¯è§†åŒ–: å®æ—¶çŸ¥è¯†å›¾è°±å åŠ 

### 5.2 å¯¼èˆªæ æ ·å¼ (AppBar)
**è§†è§‰ç‰¹å¾**:
- **èƒŒæ™¯**: æ¸å˜ + æ¯›ç»ç’ƒ
  ```dart
  gradient: LinearGradient(
    colors: [
      (isDark ? DS.deepSpaceStart : DS.brandPrimary).withAlpha(0.8),
      (isDark ? DS.deepSpaceEnd : DS.brandPrimary).withAlpha(0.9),
    ],
    begin: Alignment.topCenter,
    end: Alignment.bottomCenter,
  ),
  backdropFilter: ImageFilter.blur(sigmaX: 10, sigmaY: 10),
  ```
- **è¾¹æ¡†**: åº•éƒ¨ 0.5px è¾¹æ¡†, é€æ˜åº¦ 0.05-0.1
- **åœ†è§’**: æ—  (å…¨å®½)
- **é«˜åº¦**: æ ‡å‡† AppBar é«˜åº¦

**å†…å®¹ç»“æ„**:
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ [âš¡]  AIå­¦ä¹ åŠ©æ‰‹          [å†å²] [+] â”‚
â”‚      éšæ—¶ä¸ºä½ è§£ç­”                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**å·¦ä¾§æ ‡é¢˜**:
- **å›¾æ ‡å®¹å™¨**:
  - æ¸å˜: `DS.secondaryGradient`
  - å½¢çŠ¶: åœ†å½¢
  - å†…è¾¹è·: `DS.sm` (8px)
  - å›¾æ ‡: `Icons.auto_awesome` (20px)
- **æ–‡æœ¬åˆ—**:
  - ä¸»æ ‡é¢˜: "AIå­¦ä¹ åŠ©æ‰‹", 16px, Bold, å“ç‰Œè‰²
  - å‰¯æ ‡é¢˜: "éšæ—¶ä¸ºä½ è§£ç­”", 12px, ä¸­æ€§è‰²

**å³ä¾§æŒ‰é’®**:
- **å†å²æŒ‰é’®**: `Icons.history`
  - é¢œè‰²: æ·±è‰²æ¨¡å¼ `DS.brandPrimary70`, æµ…è‰² `DS.neutral700`
  - åŠŸèƒ½: æ‰“å¼€å†å²å¯¹è¯åº•éƒ¨è¡¨å•
- **æ–°å¯¹è¯**: `Icons.add_comment_outlined`
  - é¢œè‰²: åŒä¸Š
  - åŠŸèƒ½: `startNewSession()`

### 5.3 æ¶ˆæ¯æ˜¾ç¤ºç³»ç»Ÿ

#### é¡¶éƒ¨çº¿æ€§è¿›åº¦æ¡
**æ˜¾ç¤ºæ¡ä»¶**: `chatState.isLoading == true`
**æ ·å¼**:
- **é«˜åº¦**: 2px
- **èƒŒæ™¯**: é€æ˜
- **é¢œè‰²**: `DS.primaryBase`
- **åŠ¨ç”»**: æ°´å¹³è¿›åº¦

#### AI çŠ¶æ€æŒ‡ç¤ºå™¨ (AiStatusIndicator)
**ä½ç½®**: æ¶ˆæ¯åˆ—è¡¨é¡¶éƒ¨ (index 0, reversed)
**æ ·å¼**:
- **èƒŒæ™¯**: `DS.surfaceSecondary`
- **åœ†è§’**: `DS.borderRadius12`
- **å†…è¾¹è·**: æ°´å¹³16px, å‚ç›´12px
- **å›¾æ ‡**: åŠ¨æ€æ—‹è½¬çš„ AI å›¾æ ‡
- **æ–‡æœ¬**: å®æ—¶çŠ¶æ€æè¿°

**çŠ¶æ€ç±»å‹**:
- `thinking`: æ€è€ƒä¸­ (è“è‰²)
- `searching`: æœç´¢çŸ¥è¯†åº“ (ç»¿è‰²)
- `generating`: ç”Ÿæˆå›å¤ (æ©™è‰²)
- `executing`: æ‰§è¡ŒåŠ¨ä½œ (ç´«è‰²)

#### æ¨ç†æ°”æ³¡ (AgentReasoningBubble)
**ä½ç½®**: çŠ¶æ€æŒ‡ç¤ºå™¨ä¸‹æ–¹ (index 1)
**è§†è§‰**:
- **èƒŒæ™¯**: `DS.info` è“è‰²ç³», alpha 0.1-0.2
- **è¾¹æ¡†**: å·¦ä¾§ 3px å®çº¿, `DS.info`
- **åœ†è§’**: å³ä¾§å¤§åœ†è§’
- **å†…è¾¹è·**: 16px

**å†…å®¹**:
- **æ­¥éª¤åˆ—è¡¨**:
  - Step 1: åˆ†æç”¨æˆ·æ„å›¾
  - Step 2: æ£€ç´¢ç›¸å…³çŸ¥è¯†
  - Step 3: ç”Ÿæˆå›å¤
- **æ—¶é—´æ˜¾ç¤º**: "æ€è€ƒä¸­: 2.3s"
- **åŠ¨ç”»**: å¯å±•å¼€/æ”¶èµ·

#### æµå¼è¾“å‡ºæ°”æ³¡ (StreamingBubble)
**ä½ç½®**: æ­£åœ¨å‘é€æ—¶æ˜¾ç¤º
**æ ·å¼**:
```dart
Container(
  constraints: BoxConstraints(maxWidth: 80%å±å¹•å®½åº¦),
  padding: EdgeInsets.symmetric(horizontal: 16, vertical: 12),
  decoration: BoxDecoration(
    color: isDark ? DS.neutral800 : DS.brandPrimary,
    borderRadius: BorderRadius.only(
      topLeft: Radius.circular(20),
      topRight: Radius.circular(20),
      bottomRight: Radius.circular(20),
      bottomLeft: Radius.circular(4),
    ),
    boxShadow: DS.shadowSm,
    border: Border.all(
      color: isDark ? DS.neutral700 : DS.neutral200,
    ),
  ),
  child: Row(
    mainAxisSize: MainAxisSize.min,
    children: [
      Flexible(child: Text(content)),
      SizedBox(width: DS.xs),
      _BlinkingCursor(),
    ],
  ),
)
```

**é—ªçƒå…‰æ ‡** (_BlinkingCursor):
- **åŠ¨ç”»**: 500ms å‘¨æœŸ, `repeat(reverse: true)`
- **å°ºå¯¸**: 2px å®½, 16px é«˜
- **é¢œè‰²**: `DS.primaryBase`
- **å®ç°**: `FadeTransition` + `Opacity`

#### æ‰“å­—æŒ‡ç¤ºå™¨ (Typing Indicator)
**æ˜¾ç¤ºæ¡ä»¶**: æ­£åœ¨å‘é€ä½†æ— æµå¼å†…å®¹, ä¸”æ— çŠ¶æ€æŒ‡ç¤ºå™¨
**æ ·å¼**:
- **å®¹å™¨**: åŒ StreamingBubble
- **å†…å®¹**: 3ä¸ªåœ†ç‚¹, æ­£å¼¦æ³¢åŠ¨ç”»
- **åŠ¨ç”»å‘¨æœŸ**: 1200ms
- **åœ†ç‚¹é—´è·**: 4px
- **é¢œè‰²**:
  - æ·±è‰²: `DS.neutral400`
  - æµ…è‰²: `DS.neutral300`

**åŠ¨ç”»åŸç†**:
```dart
// æ¯ä¸ªåœ†ç‚¹å»¶è¿Ÿ 0.2s
final delay = index * 0.2;
final progress = ((_controller.value - delay) % 1.0).clamp(0.0, 1.0);
final offset = sin(progress * pi) * 6;  // æ­£å¼¦æ³¢ä¸Šä¸‹ç§»åŠ¨
```

#### èŠå¤©æ°”æ³¡ (ChatBubble)
**æ”¯æŒç±»å‹**:
- **ç”¨æˆ·æ¶ˆæ¯**: å³å¯¹é½, å“ç‰Œè‰²
- **AIæ¶ˆæ¯**: å·¦å¯¹é½, è¡¨é¢è‰²
- **æ“ä½œç¡®è®¤**: å¸¦æŒ‰é’®çš„ç‰¹æ®Šæ°”æ³¡

**ç”¨æˆ·æ¶ˆæ¯æ ·å¼**:
```dart
Container(
  constraints: BoxConstraints(maxWidth: 80%),
  padding: EdgeInsets.symmetric(horizontal: 16, vertical: 12),
  decoration: BoxDecoration(
    color: DS.brandPrimary,
    borderRadius: BorderRadius.only(
      topLeft: Radius.circular(20),
      topRight: Radius.circular(20),
      bottomLeft: Radius.circular(20),
      bottomRight: Radius.circular(4),
    ),
    boxShadow: DS.shadowSm,
  ),
  child: Text(
    message.content,
    style: TextStyle(color: DS.neutral100),
  ),
)
```

**AIæ¶ˆæ¯æ ·å¼**:
```dart
Container(
  constraints: BoxConstraints(maxWidth: 80%),
  padding: EdgeInsets.symmetric(horizontal: 16, vertical: 12),
  decoration: BoxDecoration(
    color: isDark ? DS.neutral800 : DS.surfaceSecondary,
    borderRadius: BorderRadius.only(
      topLeft: Radius.circular(4),
      topRight: Radius.circular(20),
      bottomLeft: Radius.circular(20),
      bottomRight: Radius.circular(20),
    ),
    boxShadow: DS.shadowSm,
    border: Border.all(
      color: isDark ? DS.neutral700 : DS.neutral200,
    ),
  ),
  child: Column(
    crossAxisAlignment: CrossAxisAlignment.start,
    children: [
      Text(message.content),
      if (message.hasAction) _buildActionButtons(),
    ],
  ),
)
```

**æ“ä½œæŒ‰é’®**:
- **ç¡®è®¤**: ç»¿è‰²æŒ‰é’®, è°ƒç”¨ `onActionConfirm`
- **å–æ¶ˆ**: ç°è‰²æŒ‰é’®, è°ƒç”¨ `onActionDismiss`

### 5.4 å¿«é€Ÿæ“ä½œèŠ¯ç‰‡ (Quick Actions)
**æ˜¾ç¤ºæ¡ä»¶**: æ¶ˆæ¯åˆ—è¡¨ä¸ºç©º, ä¸”æ— çŠ¶æ€/æµå¼å†…å®¹
**ä½ç½®**: å±…ä¸­æ˜¾ç¤º
**å¸ƒå±€**: `Wrap` (æµå¼å¸ƒå±€), å±…ä¸­å¯¹é½

**èŠ¯ç‰‡æ ·å¼**:
```dart
GestureDetector(
  onTapDown: (_) => setState(() => _isPressed = true),
  onTapUp: (_) => setState(() => _isPressed = false),
  child: AnimatedScale(
    scale: _isPressed ? 0.95 : 1.0,
    duration: DS.durationFast,  // 100ms
    child: Container(
      height: DS.touchTargetMinSize,  // 48px (æœ€å°è§¦æ‘¸ç›®æ ‡)
      padding: EdgeInsets.symmetric(horizontal: 16, vertical: 8),
      decoration: BoxDecoration(
        color: isDark ? DS.neutral800 : DS.brandPrimary,
        borderRadius: DS.borderRadius20,
        border: Border.all(
          color: widget.color.withValues(alpha: _isPressed ? 0.6 : 0.3),
          width: _isPressed ? 1.5 : 1.0,
        ),
        boxShadow: [
          BoxShadow(
            color: widget.color.withValues(alpha: _isPressed ? 0.2 : 0.1),
            blurRadius: _isPressed ? 4 : 8,
            offset: _isPressed ? Offset(0, 2) : Offset(0, 4),
          ),
        ],
      ),
      child: Row(
        mainAxisSize: MainAxisSize.min,
        children: [
          Icon(widget.icon, size: 20, color: widget.color),
          SizedBox(width: 8),
          Text(widget.label),
        ],
      ),
    ),
  ),
)
```

**é¢„è®¾èŠ¯ç‰‡**:
1. **æ–°å»ºå¾®ä»»åŠ¡**: `Icons.add_task_rounded`, å“ç‰Œè‰²
   - å‘é€: "å¸®æˆ‘åˆ›å»ºä¸€ä¸ªæ–°çš„å¾®ä»»åŠ¡"
2. **ç”Ÿæˆé•¿æœŸè®¡åˆ’**: `Icons.calendar_month_rounded`, ç´«è‰²
   - å‘é€: "å¸®æˆ‘ç”Ÿæˆä¸€ä¸ªé•¿æœŸå­¦ä¹ è®¡åˆ’"
3. **é”™è¯¯å½’å› **: `Icons.bug_report_rounded`, å“ç‰Œè‰²
   - å‘é€: "æˆ‘æƒ³åˆ†æä¸€ä¸‹æœ€è¿‘çš„é”™è¯¯åŸå› "

**äº¤äº’ç‰¹æ€§**:
- **æŒ‰ä¸‹**: ç¼©æ”¾ 0.95x, è¾¹æ¡†åŠ æ·±, é˜´å½±å˜è¿‘
- **æ¾å¼€**: æ¢å¤åŸçŠ¶, è§¦å‘å‘é€
- **è§¦è§‰åé¦ˆ**: æ—  (ä½¿ç”¨å‘é€åé¦ˆ)

### 5.5 è¾“å…¥åŒºåŸŸ (ChatInput)
**æ–‡ä»¶**: `mobile/lib/presentation/widgets/chat/chat_input.dart`

**ç»“æ„**:
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ [æ–‡ä»¶] [è¾“å…¥æ¡†...]      [è¯­éŸ³] [å‘é€] â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**æ ·å¼**:
- **å®¹å™¨**:
  - èƒŒæ™¯: `DS.surfaceSecondary`
  - è¾¹æ¡†: 1px, `DS.border`
  - åœ†è§’: `DS.borderRadius20`
  - å†…è¾¹è·: æ°´å¹³12px, å‚ç›´8px
- **è¾“å…¥æ¡†**:
  - æ–‡æœ¬é¢œè‰²: `DS.textSecondary`
  - å­—ä½“å¤§å°: 15px
  - æç¤º: "è¾“å…¥æ¶ˆæ¯..."
  - æœ€å¤§è¡Œæ•°: 5 (è‡ªåŠ¨å±•å¼€)
  - è¾¹æ¡†: æ—  (`InputBorder.none`)

**æŒ‰é’®å¸ƒå±€** (å³ä¾§):
- **åŠ è½½ä¸­**: `CircularProgressIndicator` (strokeWidth: 2)
- **è¯­éŸ³æŒ‰é’®** (æ— è¾“å…¥):
  - å›¾æ ‡: `Icons.mic`
  - é¢œè‰²: `DS.primaryBase`
  - åŠŸèƒ½: è¯­éŸ³è¾“å…¥
- **å‘é€æŒ‰é’®** (æœ‰è¾“å…¥):
  - å›¾æ ‡: `Icons.send` æˆ– `Icons.auto_awesome`
  - é¢œè‰²: å“ç‰Œè‰²
  - åŠŸèƒ½: å‘é€æ¶ˆæ¯

**æ–‡ä»¶é™„ä»¶**:
- **ä¸Šä¼ **: ç‚¹å‡»æ–‡ä»¶å›¾æ ‡, é€‰æ‹©æ–‡ä»¶
- **æ˜¾ç¤º**: InputChip åˆ—è¡¨åœ¨è¾“å…¥æ¡†ä¸Šæ–¹
- **çŠ¶æ€**: å¤„ç†ä¸­/å·²å®Œæˆ
- **åˆ é™¤**: ç‚¹å‡» Ã— ç§»é™¤é™„ä»¶
- **é™åˆ¶**: ä»…å¤„ç†å®Œæˆçš„æ–‡ä»¶å¯å‘é€

**äº¤äº’ç‰¹æ€§**:
- **å›è½¦å‘é€**: å¯é…ç½® (`enterToSendProvider`)
- **å¤šè¡Œè¾“å…¥**: è‡ªåŠ¨é«˜åº¦è°ƒæ•´
- **ç¦ç”¨çŠ¶æ€**: `enabled: !chatState.isSending`
- **é”™è¯¯æç¤º**: SnackBar æ˜¾ç¤ºé”™è¯¯

### 5.6 é”™è¯¯ä¸çŠ¶æ€å¤„ç†

#### é”™è¯¯æ¨ªå¹… (Error Banner)
**æ˜¾ç¤ºæ¡ä»¶**: `chatState.error != null`
**æ ·å¼**:
- **èƒŒæ™¯**: `DS.error.withValues(alpha: 0.1)`
- **é¢œè‰²**: `DS.error`
- **å†…è¾¹è·**: `DS.sm` (8px)
- **æ–‡æœ¬**: "Error: [é”™è¯¯ä¿¡æ¯]"
- **ä½ç½®**: è¾“å…¥æ¡†ä¸Šæ–¹

#### é™„ä»¶æç¤º (Attachment Chips)
**æ˜¾ç¤ºæ¡ä»¶**: `chatState.attachedFiles.isNotEmpty`
**æ ·å¼**:
- **å®¹å™¨**: `Wrap` å¸ƒå±€, é—´è·8px
- **èŠ¯ç‰‡**: `InputChip`
  - æ ‡ç­¾: æ–‡ä»¶å (çœç•¥å·)
  - åˆ é™¤: `onDeleted` ç§»é™¤é™„ä»¶
- **ä½ç½®**: è¾“å…¥æ¡†ä¸Šæ–¹, é”™è¯¯æ¨ªå¹…ä¸‹æ–¹

#### æ“ä½œçŠ¶æ€åé¦ˆ (SnackBar)
**è§¦å‘**: `chatState.lastActionStatus` å˜åŒ–
**æ ·å¼**:
- **è¡Œä¸º**: `SnackBarBehavior.floating`
- **æŒç»­æ—¶é—´**: 2ç§’
- **é¢œè‰²**:
  - æˆåŠŸ: `DS.primaryBase`
  - å¤±è´¥: `DS.error`
- **å†…å®¹**: `chatState.lastActionMessage`

### 5.7 å†å²å¯¹è¯åº•éƒ¨è¡¨å•

**è§¦å‘**: AppBar å†å²æŒ‰é’®
**æ ·å¼**:
- **é«˜åº¦**: å±å¹•é«˜åº¦çš„ 70%
- **èƒŒæ™¯**: é€æ˜
- **å†…å®¹å®¹å™¨**:
  - èƒŒæ™¯: æ·±è‰² `DS.neutral900` / æµ…è‰² `DS.brandPrimary`
  - åœ†è§’: é¡¶éƒ¨ 24px
  - æ‹–æ‹½æŠŠæ‰‹: 40x4px, åœ†è§’

**å†…å®¹ç»“æ„**:
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚      â”â”â” (æ‹–æ‹½æŠŠæ‰‹)                 â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ ğŸ“œ å†å²å¯¹è¯                         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ [åˆ—è¡¨: ä¼šè¯é¡¹]                      â”‚
â”‚   â€¢ ä¼šè¯æ ‡é¢˜                        â”‚
â”‚   â€¢ æ›´æ–°æ—¥æœŸ                        â”‚
â”‚   âœ“ å½“å‰ä¼šè¯æ ‡è®°                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**ä¼šè¯é¡¹**:
- **å›¾æ ‡**: åœ†å½¢å®¹å™¨ + `Icons.chat_bubble_outline_rounded`
- **æ ‡é¢˜**: ä¼šè¯æ ‡é¢˜æˆ–"æœªå‘½åä¼šè¯"
- **æ—¥æœŸ**: YYYY-MM-DD æ ¼å¼
- **å½“å‰æ ‡è®°**: ç»¿è‰²å¯¹å‹¾å›¾æ ‡
- **äº¤äº’**: ç‚¹å‡»åŠ è½½å†å²ä¼šè¯

### 5.8 GraphRAG å®æ—¶å¯è§†åŒ–

**ä½ç½®**: æ¶ˆæ¯åˆ—è¡¨ä¸Šæ–¹å åŠ å±‚
**æ˜¾ç¤ºæ¡ä»¶**: `chatState.graphragTrace != null`
**å®ç°**: `GraphRAGVisualizer` widget

**è§†è§‰**:
- **èƒŒæ™¯**: åŠé€æ˜æ·±è‰²é®ç½©
- **èŠ‚ç‚¹**: çŸ¥è¯†å›¾è°±èŠ‚ç‚¹
- **è¿çº¿**: å…³ç³»è¿æ¥çº¿
- **åŠ¨ç”»**: å®æ—¶æ›´æ–°

**åŠŸèƒ½**: å±•ç¤º AI çš„çŸ¥è¯†æ£€ç´¢è¿‡ç¨‹

### 5.9 æ¶ˆæ¯æµç®¡ç†

#### æ¶ˆæ¯é¡ºåº (åå‘æ»šåŠ¨)
```dart
ListView.builder(
  reverse: true,  // æœ€æ–°æ¶ˆæ¯åœ¨åº•éƒ¨
  padding: EdgeInsets.symmetric(horizontal: 16, vertical: 20),
  itemCount: messages.length +
      (isSending ? 1 : 0) +
      (aiStatus != null ? 1 : 0) +
      (isReasoningActive ? 1 : 0),
)
```

#### ç´¢å¼•è®¡ç®—é€»è¾‘
```dart
// 1. AI çŠ¶æ€ (index 0)
if (isStatusShowing && index == 0) {
  return AiStatusIndicator(...);
}

// 2. æ¨ç†æ°”æ³¡ (index 1)
final reasoningIndex = isStatusShowing ? 1 : 0;
if (isReasoningShowing && index == reasoningIndex) {
  return AgentReasoningBubble(...);
}

// 3. æµå¼/æ‰“å­—æŒ‡ç¤º (index 2)
var streamIndex = 0;
if (isStatusShowing) streamIndex++;
if (isReasoningShowing) streamIndex++;

if (isSendingShowing && index == streamIndex) {
  if (streamingContent.isNotEmpty) {
    return StreamingBubble(...);
  }
  if (!isStatusShowing && !isReasoningShowing) {
    return TypingIndicator(...);
  }
  return SizedBox.shrink();
}

// 4. æ­£å¼æ¶ˆæ¯
var msgIndex = index;
if (isStatusShowing) msgIndex--;
if (isReasoningShowing) msgIndex--;
if (isSendingShowing) msgIndex--;

final adjustedIndex = messageCount - 1 - msgIndex;
return ChatBubble(message: messages[adjustedIndex]);
```

#### è‡ªåŠ¨æ»šåŠ¨
```dart
// ç›‘å¬æ¶ˆæ¯å˜åŒ–
ref.listenManual(
  chatProvider.select((state) => state.messages),
  (previous, next) {
    if (next.length > (previous?.length ?? 0)) {
      _scrollToBottom();
    }
  },
);

// æ»šåŠ¨å®ç°
void _scrollToBottom() {
  if (!_scrollController.hasClients) return;
  _scrollController.animateTo(
    0,  // reverse: true æ—¶ 0 æ˜¯åº•éƒ¨
    duration: Duration(milliseconds: 200),
    curve: Curves.easeOut,
  );
}
```

### 5.10 æ€§èƒ½ä¼˜åŒ–

#### æ¶ˆæ¯æ¸²æŸ“ä¼˜åŒ–
- **ListView.builder**: æ‡’åŠ è½½, åªæ¸²æŸ“å¯è§é¡¹
- **åå‘æ»šåŠ¨**: æœ€æ–°æ¶ˆæ¯åœ¨åº•éƒ¨, ç¬¦åˆèŠå¤©ä¹ æƒ¯
- **çº¦æŸé™åˆ¶**: `BoxConstraints(maxWidth: 80%)` é˜²æ­¢è¿‡å®½

#### åŠ¨ç”»ä¼˜åŒ–
- **é—ªçƒå…‰æ ‡**: 500ms å‘¨æœŸ, ä»…åœ¨æµå¼æ—¶æ¸²æŸ“
- **æ‰“å­—æŒ‡ç¤º**: 1200ms å‘¨æœŸ, æ­£å¼¦æ³¢è¿åŠ¨
- **å¿«é€Ÿæ“ä½œ**: 100ms ç¼©æ”¾åŠ¨ç”», æå‡å“åº”æ„Ÿ

#### çŠ¶æ€ç®¡ç†
- **Riverpod**: `chatProvider` ç®¡ç†æ‰€æœ‰çŠ¶æ€
- **é€‰æ‹©å™¨**: `select()` å‡å°‘ä¸å¿…è¦é‡å»º
- **æ‰‹åŠ¨ç›‘å¬**: `listenManual()` å¤„ç†å‰¯ä½œç”¨

#### é”™è¯¯å¤„ç†
- **try-catch**: åŒ…è£¹æ‰€æœ‰å¼‚æ­¥æ“ä½œ
- **mounted æ£€æŸ¥**: é˜²æ­¢ setState åœ¨ dispose åè°ƒç”¨
- **SnackBar**: ç”¨æˆ·å‹å¥½çš„é”™è¯¯åé¦ˆ

## 6. é¡µé¢è·³è½¬æµç¨‹

### 6.1 è·¯ç”±é…ç½®
**æ–‡ä»¶**: `mobile/lib/app/routes.dart`

**ä½¿ç”¨**: `GoRouter` + `Riverpod`

**è½¬åœºåŠ¨ç”»**:
```dart
// ç»Ÿä¸€çš„è½¬åœºæ„å»ºå™¨
CustomTransitionPage<void>(
  transitionsBuilder: (context, animation, secondaryAnimation, child) =>
    SharedAxisTransition(
      animation: animation,
      secondaryAnimation: secondaryAnimation,
      transitionType: SharedAxisTransitionType.horizontal, // æˆ– scaled
      child: child,
    ),
)
```

### 6.2 å®Œæ•´å¯¼èˆªæ ‘

```
Splash Screen (/)
    â†“ (è‡ªåŠ¨è·³è½¬)
Auth Screens
    â”œâ”€ Login (/login)
    â””â”€ Register (/register)
    â†“ (è®¤è¯æˆåŠŸ)
Home Screen (/home) â† ä¸»å…¥å£
    â”‚
    â”œâ”€ ğŸŒŒ Galaxy (/galaxy)
    â”‚   â”œâ”€ Node Detail (/galaxy/node/:id)
    â”‚   â””â”€ Search Dialog (Modal)
    â”‚
    â”œâ”€ ğŸ’¬ Chat (/chat)
    â”‚   â”œâ”€ History (Bottom Sheet)
    â”‚   â””â”€ Session (/chat/session/:id)
    â”‚
    â”œâ”€ ğŸ‘¥ Community (/community)
    â”‚   â”œâ”€ Friends (/community/friends)
    â”‚   â”œâ”€ Groups (/community/groups)
    â”‚   â”‚   â”œâ”€ Detail (/community/groups/:id)
    â”‚   â”‚   â”œâ”€ Tasks (/community/groups/:id/tasks)
    â”‚   â”‚   â”œâ”€ Search (/community/groups/search)
    â”‚   â”‚   â””â”€ Create (/community/groups/create)
    â”‚   â””â”€ Files (Modal)
    â”‚
    â”œâ”€ ğŸ‘¤ Profile (/profile)
    â”‚   â”œâ”€ Edit (/profile/edit)
    â”‚   â””â”€ Settings (/settings)
    â”‚
    â”œâ”€ âœ… Tasks (/tasks)
    â”‚   â”œâ”€ Detail (/tasks/:id)
    â”‚   â””â”€ Create (/tasks/new)
    â”‚
    â”œâ”€ ğŸ“‹ Plans (/plans)
    â”‚   â”œâ”€ Sprint (/sprint)
    â”‚   â”œâ”€ Growth (/growth)
    â”‚   â”œâ”€ Detail (/plans/:id)
    â”‚   â”œâ”€ Edit (/plans/:id/edit)
    â”‚   â””â”€ Create (/plans/new)
    â”‚
    â”œâ”€ ğŸ¯ Focus (/focus)
    â”‚   â””â”€ Mindfulness (/focus/mindfulness)
    â”‚
    â”œâ”€ ğŸ“š Error Book (/errors)
    â”‚   â”œâ”€ Detail (/errors/:id)
    â”‚   â”œâ”€ Add (/errors/new)
    â”‚   â””â”€ Review (/review)
    â”‚
    â””â”€ ğŸ“Š Insights (/learning/forecast)
        â””â”€ Calendar Stats (/calendar-stats)
```

### 6.3 è®¤è¯å®ˆå«
**å®ç°**: GoRouter `redirect` é€»è¾‘

```dart
redirect: (context, state) {
  final authState = authStateNotifier.value;
  final isAuthenticated = authState.isAuthenticated;
  final isLoading = authState.isLoading;
  final isOnAuth = state.uri.path == '/login' || state.uri.path == '/register';
  final isOnSplash = state.uri.path == '/';

  // åŠ è½½ä¸­
  if (isLoading) {
    return isOnAuth ? null : '/';
  }

  // æœªè®¤è¯ -> ç™»å½•
  if (!isAuthenticated && !isOnAuth) {
    return '/login';
  }

  // å·²è®¤è¯ -> é¦–é¡µ
  if (isAuthenticated && (isOnAuth || isOnSplash)) {
    return '/home';
  }

  return null;
}
```

### 5.10 æ€§èƒ½ä¼˜åŒ–

#### æ¶ˆæ¯æ¸²æŸ“ä¼˜åŒ–
- **ListView.builder**: æ‡’åŠ è½½, åªæ¸²æŸ“å¯è§é¡¹
- **åå‘æ»šåŠ¨**: æœ€æ–°æ¶ˆæ¯åœ¨åº•éƒ¨, ç¬¦åˆèŠå¤©ä¹ æƒ¯
- **çº¦æŸé™åˆ¶**: `BoxConstraints(maxWidth: 80%)` é˜²æ­¢è¿‡å®½

#### åŠ¨ç”»ä¼˜åŒ–
- **é—ªçƒå…‰æ ‡**: 500ms å‘¨æœŸ, ä»…åœ¨æµå¼æ—¶æ¸²æŸ“
- **æ‰“å­—æŒ‡ç¤º**: 1200ms å‘¨æœŸ, æ­£å¼¦æ³¢è¿åŠ¨
- **å¿«é€Ÿæ“ä½œ**: 100ms ç¼©æ”¾åŠ¨ç”», æå‡å“åº”æ„Ÿ

#### çŠ¶æ€ç®¡ç†
- **Riverpod**: `chatProvider` ç®¡ç†æ‰€æœ‰çŠ¶æ€
- **é€‰æ‹©å™¨**: `select()` å‡å°‘ä¸å¿…è¦é‡å»º
- **æ‰‹åŠ¨ç›‘å¬**: `listenManual()` å¤„ç†å‰¯ä½œç”¨

#### é”™è¯¯å¤„ç†
- **try-catch**: åŒ…è£¹æ‰€æœ‰å¼‚æ­¥æ“ä½œ
- **mounted æ£€æŸ¥**: é˜²æ­¢ setState åœ¨ dispose åè°ƒç”¨
- **SnackBar**: ç”¨æˆ·å‹å¥½çš„é”™è¯¯åé¦ˆ

## 6. æ­£å¿µ/ä¸“æ³¨æ¨¡å¼è¯¦ç»†æ ·å¼

### 6.1 é¡µé¢ç»“æ„
**æ–‡ä»¶**: `mobile/lib/presentation/screens/focus/mindfulness_mode_screen.dart`

**å¸ƒå±€**:
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Layer 1: æ˜Ÿç©ºèƒŒæ™¯ (å…¨å±)         â”‚  â† AnimatedStarBackground
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Layer 2: ä¸»å†…å®¹ (SafeArea)      â”‚
â”‚   - é¡¶éƒ¨çŠ¶æ€æ                   â”‚  â† åˆ†å¿ƒè®¡æ•° + æ ‡é¢˜ + æš‚åœ
â”‚   - ä¸­é—´å†…å®¹åŒº                  â”‚
â”‚     â€¢ ä»»åŠ¡å¡ç‰‡ (ç¼©æ”¾åŠ¨ç”»)       â”‚
â”‚     â€¢ ç¿»é¡µæ—¶é’Ÿ (æ·¡å…¥)           â”‚
â”‚     â€¢ ç«ç„°åŠ¨ç”» (å‘¼å¸)           â”‚
â”‚   - åº•éƒ¨é€€å‡ºæŒ‰é’®                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**å…³é”®ç‰¹æ€§**:
- **å…¨å±æ¨¡å¼**: `SystemUiMode.immersive` (éšè—ç³»ç»ŸUI)
- **ç”Ÿå‘½å‘¨æœŸç›‘å¬**: æ£€æµ‹åº”ç”¨åˆ‡æ¢ (åˆ†å¿ƒè¡Œä¸º)
- **Pop é˜»æ­¢**: è‡ªå®šä¹‰é€€å‡ºæµç¨‹
- **åŠ¨ç”»ç¼–æ’**: å¤šé˜¶æ®µå…¥åœºåŠ¨ç”»

### 6.2 å…¥åœºåŠ¨ç”»ç³»ç»Ÿ

**åŠ¨ç”»æ§åˆ¶å™¨**:
```dart
_entryController = AnimationController(
  vsync: this,
  duration: const Duration(milliseconds: 800),
);
```

**åŠ¨ç”»åºåˆ—** (Interval):
- **0.0-0.4**: ä»»åŠ¡å¡ç‰‡æ·¡å…¥ (`_fadeAnimation`)
  - æ›²çº¿: `Curves.easeOut`
- **0.2-0.7**: ä»»åŠ¡å¡ç‰‡ç¼©æ”¾ (`_scaleAnimation`)
  - èŒƒå›´: 0.8 â†’ 1.0
  - æ›²çº¿: `Curves.elasticOut` (å¼¹æ€§)
- **0.5-1.0**: æ—¶é’Ÿæ·¡å…¥ (`_clockFadeAnimation`)
  - æ›²çº¿: `Curves.easeIn`

**å¯åŠ¨æµç¨‹**:
```dart
@override
void initState() {
  // 1. è®¾ç½®å…¨å±
  SystemChrome.setEnabledSystemUIMode(SystemUiMode.immersive);

  // 2. å¯åŠ¨æ­£å¿µæ¨¡å¼
  ref.read(mindfulnessProvider.notifier).start(widget.task);

  // 3. å¼€å§‹åŠ¨ç”»
  _entryController.forward();
}
```

### 6.3 é¡¶éƒ¨çŠ¶æ€æ 

**å¸ƒå±€**:
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ [åˆ†å¿ƒ 2 æ¬¡]      æ­£å¿µæ¨¡å¼      [æš‚åœ] â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**åˆ†å¿ƒè®¡æ•°** (ä»…åœ¨ >0 æ—¶æ˜¾ç¤º):
- **å®¹å™¨**:
  - èƒŒæ™¯: `DS.warning.withValues(alpha: 0.2)`
  - åœ†è§’: 20px
  - å†…è¾¹è·: æ°´å¹³12px, å‚ç›´6px
- **å›¾æ ‡**: `Icons.visibility_off_rounded` (16px, é»„è‰²)
- **æ–‡æœ¬**: "åˆ†å¿ƒ X æ¬¡" (12px, é»„è‰², Medium)

**æ ‡é¢˜**:
- **å›¾æ ‡**: `Icons.self_improvement_rounded` (20px, å“ç‰Œè‰² 70%)
- **æ–‡æœ¬**: "æ­£å¿µæ¨¡å¼" (14px, å“ç‰Œè‰² 70%, Medium)

**æš‚åœæŒ‰é’®**:
- **å›¾æ ‡**:
  - æš‚åœä¸­: `Icons.pause_rounded`
  - å·²æš‚åœ: `Icons.play_arrow_rounded`
- **é¢œè‰²**: å“ç‰Œè‰² 70%
- **åŠŸèƒ½**: åˆ‡æ¢æš‚åœ/ç»§ç»­çŠ¶æ€

### 6.4 ä»»åŠ¡å¡ç‰‡

**æ ·å¼**:
```dart
Container(
  margin: EdgeInsets.symmetric(horizontal: 40),
  padding: EdgeInsets.all(DS.xl),  // 24px
  decoration: BoxDecoration(
    color: DS.brandPrimary.withValues(alpha: 0.08),
    borderRadius: BorderRadius.circular(20),
    border: Border.all(
      color: DS.brandPrimary.withValues(alpha: 0.15),
    ),
    boxShadow: [
      BoxShadow(
        color: DS.brandPrimary.withValues(alpha: 0.3),
        blurRadius: 20,
        spreadRadius: 5,
      ),
    ],
  ),
)
```

**å†…å®¹**:
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚      ä»»åŠ¡æ ‡é¢˜ (22px, Bold)   â”‚
â”‚                             â”‚
â”‚    [å­¦ä¹ ] (12px, æ¸å˜èƒŒæ™¯)   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**ä»»åŠ¡æ ‡é¢˜**:
- **å­—ä½“**: 22px, Bold, `DS.brandPrimaryConst`
- **å¯¹é½**: å±…ä¸­
- **é™åˆ¶**: æœ€å¤š2è¡Œ, çœç•¥å·

**ä»»åŠ¡ç±»å‹æ ‡ç­¾**:
- **èƒŒæ™¯**: `DS.primaryGradient`
- **åœ†è§’**: 12px
- **å†…è¾¹è·**: æ°´å¹³12px, å‚ç›´4px
- **æ–‡æœ¬**: å¤§å†™ç±»å‹å, 12px, å“ç‰Œè‰²

**åŠ¨ç”»åŒ…è£…**:
```dart
ScaleTransition(
  scale: _scaleAnimation,
  child: FadeTransition(
    opacity: _fadeAnimation,
    child: _buildTaskCard(),
  ),
)
```

### 6.5 ç¿»é¡µæ—¶é’Ÿ (SimpleFlipClock)

**æ ·å¼**:
- **å­—ä½“å¤§å°**: 72px
- **ä½ç½®**: å±…ä¸­
- **åŠ¨ç”»**: æ·¡å…¥ (0.5-1.0 Interval)

**æ˜¾ç¤ºæ ¼å¼**:
```
HH:MM:SS
```

**æ•°æ®æº**:
- `mindfulness.elapsedSeconds` (ä» Provider)

**è§†è§‰**:
- å¤§å­—ä½“, ç²—ä½“
- å“ç‰Œè‰²æˆ–ä¸­æ€§è‰²
- ç­‰å®½å­—ä½“ (ç¡®ä¿æ•°å­—ä¸è·³åŠ¨)

### 6.6 ç«ç„°åŠ¨ç”»

**å®ç°**: `TweenAnimationBuilder`
```dart
TweenAnimationBuilder<double>(
  tween: Tween(begin: 0.9, end: 1.1),
  duration: Duration(milliseconds: 1500),
  curve: Curves.easeInOut,
  builder: (context, scale, child) => Transform.scale(scale: scale),
  onEnd: () { if (mounted) setState(() {}); },  // å¾ªç¯
)
```

**å®¹å™¨æ ·å¼**:
```dart
Container(
  width: 60,
  height: 60,
  decoration: BoxDecoration(
    gradient: DS.flameGradient,
    shape: BoxShape.circle,
    boxShadow: [
      BoxShadow(
        color: DS.flameCore.withValues(alpha: 0.6),
        blurRadius: 20,
        spreadRadius: 5,
      ),
    ],
  ),
  child: Icon(
    Icons.local_fire_department_rounded,
    color: DS.brandPrimaryConst,
    size: 32,
  ),
)
```

**åŠ¨ç”»ç‰¹æ€§**:
- **ç¼©æ”¾èŒƒå›´**: 0.9 â†’ 1.1 (å‘¼å¸æ•ˆæœ)
- **å‘¨æœŸ**: 1500ms
- **æ›²çº¿**: `Curves.easeInOut`
- **å¾ªç¯**: `onEnd` è§¦å‘ setState

**è§†è§‰**:
- **æ¸å˜**: `DS.flameGradient` (æ©™é»„æ¸å˜)
- **å‘å…‰**: é˜´å½±æ‰©æ•£ 5px, é€æ˜åº¦ 0.6
- **å›¾æ ‡**: æ¶ˆé˜²æ “, 32px, å“ç‰Œè‰²

### 6.7 åº•éƒ¨é€€å‡ºæŒ‰é’®

**æ ·å¼**:
```dart
Padding(
  padding: EdgeInsets.all(DS.xl),  // 24px
  child: TextButton(
    style: TextButton.styleFrom(
      foregroundColor: DS.brandPrimary.withValues(alpha: 0.5),
      padding: EdgeInsets.symmetric(horizontal: 24, vertical: 12),
    ),
    child: Row(
      mainAxisSize: MainAxisSize.min,
      children: [
        Icon(Icons.exit_to_app_rounded, size: 18),
        SizedBox(width: DS.sm),
        Text('é€€å‡ºæ­£å¿µæ¨¡å¼'),
      ],
    ),
  ),
)
```

**äº¤äº’**: è§¦å‘ `_handleExit()`

### 6.8 é€€å‡ºæµç¨‹

**æ­¥éª¤**:
1. **ç¡®è®¤å¯¹è¯æ¡†** (`showExitConfirmation`)
   - æ˜¾ç¤º: å·²ä¸“æ³¨æ—¶é•¿
   - æŒ‰é’®: å–æ¶ˆ / ç¡®è®¤é€€å‡º

2. **åœæ­¢æ­£å¿µæ¨¡å¼**
   ```dart
   ref.read(mindfulnessProvider.notifier).stop();
   ```

3. **åæ€å¯¹è¯æ¡†** (`ReflectionDialog`)
   - å¼ºåˆ¶ä¸æ¶ˆå¤± (`barrierDismissible: false`)
   - æ”¶é›†ç”¨æˆ·åé¦ˆ

4. **è¿”å›ä¸Šä¸€é¡µ**
   ```dart
   context.pop();
   ```

**é˜²è¯¯è§¦**:
```dart
bool _isExiting = false;

Future<void> _handleExit() async {
  if (_isExiting) return;  // é˜²æ­¢é‡å¤ç‚¹å‡»
  _isExiting = true;
  // ... æ‰§è¡Œé€€å‡ºé€»è¾‘
}
```

### 6.9 ç”Ÿå‘½å‘¨æœŸä¸åˆ†å¿ƒæ£€æµ‹

**ç”Ÿå‘½å‘¨æœŸç›‘å¬**:
```dart
@override
void didChangeAppLifecycleState(AppLifecycleState state) {
  if (state == AppLifecycleState.paused) {
    // ç”¨æˆ·åˆ‡æ¢ç¦»å¼€åº”ç”¨
    ref.read(mindfulnessProvider.notifier).recordInterruption(
      InterruptionType.appSwitch,
    );
  } else if (state == AppLifecycleState.resumed) {
    // ç”¨æˆ·è¿”å›åº”ç”¨
    _showInterruptionWarning();
  }
}
```

**åˆ†å¿ƒè­¦å‘Š** (SnackBar):
```dart
ScaffoldMessenger.of(context).showSnackBar(
  SnackBar(
    content: Row(
      children: [
        Icon(Icons.warning_amber_rounded, color: DS.brandPrimary),
        SizedBox(width: DS.md),
        Expanded(
          child: Text('æ£€æµ‹åˆ°åˆ†å¿ƒè¡Œä¸º (ç¬¬ ${state.interruptionCount} æ¬¡)'),
        ),
      ],
    ),
    backgroundColor: DS.warning,
    behavior: SnackBarBehavior.floating,
    duration: Duration(seconds: 3),
  ),
);
```

**åˆ†å¿ƒç±»å‹**:
- `appSwitch`: åˆ‡æ¢åº”ç”¨
- `screenOff`: å±å¹•å…³é—­
- `phoneCall`: æ¥ç”µ

### 6.10 æ€§èƒ½ä¸èµ„æºç®¡ç†

**åŠ¨ç”»é‡Šæ”¾**:
```dart
@override
void dispose() {
  WidgetsBinding.instance.removeObserver(this);
  _entryController.dispose();

  // æ¢å¤ç³»ç»ŸUI
  SystemChrome.setEnabledSystemUIMode(SystemUiMode.edgeToEdge);

  super.dispose();
}
```

**æ˜Ÿç©ºèƒŒæ™¯æ€§èƒ½**:
```dart
AnimatedStarBackground(
  starCount: PerformanceService.instance.focusStarCount,  // åŠ¨æ€æ•°é‡
  enableTwinkle: PerformanceService.instance.enableFocusTwinkle,
)
```

**æ€§èƒ½é™çº§**:
- ä½æ€§èƒ½è®¾å¤‡: å‡å°‘æ˜Ÿæ˜Ÿæ•°é‡
- å…³é—­é—ªçƒåŠ¨ç”»

### 6.11 æ­£å¿µæ¨¡å¼çŠ¶æ€ç®¡ç†

**Provider**: `mindfulnessProvider`

**çŠ¶æ€ç»“æ„**:
```dart
class MindfulnessState {
  bool isActive;              // æ˜¯å¦æ¿€æ´»
  bool isPaused;              // æ˜¯å¦æš‚åœ
  int elapsedSeconds;         // å·²è¿‡ç§’æ•°
  int interruptionCount;      // åˆ†å¿ƒæ¬¡æ•°
  DateTime? startTime;        // å¼€å§‹æ—¶é—´
  DateTime? lastInterruption; // æœ€ååˆ†å¿ƒæ—¶é—´
}
```

**æ ¸å¿ƒæ–¹æ³•**:
- `start(task)`: å¼€å§‹ä¸“æ³¨
- `stop()`: ç»“æŸä¸“æ³¨
- `pause()`: æš‚åœ
- `resume()`: ç»§ç»­
- `recordInterruption(type)`: è®°å½•åˆ†å¿ƒ

**è®¡æ—¶é€»è¾‘**:
```dart
// æ¯ç§’æ›´æ–°
Timer.periodic(Duration(seconds: 1), (timer) {
  if (!isPaused && isActive) {
    elapsedSeconds++;
  }
});
```

## 7. æ·±è‰²/æµ…è‰²æ¨¡å¼å¯¹æ¯”è¡¨

### 7.1 é©¾é©¶èˆ± (Home)

| å…ƒç´  | æµ…è‰²æ¨¡å¼ | æ·±è‰²æ¨¡å¼ |
|------|----------|----------|
| **èƒŒæ™¯** | `WeatherHeader` æ¸å˜ | `WeatherHeader` æ·±è‰²æ¸å˜ |
| **å¡ç‰‡èƒŒæ™¯** | æ¯›ç»ç’ƒ + æµ…è‰²æ¸å˜ | æ¯›ç»ç’ƒ + æ·±è‰²æ¸å˜ |
| **å¡ç‰‡è¾¹æ¡†** | `DS.glassBorder` (æµ…) | `DS.glassBorder` (æ·±) |
| **ä¸»æ–‡æœ¬** | `DS.textSecondary` | `DS.textSecondary` |
| **å“ç‰Œè‰²** | `#FFFF6B35` (æ©™çº¢) | `#FFFF8C5A` (äº®æ©™) |
| **OmniBar** | å“ç‰Œè‰² 80% + å‘å…‰ | å“ç‰Œè‰² 80% + å‘å…‰ |
| **å›¾æ ‡** | å“ç‰Œè‰² 70% | å“ç‰Œè‰² 70% |

### 7.2 æ˜Ÿç³»å›¾ (Galaxy)

| å…ƒç´  | æµ…è‰²æ¨¡å¼ | æ·±è‰²æ¨¡å¼ |
|------|----------|----------|
| **èƒŒæ™¯** | `DS.deepSpaceStart` | `DS.deepSpaceStart` (çº¯é»‘) |
| **èŠ‚ç‚¹** | æ¸å˜ + æµ…è¾¹ | æ¸å˜ + æ·±è¾¹ |
| **è¿çº¿** | æµ…è‰² + é€æ˜åº¦ | æ·±è‰² + é€æ˜åº¦ |
| **ä¸­å¤®ç«ç„°** | `DS.flameGradient` | `DS.flameGradient` (æ›´äº®) |
| **UI è¦†ç›–** | æ¯›ç»ç’ƒæµ…è‰² | æ¯›ç»ç’ƒæ·±è‰² |
| **Mini Map** | æµ…è‰²çƒ­åŠ›å›¾ | æ·±è‰²çƒ­åŠ›å›¾ |

### 7.3 èŠå¤©ç•Œé¢ (Chat)

| å…ƒç´  | æµ…è‰²æ¨¡å¼ | æ·±è‰²æ¨¡å¼ |
|------|----------|----------|
| **å¯¼èˆªæ ** | å“ç‰Œè‰²æ¸å˜ 0.8-0.9 | æ·±ç©ºè‰²æ¸å˜ 0.8-0.9 |
| **ç”¨æˆ·æ¶ˆæ¯** | `DS.brandPrimary` | `DS.brandPrimary` |
| **AI æ¶ˆæ¯** | `DS.surfaceSecondary` | `DS.neutral800` |
| **æµå¼æ°”æ³¡** | `DS.brandPrimary` | `DS.neutral800` |
| **è¾“å…¥æ¡†** | `DS.surfaceSecondary` | `DS.neutral800` |
| **å¿«é€Ÿæ“ä½œ** | `DS.brandPrimary` | `DS.neutral800` |

### 7.4 æ­£å¿µæ¨¡å¼ (Mindfulness)

| å…ƒç´  | æµ…è‰²æ¨¡å¼ | æ·±è‰²æ¨¡å¼ |
|------|----------|----------|
| **èƒŒæ™¯** | `DS.deepSpaceStart` | `DS.deepSpaceStart` |
| **ä»»åŠ¡å¡ç‰‡** | å“ç‰Œè‰² 8% + å‘å…‰ | å“ç‰Œè‰² 8% + å‘å…‰ |
| **ç«ç„°** | æ©™é»„æ¸å˜ | æ©™é»„æ¸å˜ |
| **æ—¶é’Ÿ** | å“ç‰Œè‰² | å“ç‰Œè‰² |
| **çŠ¶æ€æ ** | é»„è‰²è­¦å‘Š | é»„è‰²è­¦å‘Š |

### 7.5 ç¤¾ç¾¤é¡µé¢ (Community)

| å…ƒç´  | æµ…è‰²æ¨¡å¼ | æ·±è‰²æ¨¡å¼ |
|------|----------|----------|
| **èƒŒæ™¯** | é€æ˜ (ä¾èµ–çˆ¶çº§) | é€æ˜ (ä¾èµ–çˆ¶çº§) |
| **Filter Chips** | `DS.brandPrimary10` è¾¹æ¡† | `DS.brandPrimary24` è¾¹æ¡† |
| **é€‰ä¸­çŠ¶æ€** | `DS.primaryBase` + å“ç‰Œè‰²æ–‡å­— | `DS.primaryBase` + å“ç‰Œè‰²æ–‡å­— |
| **ç¾¤ç»„è¯¦æƒ…å¡ç‰‡** | `DS.brandPrimaryConst` + é˜´å½± | `DS.brandPrimaryConst` + é˜´å½± |
| **ç»Ÿè®¡å¡ç‰‡** | `DS.brandPrimaryConst` + `DS.neutral100` è¾¹æ¡† | `DS.brandPrimaryConst` + `DS.neutral100` è¾¹æ¡† |
| **Bonfire åŠ¨ç”»** | æ©™é»„æ¸å˜ + ç¼©æ”¾ | æ©™é»„æ¸å˜ + ç¼©æ”¾ |

### 7.6 ç”¨æˆ·èµ„æ–™å’Œè®¾ç½® (Profile & Settings)

| å…ƒç´  | æµ…è‰²æ¨¡å¼ | æ·±è‰²æ¨¡å¼ |
|------|----------|----------|
| **æ³¢æµªå¤´éƒ¨** | `DS.primaryGradient` | `DS.primaryGradient` |
| **Avatar è¾¹æ¡†** | `DS.brandPrimary30` (4px) | `DS.brandPrimary30` (4px) |
| **Avatar é˜´å½±** | `DS.brandPrimary20` | `DS.brandPrimary20` |
| **è®¾ç½®å¡ç‰‡** | `DS.surfaceSecondary` + `DS.shadowSm` | `DS.surfaceSecondary` + `DS.shadowSm` |
| **è¾“å…¥æ¡†å¡«å……** | `DS.brandPrimary50` | `DS.brandPrimary900` |
| **å±é™©æ“ä½œ** | `DS.errorGradient` | `DS.errorGradient` |

### 7.7 è®¡åˆ’å’Œä»»åŠ¡ (Plans & Tasks)

| å…ƒç´  | æµ…è‰²æ¨¡å¼ | æ·±è‰²æ¨¡å¼ |
|------|----------|----------|
| **ç­›é€‰ Chips** | é€‰ä¸­: æ¸å˜ + é˜´å½± | é€‰ä¸­: æ¸å˜ + é˜´å½± |
| **ä»»åŠ¡å¡ç‰‡** | `DS.surfaceSecondary` | `DS.neutral800` |
| **è¿›åº¦æ¡** | `DS.success` (ç»¿è‰²) | `DS.success` (ç»¿è‰²) |
| **å†²åˆºè¿›åº¦** | `DS.warning` (æ©™è‰²) | `DS.warning` (æ©™è‰²) |
| **æŒæ¡åº¦** | ç´«è‰²è¿›åº¦æ¡ | ç´«è‰²è¿›åº¦æ¡ |

### 7.8 å­¦ä¹ é¢„æµ‹ (Insights)

| å…ƒç´  | æµ…è‰²æ¨¡å¼ | æ·±è‰²æ¨¡å¼ |
|------|----------|----------|
| **èƒŒæ™¯** | `DS.deepSpaceStart` | `DS.deepSpaceStart` |
| **çƒ­åŠ›å›¾** | `DS.brandPrimary` é€æ˜åº¦é˜¶æ¢¯ | `DS.brandPrimary` é€æ˜åº¦é˜¶æ¢¯ |
| **æ´å¯Ÿå¡ç‰‡** | `DS.surfaceSecondary` | `DS.neutral800` |
| **æ—¶é—´æ¨è** | `DS.info` è“è‰² | `DS.info` è“è‰² |

## 8. æ€§èƒ½ä¼˜åŒ–ç‰¹æ€§

### 8.1 æ¸²æŸ“ä¼˜åŒ–
```dart
// 1. DPRåŠ¨æ€ç¼©æ”¾
final renderScale = (currentDpr / devicePixelRatio).clamp(0.1, 1.0);
if (renderScale > 0.99) {
  return content;
}
return Transform.scale(scale: 1 / renderScale, child: content);

// 2. è§†å£è£å‰ª (StarMapPainter)
final viewport = Rect.fromPoints(topLeft, bottomRight);
final visibleNodes = nodes.where((node) {
  final pos = nodePositions[node.id];
  return viewport.overlaps(Rect.fromCircle(center: pos, radius: 30));
}).toList();

// 3. RepaintBoundary
RepaintBoundary(
  child: CustomPaint(painter: painter),
)
```

### 8.2 åŠ¨ç”»ä¼˜åŒ–
```dart
// ä½¿ç”¨ AnimationController + TickerProviderStateMixin
// é¿å…ä¸å¿…è¦çš„é‡å»º
AnimatedBuilder(
  animation: Listenable.merge([
    _transformationController,
    _selectionPulseController,
  ]),
  builder: (context, child) {
    // åªé‡å»ºéœ€è¦å˜åŒ–çš„éƒ¨åˆ†
    return CustomPaint(painter: painter);
  },
)
```

### 8.3 ç¦»çº¿æ”¯æŒ
```dart
// çŠ¶æ€æŒ‡ç¤ºå™¨
OfflineIndicator(
  isUsingCache: galaxyState.isUsingCache,
  onRetry: () => ref.read(galaxyProvider.notifier).loadGalaxy(forceRefresh: true),
)
```

### 8.4 æ™ºèƒ½ç¼“å­˜ç³»ç»Ÿ
```dart
// SmartCache é™åˆ¶ 10 ä¸ªæ¡ç›®
static final SmartCache<int, List<ProcessedNode>> _nodeCache =
    SmartCache(maxSize: 10);

// ç¼“å­˜é”®ç”Ÿæˆ
int _generateCacheKey() => Object.hash(
  identityHashCode(nodes),
  identityHashCode(edges),
  nodes.length,
  edges.length,
  nodes.isNotEmpty ? nodes.first.x : 0,
);
```

## 9. äº¤äº’åŠ¨ç”»ç»†èŠ‚

### 9.1 æŒ‰é’®åé¦ˆ
```dart
// ç¼©æ”¾åŠ¨ç”»
AnimatedScale(
  scale: _isPressed ? 0.95 : 1.0,
  duration: DS.durationFast,  // 100ms
  curve: DS.curveEaseOut,
  child: Container(...),
)

// è§¦è§‰åé¦ˆ
HapticFeedback.selectionClick();  // è½»è§¦ (ç‚¹å‡»)
HapticFeedback.mediumImpact();    // ä¸­ç­‰ (é•¿æŒ‰)
HapticFeedback.lightImpact();     // è½»å¾® (å®Œæˆ)
```

### 9.2 é¡µé¢è½¬åœº
```dart
// ç»Ÿä¸€è½¬åœºæ„å»ºå™¨
CustomTransitionPage<void>(
  transitionsBuilder: (context, animation, secondaryAnimation, child) =>
    SharedAxisTransition(
      animation: animation,
      secondaryAnimation: secondaryAnimation,
      transitionType: SharedAxisTransitionType.horizontal, // æˆ– scaled
      child: child,
    ),
)
```

### 9.3 ç‰¹æ®ŠåŠ¨ç”»åºåˆ—

**æ˜Ÿç³»è¿›å…¥åŠ¨ç”»**:
1. å…¨å±è¦†ç›–åŠ¨ç”» (0-1ç§’)
2. è‡ªåŠ¨ç¼©æ”¾ 0.15 â†’ 0.25 (2ç§’, easeOutCubic)

**èƒ½é‡ä¼ è¾“**:
1. ç²’å­æµä»å±å¹•ä¸­å¿ƒå‘å°„
2. è´å¡å°”æ›²çº¿è·¯å¾„
3. 1500ms, easeOutCubic
4. å®Œæˆåè§¦å‘ API è°ƒç”¨
5. æˆåŠŸç»½æ”¾åŠ¨ç”» (800ms)

**èŠ‚ç‚¹è„‰å†²**:
- 2ç§’å¾ªç¯, `Curves.easeInOut`
- é€æ˜åº¦: 0.3 â†’ 0.5
- åŠå¾„: 40px â†’ 48px

**æ‰“å­—æŒ‡ç¤ºå™¨**:
- 3ç‚¹è·³åŠ¨, 1.2ç§’å‘¨æœŸ
- æ­£å¼¦æ³¢è¿åŠ¨, ä¾æ¬¡å»¶è¿Ÿ 0.2ç§’

## 10. æ€»ç»“

Sparkleçš„å‰ç«¯è®¾è®¡ç³»ç»Ÿä½“ç°äº†ç°ä»£Flutteråº”ç”¨çš„æœ€ä½³å®è·µï¼š

### 10.1 æ ¸å¿ƒä¼˜åŠ¿

1. **å®Œæ•´çš„è®¾è®¡ç³»ç»Ÿ**: è¯­ä¹‰åŒ–ä»¤ç‰Œ + åŠ¨æ€ä¸»é¢˜
   - `DS` å¿«æ·è®¿é—®
   - æ·±/æµ…è‰²æ¨¡å¼è‡ªåŠ¨åˆ‡æ¢
   - å“ç‰Œé¢„è®¾ç³»ç»Ÿ

2. **ä¸€è‡´çš„è§†è§‰è¯­è¨€**: æ¯›ç»ç’ƒ + æ¸å˜ + å“ç‰Œè‰²
   - æ‰€æœ‰å¡ç‰‡ç»Ÿä¸€åœ†è§’ 20px
   - ç»Ÿä¸€è¾¹æ¡†é£æ ¼
   - æ¸å˜ç³»ç»Ÿè´¯ç©¿å…¨åº”ç”¨

3. **ä¸°å¯Œçš„äº¤äº’**: å¾®äº¤äº’ + åŠ¨ç”» + è§¦è§‰åé¦ˆ
   - æŒ‰ä¸‹ç¼©æ”¾ 0.95x
   - æ„å›¾è¯†åˆ«å‘å…‰
   - ç‰©ç†åé¦ˆ

4. **æ€§èƒ½ä¼˜å…ˆ**: å¤šå±‚ä¼˜åŒ–ç­–ç•¥
   - LOD ç³»ç»Ÿ (5çº§ç»†èŠ‚)
   - è§†å£è£å‰ª
   - DPR åŠ¨æ€è°ƒæ•´
   - æ™ºèƒ½ç¼“å­˜

5. **å¯è®¿é—®æ€§**: å¤§è§¦æ‘¸ç›®æ ‡ + é«˜å¯¹æ¯”åº¦
   - æœ€å° 48px è§¦æ‘¸åŒº
   - è¯­ä¹‰åŒ–é¢œè‰²
   - å±å¹•é˜…è¯»å™¨æ”¯æŒ

6. **ç¦»çº¿å‹å¥½**: ç¼“å­˜ + é‡è¯•æœºåˆ¶
   - è‡ªåŠ¨ç¼“å­˜
   - ç¦»çº¿æŒ‡ç¤ºå™¨
   - æ‰‹åŠ¨é‡è¯•

### 10.2 æŠ€æœ¯äº®ç‚¹

- **CustomPaint**: é«˜æ€§èƒ½å›¾å½¢æ¸²æŸ“
- **InteractiveViewer**: æ— é™ç”»å¸ƒ
- **Riverpod**: å“åº”å¼çŠ¶æ€ç®¡ç†
- **AnimationController**: å¤æ‚åŠ¨ç”»ç¼–æ’
- **BackdropFilter**: æ¯›ç»ç’ƒæ•ˆæœ
- **SmartCache**: æ™ºèƒ½ç¼“å­˜ç³»ç»Ÿ

### 10.3 ç”¨æˆ·ä½“éªŒ

è¿™å¥—ç³»ç»Ÿä¸ºç”¨æˆ·æä¾›äº†:
- **æµç•…**: 60fps åŠ¨ç”», æ™ºèƒ½é™çº§
- **ç¾è§‚**: ç»Ÿä¸€è®¾è®¡è¯­è¨€, å“ç‰Œä¸€è‡´æ€§
- **åŠŸèƒ½ä¸°å¯Œ**: å¤šåœºæ™¯è¦†ç›– (é©¾é©¶èˆ±ã€æ˜Ÿç³»ã€èŠå¤©ã€ä¸“æ³¨)
- **ç›´è§‚**: æ¸…æ™°çš„è§†è§‰åé¦ˆ, è‡ªç„¶çš„äº¤äº’
- **å¯é **: ç¦»çº¿æ”¯æŒ, é”™è¯¯æ¢å¤

**æœ€ç»ˆç›®æ ‡**: è®©å­¦ä¹ å˜å¾—åƒæ¢ç´¢å®‡å®™ä¸€æ ·æœ‰è¶£ä¸”å¯Œæœ‰æˆæ•ˆ ğŸš€
