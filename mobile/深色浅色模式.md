ğŸ”§ æ·±è‰²/æµ…è‰²æ¨¡å¼æ˜¾ç¤ºå¼‚å¸¸ä¿®å¤æ–¹æ¡ˆ

 ğŸ“Š é—®é¢˜åˆ†æ

 ç”¨æˆ·åé¦ˆç¡®è®¤

 - æ ¸å¿ƒé—®é¢˜: ç¡¬ç¼–ç é¢œè‰²ä¸å“åº”ä¸»é¢˜å˜åŒ–
 - å½±å“èŒƒå›´: æ‰€æœ‰ç•Œé¢ï¼ˆå…¨é¢ä¿®å¤ï¼‰
 - ä¸»è¦ç—‡çŠ¶: æ·±è‰²æ¨¡å¼ä¸‹ç´«è‰²ã€è“è‰²ç­‰å›ºå®šé¢œè‰²æ˜¾ç¤ºå¼‚å¸¸

 å½“å‰çŠ¶æ€

 Sparkle Flutteråº”ç”¨å·²ç»å»ºç«‹äº†å®Œå–„çš„åŸºç¡€ä¸»é¢˜ç³»ç»Ÿï¼Œä½†å­˜åœ¨ä»¥ä¸‹é—®é¢˜ï¼š

 âœ… å·²å®ç°çš„ä¼˜ç§€ç‰¹æ€§

 - å®Œæ•´çš„ä¸»é¢˜ç®¡ç†å™¨ï¼ˆThemeManagerï¼‰æ”¯æŒ light/dark/system æ¨¡å¼
 - å“ç‰Œé¢„è®¾ç³»ç»Ÿï¼ˆSparkle/Ocean/Forestï¼‰
 - é«˜å¯¹æ¯”åº¦æ¨¡å¼æ”¯æŒ
 - æŒä¹…åŒ–å­˜å‚¨ï¼ˆSharedPreferencesï¼‰
 - è®¾è®¡ä»¤ç‰Œç³»ç»Ÿï¼ˆDSç±»ï¼‰

 âŒ å­˜åœ¨çš„é—®é¢˜

 1. ç¡¬ç¼–ç é¢œè‰²æ³›æ»¥ - 50+ å¤„ç¡¬ç¼–ç çš„ Colors.purple, Colors.green, Colors.blue, Colors.white, Colors.black ç­‰
 2. ä¸»é¢˜ä¸ä¸€è‡´ - éƒ¨åˆ†ç»„ä»¶ä½¿ç”¨ä¸»é¢˜ç³»ç»Ÿï¼Œéƒ¨åˆ†ä½¿ç”¨ç¡¬ç¼–ç 
 3. çŠ¶æ€é¢œè‰²æœªä¸»é¢˜åŒ– - AgentçŠ¶æ€æŒ‡ç¤ºå™¨ä½¿ç”¨å›ºå®šé¢œè‰²ï¼ˆè“/æ©™/ç»¿ï¼‰
 4. æ¸å˜è‰²ä¸ä¸€è‡´ - éƒ¨åˆ†æ¸å˜æœªå“åº”ä¸»é¢˜å˜åŒ–
 5. å¯¹æ¯”åº¦é—®é¢˜ - æ–‡æœ¬åœ¨æ·±è‰²èƒŒæ™¯ä¸‹ä¸å¯è¯»

 ğŸ” é—®é¢˜åˆ†å¸ƒç»Ÿè®¡ï¼ˆ50+ å¤„ç¡¬ç¼–ç é¢œè‰²ï¼‰

 | ç»„ä»¶/æ–‡ä»¶             | ç¡¬ç¼–ç é¢œè‰²æ•° | ä¸»è¦é—®é¢˜        | ä¼˜å…ˆçº§ |
 |-----------------------|--------------|-----------------|--------|
 | Agentæ¨ç†æ°”æ³¡ (v1/v2) | 15+          | ç´«è‰²ç³»ç¡¬ç¼–ç     | ğŸ”´ é«˜  |
 | èŠå¤©æ°”æ³¡              | 10+          | ç™½è‰²/é»‘è‰²ç¡¬ç¼–ç  | ğŸ”´ é«˜  |
 | AgentçŠ¶æ€æŒ‡ç¤ºå™¨       | 5            | è“/æ©™/ç»¿ç¡¬ç¼–ç   | ğŸ”´ é«˜  |
 | Onboarding/åŠ¨ç”»       | 8+           | ç´«è‰²/ç²‰è‰²æ¸å˜   | ğŸŸ¡ ä¸­  |
 | å„ç§UIç»„ä»¶            | 15+          | éšæœºé¢œè‰²        | ğŸŸ¡ ä¸­  |

 å…³é”®é—®é¢˜ä»£ç ç¤ºä¾‹

 // âŒ é—®é¢˜1: ç´«è‰²ç¡¬ç¼–ç 
 Colors.purple.shade50/100/200/700

 // âŒ é—®é¢˜2: çŠ¶æ€é¢œè‰²ç¡¬ç¼–ç 
 Colors.blue (æœç´¢ä¸­)
 Colors.orange (æ‰§è¡Œä¸­)
 Colors.green (ç”Ÿæˆä¸­)

 // âŒ é—®é¢˜3: æ–‡æœ¬é¢œè‰²ç¡¬ç¼–ç 
 Colors.white (æ·±è‰²æ¨¡å¼ä¸‹ä¸å¯è¯»)
 Colors.black (æµ…è‰²æ¨¡å¼ä¸‹ä¸å¯è¯»)

 ğŸ¯ ä¿®å¤ç›®æ ‡

 æ ¸å¿ƒåŸåˆ™

 1. 100%ä¸»é¢˜æ„ŸçŸ¥ - æ‰€æœ‰é¢œè‰²å¿…é¡»é€šè¿‡ä¸»é¢˜ç³»ç»Ÿè®¿é—®
 2. æ·±è‰²/æµ…è‰²æ¨¡å¼ä¸€è‡´æ€§ - ä¸¤ç§æ¨¡å¼ä¸‹éƒ½å¿…é¡»æ¸…æ™°å¯è¯»
 3. å¯ç»´æŠ¤æ€§ - é˜²æ­¢æœªæ¥ç¡¬ç¼–ç å›å½’

 å…·ä½“ç›®æ ‡

 - âœ… æ¶ˆé™¤æ‰€æœ‰ç¡¬ç¼–ç é¢œè‰²ï¼ˆç›®æ ‡ï¼š0å¤„ â†’ 50+ å¤„ï¼‰
 - âœ… çŠ¶æ€é¢œè‰²ä¸»é¢˜åŒ–ï¼ˆæœç´¢ä¸­/æ‰§è¡Œä¸­/ç”Ÿæˆä¸­ â†’ ä¸»é¢˜è‰²ï¼‰
 - âœ… æ¸å˜è‰²ä¸»é¢˜åŒ–ï¼ˆæ‰€æœ‰æ¸å˜å“åº”ä¸»é¢˜ï¼‰
 - âœ… è¾¹æ¡†/é˜´å½±ä¸»é¢˜åŒ–
 - âœ… æ·»åŠ è‡ªåŠ¨åŒ–æ£€æŸ¥ï¼ˆé˜²æ­¢å›å½’ï¼‰

 ğŸ“‹ æ‰§è¡Œè®¡åˆ’

 é˜¶æ®µ1ï¼šæ ¸å¿ƒé¢œè‰²ç³»ç»Ÿæ‰©å±•ï¼ˆé«˜ä¼˜å…ˆçº§ï¼‰

 1.1 æ‰©å±• SparkleColors ç³»ç»Ÿ

 æ–‡ä»¶: mobile/lib/core/design/tokens_v2/theme_manager.dart

 æ–°å¢è¯­ä¹‰åŒ–é¢œè‰²ï¼ˆåœ¨ SparkleColors ç±»ä¸­ï¼‰ï¼š
 // AgentçŠ¶æ€é¢œè‰²ï¼ˆå¿…é¡»æ·»åŠ ï¼‰
 required this.agentSearching,    // æœç´¢ä¸­ - Infoè‰²
 required this.agentExecuting,    // æ‰§è¡Œä¸­ - Warningè‰²
 required this.agentGenerating,   // ç”Ÿæˆä¸­ - Successè‰²
 required this.agentThinking,     // æ€è€ƒä¸­ - Brand Primary

 // èŠå¤©æ°”æ³¡é¢œè‰²
 required this.userBubbleBg,      // ç”¨æˆ·æ°”æ³¡èƒŒæ™¯
 required this.userBubbleText,    // ç”¨æˆ·æ°”æ³¡æ–‡æœ¬
 required this.agentBubbleBg,     // AIæ°”æ³¡èƒŒæ™¯
 required this.agentBubbleText,   // AIæ°”æ³¡æ–‡æœ¬

 // åä½œ/æ¨ç†ä¸“ç”¨é¢œè‰²
 required this.collaborationPrimary,
 required this.collaborationSecondary,

 åœ¨ light() å’Œ dark() å·¥å‚æ–¹æ³•ä¸­è®¾ç½®å…·ä½“å€¼ï¼š
 // Light mode
 agentSearching: Color(0xFF64B5F6),
 agentExecuting: Color(0xFFFF9800),
 agentGenerating: Color(0xFF81C784),
 agentThinking: Color(0xFFFF6B35),
 userBubbleBg: Color(0xFFFFFFFF),
 userBubbleText: Color(0xFF000000),
 agentBubbleBg: Color(0xFFF5F5F5),
 agentBubbleText: Color(0xFF212121),

 // Dark mode
 agentSearching: Color(0xFF64B5F6),
 agentExecuting: Color(0xFFFFB74D),
 agentGenerating: Color(0xFF81C784),
 agentThinking: Color(0xFFFF8C5A),
 userBubbleBg: Color(0xFFFF6B35),
 userBubbleText: Color(0xFFFFFFFF),
 agentBubbleBg: Color(0xFF1E1E1E),
 agentBubbleText: Color(0xFFFFFFFF),

 1.2 æ‰©å±• DS å¿«æ·è®¿é—®

 æ–‡ä»¶: mobile/lib/core/design/design_system.dart

 åœ¨ DS ç±»ä¸­æ·»åŠ ï¼š
 // AgentçŠ¶æ€é¢œè‰²
 static Color get agentSearching => _theme.colors.agentSearching;
 static Color get agentExecuting => _theme.colors.agentExecuting;
 static Color get agentGenerating => _theme.colors.agentGenerating;
 static Color get agentThinking => _theme.colors.agentThinking;

 // èŠå¤©æ°”æ³¡å¿«æ·æ–¹å¼
 static Color get userBubbleBg => _theme.colors.userBubbleBg;
 static Color get userBubbleText => _theme.colors.userBubbleText;
 static Color get agentBubbleBg => _theme.colors.agentBubbleBg;
 static Color get agentBubbleText => _theme.colors.agentBubbleText;

 // åä½œé¢œè‰²
 static Color get collaborationPrimary => _theme.colors.collaborationPrimary;
 static Color get collaborationSecondary => _theme.colors.collaborationSecondary;

 é˜¶æ®µ2ï¼šå…³é”®ç»„ä»¶é‡æ„ï¼ˆé«˜ä¼˜å…ˆçº§ï¼‰

 2.1 AgentçŠ¶æ€æŒ‡ç¤ºå™¨

 æ–‡ä»¶: mobile/lib/features/chat/widgets/agent_status_indicator.dart

 ä¿®å¤å‰ï¼ˆç¬¬110-125è¡Œï¼‰ï¼š
 Color _getStatusColor(AgentStatus status, ThemeData theme) {
   switch (status) {
     case AgentStatus.searching: return Colors.blue;  // âŒ ç¡¬ç¼–ç 
     case AgentStatus.executingTool: return Colors.orange;  // âŒ ç¡¬ç¼–ç 
     case AgentStatus.generating: return Colors.green;  // âŒ ç¡¬ç¼–ç 
   }
 }

 ä¿®å¤åï¼š
 Color _getStatusColor(AgentStatus status, BuildContext context) {
   final colors = context.sparkleColors;
   switch (status) {
     case AgentStatus.thinking: return DS.brandPrimary;
     case AgentStatus.searching: return colors.agentSearching;
     case AgentStatus.executingTool: return colors.agentExecuting;
     case AgentStatus.generating: return colors.agentGenerating;
     case AgentStatus.error: return DS.error;
     case AgentStatus.idle: return DS.textSecondary;
   }
 }

 2.2 Agentæ¨ç†æ°”æ³¡ï¼ˆv1å’Œv2ï¼‰

 æ–‡ä»¶:
 - mobile/lib/presentation/widgets/chat/agent_reasoning_bubble.dart
 - mobile/lib/presentation/widgets/chat/agent_reasoning_bubble_v2.dart

 å…³é”®ä¿®å¤ç‚¹ï¼ˆæœç´¢æ›¿æ¢ï¼‰ï¼š
 | ç¡¬ç¼–ç                  | ä¸»é¢˜åŒ–æ›¿ä»£        | ä½ç½®      |
 |------------------------|-------------------|-----------|
 | Colors.purple.shade50  | DS.brandPrimary10 | æ¸å˜èµ·å§‹  |
 | Colors.purple.shade100 | DS.brandPrimary15 | èƒŒæ™¯è‰²    |
 | Colors.purple.shade200 | DS.brandPrimary30 | è¾¹æ¡†      |
 | Colors.purple.shade700 | DS.brandPrimary70 | æ–‡æœ¬/å›¾æ ‡ |

 æ–‡ä»¶: mobile/lib/presentation/widgets/chat/chat_bubble.dart

 ä¿®å¤ç‚¹ï¼ˆç¬¬615-650è¡Œï¼‰ï¼š
 - Colors.white â†’ DS.userBubbleText æˆ– context.sparkleColors.userBubbleText
 - Colors.white.withValues(alpha: 0.2) â†’ DS.userBubbleBg.withValues(alpha: 0.2)
 - isUser ? Colors.white : context.sparkleColors.textPrimary â†’ ä¸»é¢˜åŒ–

 2.3 æ‰¹é‡ä¿®å¤å…¶ä»–ç»„ä»¶

 æ–‡ä»¶æ¸…å•ï¼ˆæŒ‰ä¼˜å…ˆçº§æ’åºï¼‰ï¼š

 ğŸ”´ é«˜ä¼˜å…ˆçº§ï¼ˆæ ¸å¿ƒåŠŸèƒ½ï¼‰:
 1. mobile/lib/presentation/widgets/agents/collaboration_timeline.dart
 2. mobile/lib/presentation/widgets/home/omnibar.dart
 3. mobile/lib/presentation/widgets/home/home_notification_card.dart
 4. mobile/lib/presentation/widgets/community/bonfire_widget.dart

 ğŸŸ¡ ä¸­ä¼˜å…ˆçº§ï¼ˆè¾…åŠ©åŠŸèƒ½ï¼‰:
 5. mobile/lib/presentation/widgets/onboarding/architecture_animation.dart
 6. mobile/lib/presentation/screens/onboarding/interactive_onboarding_screen.dart
 7. mobile/lib/presentation/widgets/tools/translator_tool.dart
 8. mobile/lib/presentation/widgets/cognitive/pattern_card.dart

 ğŸŸ¢ ä½ä¼˜å…ˆçº§ï¼ˆè¾¹ç¼˜åŠŸèƒ½ï¼‰:
 9. mobile/lib/presentation/screens/insights/learning_forecast_screen.dart
 10. mobile/lib/presentation/screens/demo/competition_demo_screen.dart
 11. mobile/lib/presentation/screens/knowledge/knowledge_detail_screen.dart
 12. mobile/lib/presentation/screens/plan/growth_screen.dart
 13. mobile/lib/features/galaxy/presentation/widgets/galaxy/graphrag_visualizer.dart
 14. mobile/lib/features/galaxy/presentation/widgets/galaxy/galaxy_error_dialog.dart
 15. mobile/lib/features/task/presentation/screens/task_create_screen.dart
 16. mobile/lib/features/task/presentation/screens/task_detail_screen.dart
 17. mobile/lib/features/error_book/presentation/screens/review_screen.dart
 18. mobile/lib/presentation/widgets/focus/reflection_dialog.dart

 æ‰¹é‡æ›¿æ¢è§„åˆ™ï¼š
 // é¢œè‰²æ˜ å°„è¡¨
 Colors.purple          â†’ DS.brandSecondary
 Colors.purple.shadeXXX â†’ DS.brandPrimaryXXX
 Colors.blue            â†’ DS.info
 Colors.orange          â†’ DS.warning
 Colors.green           â†’ DS.success
 Colors.white           â†’ context.sparkleColors.surfacePrimary (æ·±è‰²) æˆ– Colors.white (æµ…è‰²)
 Colors.black           â†’ context.sparkleColors.textPrimary

 é˜¶æ®µ3ï¼šæ¸å˜å’Œé˜´å½±ç³»ç»Ÿä¼˜åŒ–

 3.1 æ¸å˜è‰²ä¸»é¢˜åŒ–

 æ–‡ä»¶: mobile/lib/core/design/tokens_v2/theme_manager.dart

 åœ¨ SparkleColors ç±»ä¸­æ·»åŠ æ¸å˜æ–¹æ³•ï¼š
 // Agentæ¨ç†æ°”æ³¡æ¸å˜
 LinearGradient get agentReasoningGradient => LinearGradient(
   colors: [brandPrimary10, brandPrimary20],
   begin: Alignment.topLeft,
   end: Alignment.bottomRight,
 );

 // åä½œæ°”æ³¡æ¸å˜
 LinearGradient get collaborationGradient => LinearGradient(
   colors: [collaborationPrimary, collaborationSecondary],
   begin: Alignment.topCenter,
   end: Alignment.bottomCenter,
 );

 // ä»»åŠ¡ç±»å‹æ¸å˜ï¼ˆå·²å­˜åœ¨ï¼Œéœ€éªŒè¯ï¼‰
 LinearGradient getTaskGradient(String taskType) {
   final color = getTaskColor(taskType);
   return LinearGradient(
     colors: [color, color.withValues(alpha: 0.7)],
     begin: Alignment.topLeft,
     end: Alignment.bottomRight,
   );
 }

 3.2 é˜´å½±ä¸»é¢˜åŒ–

 æ–‡ä»¶: mobile/lib/core/design/tokens_v2/theme_manager.dart

 åœ¨ DS ç±»ä¸­æ·»åŠ ï¼š
 // é˜´å½±å¿«æ·è®¿é—®ï¼ˆå·²å­˜åœ¨ï¼Œéœ€éªŒè¯ï¼‰
 static List<BoxShadow> get shadowSm => _theme.shadows.small;
 static List<BoxShadow> get shadowMd => _theme.shadows.medium;
 static List<BoxShadow> get shadowLg => _theme.shadows.large;

 æ›¿æ¢æ‰€æœ‰ç¡¬ç¼–ç é˜´å½±ï¼š
 // âŒ æ—§ä»£ç 
 BoxShadow(color: Colors.purple.withValues(alpha: 0.1), blurRadius: 8, offset: Offset(0, 2))

 // âœ… æ–°ä»£ç 
 ...DS.shadowMd

 é˜¶æ®µ4ï¼šæ‰¹é‡æ›¿æ¢ç¡¬ç¼–ç é¢œè‰²ï¼ˆä¸­ä¼˜å…ˆçº§ï¼‰

 4.1 ä½¿ç”¨å…¨å±€æœç´¢æ›¿æ¢

 æ‰§è¡Œé¡ºåºï¼š

 1. Agentæ¨ç†æ°”æ³¡ï¼ˆ2ä¸ªæ–‡ä»¶ï¼‰- 15+ å¤„
 # æœç´¢: Colors.purple.shade
 # æ›¿æ¢: DS.brandPrimaryXX
 2. èŠå¤©æ°”æ³¡ï¼ˆ1ä¸ªæ–‡ä»¶ï¼‰- 10+ å¤„
 # æœç´¢: Colors.white / Colors.black
 # æ›¿æ¢: ä¸»é¢˜åŒ–é¢œè‰²
 3. çŠ¶æ€æŒ‡ç¤ºå™¨ï¼ˆ1ä¸ªæ–‡ä»¶ï¼‰- 5 å¤„
 # æœç´¢: Colors.blue / Colors.orange / Colors.green
 # æ›¿æ¢: DS.info / DS.warning / DS.success
 4. å…¶ä»–ç»„ä»¶ï¼ˆ18ä¸ªæ–‡ä»¶ï¼‰- 20+ å¤„
 # æŒ‰ä¼˜å…ˆçº§é€ä¸ªå¤„ç†

 4.2 é¢œè‰²æ˜ å°„è¡¨ï¼ˆæ‰¹é‡æ›¿æ¢è§„åˆ™ï¼‰

 | ç¡¬ç¼–ç                  | ä¸»é¢˜åŒ–æ›¿ä»£                           | é€‚ç”¨åœºæ™¯             |
 |------------------------|--------------------------------------|----------------------|
 | Colors.purple          | DS.brandSecondary                    | å“ç‰Œè‰²               |
 | Colors.purple.shade50  | DS.brandPrimary10                    | æµ…è‰²èƒŒæ™¯             |
 | Colors.purple.shade100 | DS.brandPrimary15                    | èƒŒæ™¯è‰²               |
 | Colors.purple.shade200 | DS.brandPrimary30                    | è¾¹æ¡†                 |
 | Colors.purple.shade700 | DS.brandPrimary70                    | æ–‡æœ¬/å›¾æ ‡            |
 | Colors.blue            | DS.info                              | ä¿¡æ¯çŠ¶æ€             |
 | Colors.orange          | DS.warning                           | è­¦å‘ŠçŠ¶æ€             |
 | Colors.green           | DS.success                           | æˆåŠŸçŠ¶æ€             |
 | Colors.white           | context.sparkleColors.userBubbleText | ç”¨æˆ·æ°”æ³¡æ–‡æœ¬         |
 | Colors.white           | DS.userBubbleBg                      | ç”¨æˆ·æ°”æ³¡èƒŒæ™¯ï¼ˆæµ…è‰²ï¼‰ |
 | Colors.black           | context.sparkleColors.textPrimary    | ä¸»è¦æ–‡æœ¬             |

 4.3 æ™ºèƒ½æ›¿æ¢ç­–ç•¥

 å¯¹äº Colors.white å’Œ Colors.blackï¼Œéœ€è¦æ ¹æ®ä¸Šä¸‹æ–‡åˆ¤æ–­ï¼š

 // âŒ é”™è¯¯ï¼šç¡¬ç¼–ç ç™½è‰²
 color: Colors.white

 // âœ… æ­£ç¡®ï¼šä¸»é¢˜åŒ–
 color: isUser ? DS.userBubbleText : context.sparkleColors.agentBubbleText

 // âœ… æ­£ç¡®ï¼šæ¡ä»¶ä¸»é¢˜åŒ–
 backgroundColor: isUser
   ? DS.userBubbleBg
   : context.sparkleColors.agentBubbleBg

 é˜¶æ®µ5ï¼šéªŒè¯å’Œæµ‹è¯•

 5.1 è§†è§‰éªŒè¯æ¸…å•

 æµ…è‰²æ¨¡å¼éªŒè¯ï¼š
 - æ‰€æœ‰æ–‡æœ¬æ¸…æ™°å¯è¯»
 - æ°”æ³¡é¢œè‰²æ­£ç¡®ï¼ˆç”¨æˆ·=ç™½è‰²ï¼ŒAI=æµ…ç°ï¼‰
 - çŠ¶æ€æŒ‡ç¤ºå™¨é¢œè‰²æ­£ç¡®
 - è¾¹æ¡†å’Œé˜´å½±å¯è§
 - æ¸å˜è‰²è‡ªç„¶

 æ·±è‰²æ¨¡å¼éªŒè¯ï¼š
 - æ‰€æœ‰æ–‡æœ¬æ¸…æ™°å¯è¯»ï¼ˆå¯¹æ¯”åº¦è¶³å¤Ÿï¼‰
 - æ°”æ³¡é¢œè‰²æ­£ç¡®ï¼ˆç”¨æˆ·=å“ç‰Œè‰²ï¼ŒAI=æ·±ç°ï¼‰
 - çŠ¶æ€æŒ‡ç¤ºå™¨é¢œè‰²æ­£ç¡®
 - è¾¹æ¡†å’Œé˜´å½±å¯è§ï¼ˆä¸ä¸èƒŒæ™¯èåˆï¼‰
 - æ¸å˜è‰²è‡ªç„¶

 é«˜å¯¹æ¯”åº¦æ¨¡å¼éªŒè¯ï¼š
 - é¢œè‰²å¯¹æ¯”åº¦ç¬¦åˆWCAGæ ‡å‡†
 - æ‰€æœ‰äº¤äº’å…ƒç´ æ¸…æ™°å¯è¾¨

 å“ç‰Œé¢„è®¾éªŒè¯ï¼š
 - Sparkleé¢„è®¾æ­£å¸¸
 - Oceané¢„è®¾æ­£å¸¸
 - Foresté¢„è®¾æ­£å¸¸

 5.2 è‡ªåŠ¨åŒ–æ£€æŸ¥ï¼ˆé˜²æ­¢å›å½’ï¼‰

 åˆ›å»º lint è„šæœ¬ï¼šmobile/tools/check_hardcoded_colors.sh
 #!/bin/bash
 # æ£€æŸ¥ç¡¬ç¼–ç é¢œè‰²çš„è„šæœ¬

 # å…è®¸çš„ç¡¬ç¼–ç ï¼ˆæå°‘ä½¿ç”¨ï¼‰
 ALLOWED_COLORS="Colors.transparent"

 # æœç´¢ç¡¬ç¼–ç é¢œè‰²
 echo "ğŸ” æœç´¢ç¡¬ç¼–ç é¢œè‰²..."
 grep -r "Colors\.\(purple\|blue\|orange\|green\|white\|black\)" \
   --include="*.dart" \
   mobile/lib/presentation/ \
   mobile/lib/features/ \
   | grep -v "$ALLOWED_COLORS" \
   | tee /tmp/hardcoded_colors.txt

 # ç»Ÿè®¡æ•°é‡
 COUNT=$(wc -l < /tmp/hardcoded_colors.txt)
 echo "å‘ç° $COUNT å¤„ç¡¬ç¼–ç é¢œè‰²"

 if [ $COUNT -gt 0 ]; then
   echo "âŒ å‘ç°ç¡¬ç¼–ç é¢œè‰²ï¼Œè¯·ä½¿ç”¨ä¸»é¢˜ç³»ç»Ÿ"
   cat /tmp/hardcoded_colors.txt
   exit 1
 else
   echo "âœ… æœªå‘ç°ç¡¬ç¼–ç é¢œè‰²"
   exit 0
 fi

 æ·»åŠ åˆ° CI/CDï¼š
 # .github/workflows/ui-lint.yml
 - name: Check Hardcoded Colors
   run: |
     cd mobile
     chmod +x tools/check_hardcoded_colors.sh
     ./tools/check_hardcoded_colors.sh

 5.3 æ‰‹åŠ¨æµ‹è¯•æµç¨‹

 1. å¯åŠ¨åº”ç”¨ï¼š
 cd mobile && flutter run
 2. æµ‹è¯•ä¸»é¢˜åˆ‡æ¢ï¼š
   - è¿›å…¥è®¾ç½® â†’ ä¸»é¢˜è®¾ç½®
   - åˆ‡æ¢æµ…è‰²/æ·±è‰²/ç³»ç»Ÿæ¨¡å¼
   - åˆ‡æ¢å“ç‰Œé¢„è®¾
   - å¯ç”¨é«˜å¯¹æ¯”åº¦
 3. æµ‹è¯•å…³é”®é¡µé¢ï¼š
   - èŠå¤©ç•Œé¢ï¼ˆå‘é€æ¶ˆæ¯ï¼ŒæŸ¥çœ‹AIå›å¤ï¼‰
   - ä»»åŠ¡åˆ›å»º/è¯¦æƒ…
   - ä¸»é¡µä»ªè¡¨æ¿
   - æ¨ç†è¿‡ç¨‹å±•ç¤º
 4. æˆªå›¾å¯¹æ¯”ï¼š
   - æµ…è‰²æ¨¡å¼æˆªå›¾
   - æ·±è‰²æ¨¡å¼æˆªå›¾
   - å¯¹æ¯”æ£€æŸ¥ä¸€è‡´æ€§

 é˜¶æ®µ6ï¼šæ€§èƒ½ä¼˜åŒ–å’Œæ¸…ç†

 6.1 æ€§èƒ½æ£€æŸ¥

 - éªŒè¯ä¸»é¢˜åˆ‡æ¢æ— å¡é¡¿
 - æ£€æŸ¥é¢œè‰²è®¡ç®—æ˜¯å¦ç¼“å­˜
 - ç¡®è®¤æ— ä¸å¿…è¦çš„é‡å»º

 6.2 ä»£ç æ¸…ç†

 - ç§»é™¤æ‰€æœ‰ // TODO: ä¿®å¤ä¸»é¢˜ æ³¨é‡Š
 - æ›´æ–°æ–‡æ¡£æ³¨é‡Š
 - éªŒè¯æ‰€æœ‰å¯¼å…¥æ­£ç¡®

 6.3 æµ‹è¯•è¦†ç›–

 - è¿è¡Œç°æœ‰æµ‹è¯•ï¼šflutter test
 - æ·»åŠ ä¸»é¢˜æµ‹è¯•ï¼ˆå¦‚æœç¼ºå¤±ï¼‰
 - éªŒè¯æ— å›å½’é”™è¯¯

 ğŸ¨ é¢œè‰²æ˜ å°„è¡¨

 AgentçŠ¶æ€é¢œè‰²

 | çŠ¶æ€       | æµ…è‰²æ¨¡å¼ | æ·±è‰²æ¨¡å¼ | è¯­ä¹‰          | ä¸»é¢˜è®¿é—®                            |
 |------------|----------|----------|---------------|-------------------------------------|
 | Thinking   | #FF6B35  | #FF8C5A  | Brand Primary | DS.brandPrimary                     |
 | Searching  | #64B5F6  | #64B5F6  | Info          | DS.info / colors.agentSearching     |
 | Executing  | #FF9800  | #FFB74D  | Warning       | DS.warning / colors.agentExecuting  |
 | Generating | #81C784  | #81C784  | Success       | DS.success / colors.agentGenerating |
 | Error      | #EF5350  | #EF5350  | Error         | DS.error                            |

 èŠå¤©æ°”æ³¡

 | ç±»å‹         | æµ…è‰²æ¨¡å¼ | æ·±è‰²æ¨¡å¼ | ä¸»é¢˜è®¿é—®               |
 |--------------|----------|----------|------------------------|
 | ç”¨æˆ·æ°”æ³¡èƒŒæ™¯ | #FFFFFF  | #FF6B35  | DS.userBubbleBg        |
 | ç”¨æˆ·æ°”æ³¡æ–‡æœ¬ | #000000  | #FFFFFF  | DS.userBubbleText      |
 | AIæ°”æ³¡èƒŒæ™¯   | #F5F5F5  | #1E1E1E  | colors.agentBubbleBg   |
 | AIæ°”æ³¡æ–‡æœ¬   | #212121  | #FFFFFF  | colors.agentBubbleText |

 é¢œè‰²ç³»ç»Ÿæ‰©å±•

 | æ–°å¢å­—æ®µ               | æµ…è‰²å€¼  | æ·±è‰²å€¼  | ç”¨é€”         |
 |------------------------|---------|---------|--------------|
 | agentSearching         | #64B5F6 | #64B5F6 | æœç´¢çŠ¶æ€     |
 | agentExecuting         | #FF9800 | #FFB74D | æ‰§è¡ŒçŠ¶æ€     |
 | agentGenerating        | #81C784 | #81C784 | ç”ŸæˆçŠ¶æ€     |
 | agentThinking          | #FF6B35 | #FF8C5A | æ€è€ƒçŠ¶æ€     |
 | userBubbleBg           | #FFFFFF | #FF6B35 | ç”¨æˆ·æ°”æ³¡èƒŒæ™¯ |
 | userBubbleText         | #000000 | #FFFFFF | ç”¨æˆ·æ°”æ³¡æ–‡æœ¬ |
 | agentBubbleBg          | #F5F5F5 | #1E1E1E | AIæ°”æ³¡èƒŒæ™¯   |
 | agentBubbleText        | #212121 | #FFFFFF | AIæ°”æ³¡æ–‡æœ¬   |
 | collaborationPrimary   | #FF6B35 | #FF8C5A | åä½œä¸»è‰²     |
 | collaborationSecondary | #5C6BC0 | #5C6BC0 | åä½œæ¬¡è‰²     |

 ğŸ“ æ‰§è¡Œæ—¶é—´è¡¨

 Day 1: æ ¸å¿ƒç³»ç»Ÿæ‰©å±•ï¼ˆ3-4å°æ—¶ï¼‰

 ä¸Šåˆï¼š
 1. æ‰©å±• SparkleColors ç±»ï¼ˆæ·»åŠ 10ä¸ªæ–°å­—æ®µï¼‰
 2. æ›´æ–° SparkleColors.light() å’Œ .dark() å·¥å‚æ–¹æ³•
 3. æ‰©å±• DS ç±»å¿«æ·è®¿é—®å™¨

 ä¸‹åˆï¼š
 4. é‡æ„ AgentStatusIndicatorï¼ˆ5å¤„ç¡¬ç¼–ç ï¼‰
 5. åŸºç¡€æµ‹è¯•ï¼šåˆ‡æ¢ä¸»é¢˜ï¼ŒéªŒè¯çŠ¶æ€æŒ‡ç¤ºå™¨

 Day 2: å…³é”®ç»„ä»¶é‡æ„ï¼ˆ4-5å°æ—¶ï¼‰

 ä¸Šåˆï¼š
 1. é‡æ„ agent_reasoning_bubble.dartï¼ˆ15+ å¤„ï¼‰
 2. é‡æ„ agent_reasoning_bubble_v2.dartï¼ˆ15+ å¤„ï¼‰

 ä¸‹åˆï¼š
 3. é‡æ„ chat_bubble.dartï¼ˆ10+ å¤„ï¼‰
 4. æµ‹è¯•èŠå¤©ç•Œé¢ï¼ˆæµ…è‰²/æ·±è‰²æ¨¡å¼ï¼‰

 Day 3: æ‰¹é‡ä¿®å¤ï¼ˆ5-6å°æ—¶ï¼‰

 ä¸Šåˆï¼ˆé«˜ä¼˜å…ˆçº§ï¼‰ï¼š
 1. collaboration_timeline.dart
 2. omnibar.dart
 3. home_notification_card.dart
 4. bonfire_widget.dart

 ä¸‹åˆï¼ˆä¸­ä¼˜å…ˆçº§ï¼‰ï¼š
 5. architecture_animation.dart
 6. interactive_onboarding_screen.dart
 7. translator_tool.dart
 8. pattern_card.dart

 Day 4: éªŒè¯å’Œä¼˜åŒ–ï¼ˆ3-4å°æ—¶ï¼‰

 ä¸Šåˆï¼š
 1. ä½ä¼˜å…ˆçº§æ–‡ä»¶æ‰¹é‡ä¿®å¤
 2. æ¸å˜å’Œé˜´å½±ç³»ç»Ÿä¼˜åŒ–
 3. å…¨é¢è§†è§‰æµ‹è¯•

 ä¸‹åˆï¼š
 4. åˆ›å»º lint æ£€æŸ¥è„šæœ¬
 5. è¿è¡Œç°æœ‰æµ‹è¯•
 6. æ€§èƒ½ä¼˜åŒ–å’Œæ¸…ç†

 ğŸ¯ é¢„æœŸæˆæœ

 é‡åŒ–æŒ‡æ ‡

 | æŒ‡æ ‡           | ä¿®å¤å‰ | ä¿®å¤å | æ”¹è¿›     |
 |----------------|--------|--------|----------|
 | ç¡¬ç¼–ç é¢œè‰²     | 50+    | 0      | 100%     |
 | ä¸»é¢˜ä¸€è‡´æ€§     | 70%    | 100%   | +43%     |
 | æ·±è‰²æ¨¡å¼å¯ç”¨æ€§ | éƒ¨åˆ†   | å®Œæ•´   | å…¨é¢     |
 | å¯ç»´æŠ¤æ€§       | ä¸­     | é«˜     | æ˜¾è‘—æå‡ |

 è´¨é‡ç›®æ ‡

 - âœ… é›¶ç¡¬ç¼–ç é¢œè‰²ï¼šæ‰€æœ‰é¢œè‰²é€šè¿‡ä¸»é¢˜ç³»ç»Ÿè®¿é—®
 - âœ… å®Œç¾å¯¹æ¯”åº¦ï¼šæ·±è‰²/æµ…è‰²æ¨¡å¼ä¸‹æ–‡æœ¬æ¸…æ™°å¯è¯»
 - âœ… çŠ¶æ€ç›´è§‚ï¼šAgentçŠ¶æ€é¢œè‰²ç¬¦åˆç”¨æˆ·ç›´è§‰
 - âœ… å“ç‰Œä¸€è‡´ï¼šæ‰€æœ‰é¢„è®¾ä¸»é¢˜æ­£å¸¸å·¥ä½œ
 - âœ… å¯ç»´æŠ¤ï¼šè‡ªåŠ¨åŒ–æ£€æŸ¥é˜²æ­¢å›å½’

 ç”¨æˆ·ä½“éªŒæå‡

 1. è§†è§‰ä¸€è‡´æ€§ï¼šæ‰€æœ‰ç•Œé¢éµå¾ªåŒä¸€å¥—è®¾è®¡è¯­è¨€
 2. å¯è®¿é—®æ€§ï¼šé«˜å¯¹æ¯”åº¦æ¨¡å¼çœŸæ­£å¯ç”¨
 3. ä¸ªæ€§åŒ–ï¼šå“ç‰Œé¢„è®¾åˆ‡æ¢æµç•…è‡ªç„¶
 4. ä¸“ä¸šæ„Ÿï¼šæ·±è‰²æ¨¡å¼ä¸‹ä¿æŒé«˜ç«¯è´¨æ„Ÿ

 âš ï¸ é£é™©è¯„ä¼°

 é£é™©ç­‰çº§ï¼šğŸŸ¢ ä½é£é™©

 åŸå› ï¼š
 1. çº¯è§†è§‰ä¿®æ”¹ï¼šä¸å½±å“ä¸šåŠ¡é€»è¾‘å’Œæ•°æ®æµ
 2. æœ‰å®Œå–„åŸºç¡€ï¼šç°æœ‰è®¾è®¡ç³»ç»Ÿæ¶æ„è‰¯å¥½
 3. å¯é€†æ€§é«˜ï¼šçº¯é¢œè‰²æ›¿æ¢ï¼Œæ˜“äºå›æ»š
 4. æµ‹è¯•è¦†ç›–ï¼šç°æœ‰æµ‹è¯•å¯éªŒè¯åŠŸèƒ½å®Œæ•´æ€§

 éœ€è¦æ³¨æ„çš„ç»†èŠ‚

 1. æ¸å˜å¹³è¡¡ï¼šæ·±è‰²æ¨¡å¼ä¸‹æ¸å˜å¯èƒ½éœ€è¦è°ƒæ•´é€æ˜åº¦
 2. ç¬¬ä¸‰æ–¹ç»„ä»¶ï¼šéƒ¨åˆ†Materialç»„ä»¶å¯èƒ½éœ€è¦è¦†ç›–é»˜è®¤é¢œè‰²
 3. æ€§èƒ½ï¼šç¡®ä¿ä¸»é¢˜åˆ‡æ¢æ— å¡é¡¿ï¼ˆå·²ä¼˜åŒ–ï¼‰
 4. è¾¹ç¼˜æƒ…å†µï¼šé«˜å¯¹æ¯”åº¦æ¨¡å¼çš„ç‰¹æ®Šå¤„ç†

 åº”æ€¥é¢„æ¡ˆ

 å¦‚æœå‡ºç°é—®é¢˜ï¼š
 1. å¿«é€Ÿå›æ»šï¼šgit revert å³å¯æ¢å¤
 2. éƒ¨åˆ†ä¿®å¤ï¼šå¯é€ä¸ªæ–‡ä»¶å›é€€
 3. ä¸»é¢˜åˆ‡æ¢ï¼šç”¨æˆ·å¯ä¸´æ—¶åˆ‡æ¢åˆ°å¯ç”¨æ¨¡å¼

 ---
 ğŸ“‹ ä»»åŠ¡æ¸…å•æ€»è§ˆ

 æ ¸å¿ƒä¿®æ”¹ï¼ˆ4ä¸ªæ–‡ä»¶ï¼‰

 - mobile/lib/core/design/tokens_v2/theme_manager.dart - æ‰©å±•é¢œè‰²ç³»ç»Ÿ
 - mobile/lib/core/design/design_system.dart - æ‰©å±•DSè®¿é—®å™¨
 - mobile/lib/features/chat/widgets/agent_status_indicator.dart - çŠ¶æ€é¢œè‰²
 - mobile/lib/presentation/widgets/chat/chat_bubble.dart - æ°”æ³¡é¢œè‰²

 å…³é”®ç»„ä»¶ï¼ˆ3ä¸ªæ–‡ä»¶ï¼‰

 - mobile/lib/presentation/widgets/chat/agent_reasoning_bubble.dart
 - mobile/lib/presentation/widgets/chat/agent_reasoning_bubble_v2.dart

 å…¶ä»–ç»„ä»¶ï¼ˆ18ä¸ªæ–‡ä»¶ï¼‰

 - æŒ‰ä¼˜å…ˆçº§æ¸…å•é€ä¸ªä¿®å¤

 éªŒè¯å’Œå·¥å…·ï¼ˆ2ä¸ªæ–‡ä»¶ï¼‰

 - mobile/tools/check_hardcoded_colors.sh - æ£€æŸ¥è„šæœ¬
 - .github/workflows/ui-lint.yml - CIé›†æˆ

 ---
 è®¡åˆ’åˆ¶å®šæ—¶é—´: 2026-01-07
 é¢„è®¡ä¿®å¤æ—¶é—´: 4å¤©ï¼ˆ16-20å°æ—¶ï¼‰
 å½±å“èŒƒå›´: æ‰€æœ‰UIç»„ä»¶ï¼ˆ50+ å¤„ä¿®æ”¹ï¼‰
 å›æ»šéš¾åº¦: æä½ï¼ˆçº¯é¢œè‰²ä¿®æ”¹ï¼‰
 æµ‹è¯•è¦æ±‚: å…¨é¢è§†è§‰éªŒè¯ + ç°æœ‰æµ‹è¯•é€šè¿‡
 




  ğŸ”§ å‰ç«¯ç»„ä»¶é¢œè‰²åŒºåˆ†ä¼˜åŒ–æ–¹æ¡ˆ

 ğŸ“‹ é—®é¢˜åˆ†æ

 æ ¸å¿ƒé—®é¢˜

 å½“å‰Flutterç§»åŠ¨ç«¯å­˜åœ¨ä¸¥é‡çš„ç¡¬ç¼–ç é¢œè‰²æ»¥ç”¨å’Œå¯¹æ¯”åº¦ä¸è¶³é—®é¢˜ï¼Œå¯¼è‡´ç”¨æˆ·éš¾ä»¥åŒºåˆ†ä¸åŒç»„ä»¶ã€‚

 å…³é”®é—®é¢˜ä½ç½®

 1. Agentå¤´åƒé¢œè‰² (agent_avatar_switcher.dart) - ç¡¬ç¼–ç 5ç§é¢œè‰²
 2. AIæ¨ç†æ°”æ³¡ (agent_reasoning_bubble_v2.dart) - Agentç±»å‹é¢œè‰²ç¡¬ç¼–ç 
 3. èŠå¤©æ°”æ³¡ (chat_bubble.dart) - ç¼ºä¹ä¸»é¢˜é€‚é…
 4. ä¸“æ³¨ç»Ÿè®¡ (focus_stats_tool.dart) - ç¡¬ç¼–ç ç´«è‰²ç³»
 5. Omnibaræ„å›¾æŒ‡ç¤ºå™¨ (omnibar.dart) - å¯¹æ¯”åº¦ä¸è¶³

 ğŸ¯ è§£å†³æ–¹æ¡ˆè®¾è®¡

 é˜¶æ®µ1ï¼šå»ºç«‹ç»Ÿä¸€çš„é¢œè‰²ç®¡ç†ç³»ç»Ÿ

 1.1 åˆ›å»ºAgenté¢œè‰²æ˜ å°„ç³»ç»Ÿ

 æ–‡ä»¶: mobile/lib/core/design/agent_color_mapping.dart
 class AgentColorMapping {
   static const Map<AgentType, ColorToken> typeToColor = {
     AgentType.orchestrator: ColorToken.brandPrimary,
     AgentType.knowledge: ColorToken.semanticInfo,
     AgentType.math: ColorToken.semanticWarning,
     AgentType.code: ColorToken.semanticSuccess,
     AgentType.writing: ColorToken.taskReflection,
     AgentType.analytical: ColorToken.brandSecondary,
   };

   static const Map<String, ColorToken> agentIdToColor = {
     'agent_orchestrator': ColorToken.brandPrimary,
     'agent_knowledge': ColorToken.semanticInfo,
     'agent_math': ColorToken.semanticWarning,
     'agent_code': ColorToken.semanticSuccess,
     // ... åŠ¨æ€ç”Ÿæˆçš„Agentæ˜ å°„
   };
 }

 1.2 å¢å¼ºè®¾è®¡ç³»ç»Ÿ

 æ–‡ä»¶: mobile/lib/core/design/design_system.dart
 // æ·»åŠ å¯¹æ¯”åº¦æ£€æŸ¥å·¥å…·
 class ContrastAccessibility {
   static bool isWCAGCompliant(Color foreground, Color background) {
     final ratio = _calculateContrastRatio(foreground, background);
     return ratio >= 4.5; // AAæ ‡å‡†
   }

   static double _calculateContrastRatio(Color c1, Color c2) {
     // WCAGå¯¹æ¯”åº¦è®¡ç®—å®ç°
   }
 }

 // å¢å¼ºé¢œè‰²ä»¤ç‰Œ
 class ExtendedColorTokens {
   // Agentä¸“ç”¨é¢œè‰²
   static const agentOrchestrator = ColorToken(0xFFFF6B35);
   static const agentKnowledge = ColorToken(0xFF64B5F6);
   static const agentMath = ColorToken(0xFFFFB74D);
   static const agentCode = ColorToken(0xFF81C784);
   static const agentWriting = ColorToken(0xFF9C27B0);

   // é«˜å¯¹æ¯”åº¦æ¨¡å¼é¢œè‰²
   static const highContrastPrimary = ColorToken(0xFF000000);
   static const highContrastSecondary = ColorToken(0xFFFFFF);
 }

 é˜¶æ®µ2ï¼šæ›¿æ¢ç¡¬ç¼–ç é¢œè‰²

 2.1 Agentå¤´åƒç³»ç»Ÿé‡æ„

 æ–‡ä»¶: mobile/lib/features/galaxy/presentation/widgets/agent_avatar_switcher.dart
 // âŒ æ—§ä»£ç 
 Color(0xFF9C27B0), Color(0xFFFFC107), ...

 // âœ… æ–°ä»£ç 
 DS.agentOrchestrator,
 DS.agentKnowledge,
 ...
 // æˆ–ä½¿ç”¨ä¸Šä¸‹æ–‡
 context.sparkleColors.agentColors[agentType]

 2.2 AIæ¨ç†æ°”æ³¡ä¼˜åŒ–

 æ–‡ä»¶: mobile/lib/features/galaxy/presentation/widgets/agent_reasoning_bubble_v2.dart
 // ä½¿ç”¨Agenté¢œè‰²æ˜ å°„
 Color getAgentColor(AgentType type) {
   return AgentColorMapping.typeToColor[type]?.toColor() ?? DS.brandPrimary;
 }

 // å¢å¼ºå¯¹æ¯”åº¦
 Color getTextColor(Color background) {
   return ContrastAccessibility.isWCAGCompliant(DS.textPrimary, background)
     ? DS.textPrimary
     : DS.textOnDark;
 }

 2.3 èŠå¤©æ°”æ³¡ä¸»é¢˜é€‚é…

 æ–‡ä»¶: mobile/lib/presentation/widgets/chat_bubble.dart
 // ä½¿ç”¨ä¸»é¢˜ç³»ç»Ÿ
 Color getBubbleColor(bool isUser, BuildContext context) {
   if (isUser) {
     return context.sparkleColors.userBubble;
   }
   return context.sparkleColors.agentBubble;
 }

 Color getTextColor(bool isUser, BuildContext context) {
   final bgColor = getBubbleColor(isUser, context);
   return ContrastAccessibility.isWCAGCompliant(
     context.sparkleColors.textPrimary,
     bgColor
   ) ? context.sparkleColors.textPrimary : context.sparkleColors.textOnDark;
 }

 2.4 ä¸“æ³¨ç»Ÿè®¡å·¥å…·ä¼˜åŒ–

 æ–‡ä»¶: mobile/lib/features/focus/presentation/widgets/focus_stats_tool.dart
 // ä½¿ç”¨å“ç‰Œè‰²ç³»è€Œéç¡¬ç¼–ç 
 class FocusStatsColors {
   static Color get background => DS.surfaceSecondary;
   static Color get primary => DS.brandPrimary;
   static Color get secondary => DS.brandSecondary;
   static Color get accent => DS.semanticInfo;

   static Color forMetric(FocusMetric metric) {
     switch (metric) {
       case FocusMetric.duration: return DS.brandPrimary;
       case FocusMetric.sessions: return DS.semanticInfo;
       case FocusMetric.streak: return DS.semanticSuccess;
       default: return DS.brandSecondary;
     }
   }
 }

 2.5 Omnibaræ„å›¾æŒ‡ç¤ºå™¨å¢å¼º

 æ–‡ä»¶: mobile/lib/features/chat/presentation/widgets/omnibar.dart
 // ä½¿ç”¨è¯­ä¹‰åŒ–æ„å›¾é¢œè‰²
 Color getIntentColor(IntentType intent) {
   final colorToken = IntentColorMapping.forType(intent);
   final color = colorToken.toColor();

   // ç¡®ä¿å¯¹æ¯”åº¦
   if (!ContrastAccessibility.isWCAGCompliant(color, DS.surfacePrimary)) {
     return DS.highContrastPrimary;
   }
   return color;
 }

 é˜¶æ®µ3ï¼šå¢å¼ºå¯¹æ¯”åº¦å’Œå¯è®¿é—®æ€§

 3.1 åˆ›å»ºå¯¹æ¯”åº¦éªŒè¯å·¥å…·

 æ–‡ä»¶: mobile/lib/core/utils/color_contrast_checker.dart
 class ColorContrastChecker {
   // WCAG 2.1 AAæ ‡å‡†ï¼š4.5:1ï¼ˆæ™®é€šæ–‡æœ¬ï¼‰ï¼Œ3:1ï¼ˆå¤§æ–‡æœ¬ï¼‰
   static const double AA_RATIO = 4.5;
   static const double AAA_RATIO = 7.0;

   static bool passesAA(Color foreground, Color background) {
     return _calculateRatio(foreground, background) >= AA_RATIO;
   }

   static bool passesAAA(Color foreground, Color background) {
     return _calculateRatio(foreground, background) >= AAA_RATIO;
   }

   static double _calculateRatio(Color c1, Color c2) {
     final l1 = _relativeLuminance(c1);
     final l2 = _relativeLuminance(c2);
     final lighter = math.max(l1, l2);
     final darker = math.min(l1, l2);
     return (lighter + 0.05) / (darker + 0.05);
   }

   static double _relativeLuminance(Color color) {
     // WCAGç›¸å¯¹äº®åº¦è®¡ç®—
     final rs = color.red / 255.0;
     final gs = color.green / 255.0;
     final bs = color.blue / 255.0;

     final r = rs <= 0.03928 ? rs / 12.92 : math.pow((rs + 0.055) / 1.055, 2.4);
     final g = gs <= 0.03928 ? gs / 12.92 : math.pow((gs + 0.055) / 1.055, 2.4);
     final b = bs <= 0.03928 ? bs / 12.92 : math.pow((bs + 0.055) / 1.055, 2.4);

     return 0.2126 * r + 0.7152 * g + 0.0722 * b;
   }
 }

 3.2 é«˜å¯¹æ¯”åº¦æ¨¡å¼æ”¯æŒ

 æ–‡ä»¶: mobile/lib/core/design/theme_manager.dart
 class ThemeManager {
   // é«˜å¯¹æ¯”åº¦ä¸»é¢˜
   static ThemeData getHighContrastTheme() {
     return ThemeData(
       brightness: Brightness.light,
       primaryColor: DS.highContrastPrimary,
       scaffoldBackgroundColor: DS.highContrastSecondary,
       textTheme: TextTheme(
         bodyLarge: TextStyle(color: DS.highContrastPrimary, fontSize: 16, fontWeight: FontWeight.w500),
         bodyMedium: TextStyle(color: DS.highContrastPrimary, fontSize: 14),
       ),
       // å¼ºåˆ¶é«˜å¯¹æ¯”åº¦
       colorScheme: ColorScheme.fromSwatch().copyWith(
         primary: DS.highContrastPrimary,
         secondary: DS.highContrastPrimary,
         surface: DS.highContrastSecondary,
         background: DS.highContrastSecondary,
       ),
     );
   }

   // è‰²ç›²å‹å¥½æ¨¡å¼
   static ThemeData getColorBlindFriendlyTheme() {
     // ä½¿ç”¨ColorBrewerè‰²ç›²å‹å¥½è°ƒè‰²æ¿
     return ThemeData(
       primaryColor: Color(0xFF0072B2),  // è“è‰² - è‰²ç›²å®‰å…¨
       accentColor: Color(0xFFD55E00),   // æ©™è‰² - è‰²ç›²å®‰å…¨
       // ...
     );
   }
 }

 3.3 åŠ¨æ€å¯¹æ¯”åº¦è°ƒæ•´

 æ–‡ä»¶: mobile/lib/core/design/color_adaptive.dart
 class AdaptiveColor {
   final Color light;
   final Color dark;
   final Color highContrast;

   const AdaptiveColor({
     required this.light,
     required this.dark,
     required this.highContrast,
   });

   Color resolve(BuildContext context) {
     final brightness = MediaQuery.of(context).platformBrightness;
     final isHighContrast = MediaQuery.of(context).highContrast;

     if (isHighContrast) return highContrast;
     return brightness == Brightness.light ? light : dark;
   }
 }

 é˜¶æ®µ4ï¼šä¸»é¢˜å¢å¼ºå’Œç”¨æˆ·é€‰æ‹©

 4.1 ä¸»é¢˜é€‰æ‹©å™¨

 æ–‡ä»¶: mobile/lib/features/settings/presentation/widgets/theme_selector.dart
 class ThemeSelector extends StatelessWidget {
   final List<ThemeOption> options = [
     ThemeOption('default', 'é»˜è®¤ä¸»é¢˜', ThemeMode.system),
     ThemeOption('light', 'æµ…è‰²ä¸»é¢˜', ThemeMode.light),
     ThemeOption('dark', 'æ·±è‰²ä¸»é¢˜', ThemeMode.dark),
     ThemeOption('high_contrast', 'é«˜å¯¹æ¯”åº¦', ThemeMode.light, highContrast: true),
     ThemeOption('color_blind', 'è‰²ç›²å‹å¥½', ThemeMode.light, colorBlind: true),
   ];

   @override
   Widget build(BuildContext context) {
     return Wrap(
       spacing: 8,
       children: options.map((option) => _buildThemeCard(context, option)).toList(),
     );
   }
 }

 4.2 é¢œè‰²è‡ªå®šä¹‰ç³»ç»Ÿ

 æ–‡ä»¶: mobile/lib/features/settings/presentation/widgets/color_customizer.dart
 class ColorCustomizer extends StatefulWidget {
   // å…è®¸ç”¨æˆ·å¾®è°ƒå…³é”®é¢œè‰²
   // - ä¸»å“ç‰Œè‰²
   // - Agentç±»å‹é¢œè‰²
   // - ä»»åŠ¡ç±»å‹é¢œè‰²
   // - å¼ºè°ƒè‰²
 }

 ğŸ“Š å®æ–½è®¡åˆ’

 æ—¶é—´çº¿

 - Week 1: å»ºç«‹é¢œè‰²ç®¡ç†ç³»ç»Ÿ + Agenté¢œè‰²æ˜ å°„
 - Week 2: æ›¿æ¢ç¡¬ç¼–ç é¢œè‰²ï¼ˆAgentå¤´åƒã€æ¨ç†æ°”æ³¡ï¼‰
 - Week 3: æ›¿æ¢ç¡¬ç¼–ç é¢œè‰²ï¼ˆèŠå¤©æ°”æ³¡ã€ä¸“æ³¨ç»Ÿè®¡ã€Omnibarï¼‰
 - Week 4: å¯¹æ¯”åº¦å·¥å…· + é«˜å¯¹æ¯”åº¦æ¨¡å¼
 - Week 5: ä¸»é¢˜é€‰æ‹©å™¨ + ç”¨æˆ·è‡ªå®šä¹‰
 - Week 6: æµ‹è¯• + ä¼˜åŒ– + æ–‡æ¡£

 éªŒè¯æ ‡å‡†

 1. âœ… æ‰€æœ‰ç¡¬ç¼–ç é¢œè‰²æ›¿æ¢ä¸ºè®¾è®¡ç³»ç»Ÿ
 2. âœ… æ‰€æœ‰æ–‡æœ¬å¯¹æ¯”åº¦ â‰¥ 4.5:1 (WCAG AA)
 3. âœ… æš—è‰²æ¨¡å¼å®Œæ•´é€‚é…
 4. âœ… é«˜å¯¹æ¯”åº¦æ¨¡å¼å¯ç”¨
 5. âœ… è‰²ç›²å‹å¥½æ¨¡å¼å¯ç”¨
 6. âœ… ç”¨æˆ·å¯è‡ªå®šä¹‰ä¸»é¢˜
 7. âœ… æ— æ€§èƒ½å›å½’

 ğŸ é¢„æœŸæ”¶ç›Š

 ç”¨æˆ·ä½“éªŒ

 - æ¸…æ™°åº¦æå‡: ç»„ä»¶é¢œè‰²åŒºåˆ†åº¦æå‡ 300%
 - å¯è®¿é—®æ€§: æ»¡è¶³ WCAG 2.1 AA æ ‡å‡†
 - ä¸ªæ€§åŒ–: 4ç§ä¸»é¢˜æ¨¡å¼ + è‡ªå®šä¹‰é€‰é¡¹
 - ä¸€è‡´æ€§: ç»Ÿä¸€çš„é¢œè‰²è¯­ä¹‰ç³»ç»Ÿ

 æŠ€æœ¯æ”¶ç›Š

 - ç»´æŠ¤æ€§: æ¶ˆé™¤ç¡¬ç¼–ç ï¼Œé›†ä¸­ç®¡ç†
 - æ‰©å±•æ€§: æ˜“äºæ·»åŠ æ–°ä¸»é¢˜å’ŒAgentç±»å‹
 - å¯é æ€§: è‡ªåŠ¨å¯¹æ¯”åº¦æ£€æŸ¥é˜²æ­¢å›å½’
 - æ–‡æ¡£åŒ–: å®Œæ•´çš„é¢œè‰²ä½¿ç”¨è§„èŒƒ

 ğŸ”— ç›¸å…³æ–‡ä»¶è·¯å¾„

 æ ¸å¿ƒæ–‡ä»¶

 - mobile/lib/core/design/design_system.dart - è®¾è®¡ç³»ç»Ÿå…¥å£
 - mobile/lib/core/design/agent_color_mapping.dart - æ–°å¢Agenté¢œè‰²æ˜ å°„
 - mobile/lib/core/utils/color_contrast_checker.dart - æ–°å¢å¯¹æ¯”åº¦å·¥å…·

 ä¿®æ”¹æ–‡ä»¶

 - mobile/lib/features/galaxy/presentation/widgets/agent_avatar_switcher.dart
 - mobile/lib/features/galaxy/presentation/widgets/agent_reasoning_bubble_v2.dart
 - mobile/lib/presentation/widgets/chat_bubble.dart
 - mobile/lib/features/focus/presentation/widgets/focus_stats_tool.dart
 - mobile/lib/features/chat/presentation/widgets/omnibar.dart

 æ–°å¢æ–‡ä»¶

 - mobile/lib/core/design/agent_color_mapping.dart
 - mobile/lib/core/utils/color_contrast_checker.dart
 - mobile/lib/core/design/color_adaptive.dart
 - mobile/lib/features/settings/presentation/widgets/theme_selector.dart
 - mobile/lib/features/settings/presentation/widgets/color_customizer.dart

 ---
 æ–¹æ¡ˆçŠ¶æ€: ğŸ“‹ å¾…ç”¨æˆ·ç¡®è®¤
 é¢„è®¡å·¥æ—¶: 6å‘¨
 é£é™©ç­‰çº§: ä½ï¼ˆçº¯å‰ç«¯é‡æ„ï¼Œä¸å½±å“åç«¯ï¼‰
 ä¾èµ–æ¡ä»¶: æ— 
â•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œ



ğŸ¨ å‰ç«¯è‰²å½©æ­é…æ”¹è¿›æ–¹æ¡ˆæ€»ç»“

  æˆ‘å·²ç»ä¸ºä½ å®Œæˆäº†ä¸€ä»½å…¨é¢çš„è‰²å½©æ”¹è¿›æ–¹æ¡ˆï¼Œå¹¶ä¿å­˜åœ¨è®¡åˆ’æ–‡ä»¶ä¸­ã€‚è®©æˆ‘ä¸ºä½ æ€»ç»“æ ¸å¿ƒè¦ç‚¹ï¼š

  ğŸŒŸ å½“å‰é—®é¢˜è¯Šæ–­

  1. åŒç³»ç»Ÿæ··ä¹±: V2å’Œæ—§ç‰ˆè‰²å½©ç³»ç»Ÿå¹¶å­˜
  2. è‰²å½©å•ä¸€: ç¼ºä¹50-900çš„å®Œæ•´è‰²é˜¶
  3. ç¼ºä¹å±‚æ¬¡: æ²¡æœ‰å¾®å¦™çš„è‰²è°ƒå˜åŒ–
  4. ç°ä»£æ„Ÿä¸è¶³: æœªèå…¥2025è®¾è®¡è¶‹åŠ¿

  ğŸ¯ æ”¹è¿›æ–¹æ¡ˆäº®ç‚¹

  1. é«˜çº§è‰²å½©æ¶æ„

  - ä¸»è‰²è°ƒ: ä»çº¯è“ #4361EE å‡çº§ä¸ºæ·±æµ·è“è°ƒç³»ç»Ÿ (50-900)
  - ä¸­æ€§è‰²: é‡‡ç”¨æš–ç°ç³»ç»Ÿï¼Œè¥é€ èˆ’é€‚æ„Ÿ
  - è¯­ä¹‰è‰²: ä¸ºæ¯ä¸ªå­¦ä¹ ä»»åŠ¡å®šåˆ¶æƒ…æ„Ÿè‰²å½©

  2. ç°ä»£è®¾è®¡åŸåˆ™

  - 60-30-10æ³•åˆ™: å¹³è¡¡è‰²å½©æ¯”ä¾‹
  - ç»ç’ƒæ‹Ÿæ€: åŠé€æ˜+æ¨¡ç³Šæ•ˆæœ
  - åŠ¨æ€è‰²å½©: Material Youé£æ ¼çš„è‡ªé€‚åº”ä¸»é¢˜

  3. æŠ€æœ¯å®ç°

  - å®Œæ•´çš„Dartç±»å‹å®‰å…¨ç³»ç»Ÿ
  - é›¶æ€§èƒ½æŸè€—çš„è‰²å½©æ¸²æŸ“
  - WCAG AA/AAAå¯è®¿é—®æ€§åˆè§„

  ğŸ“Š é¢„æœŸæå‡æ•ˆæœ

  - é«˜çº§æ„Ÿ: +40%
  - ä¸€è‡´æ€§: +60%
  - å¯è®¿é—®æ€§: +50%
  - è§†è§‰ç–²åŠ³: -30%

  ğŸš€ å®æ–½è·¯å¾„

  1. Day 1-2: é‡æ„åŸºç¡€è‰²å½©ç³»ç»Ÿ
  2. Day 3-5: å‡çº§å…³é”®ç»„ä»¶
  3. Day 6-7: ä¸»é¢˜ç³»ç»Ÿå¢å¼ºä¸æµ‹è¯•